!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports):"function"==typeof define&&define.amd?define(["exports"],e):e((t="undefined"!=typeof globalThis?globalThis:t||self).Hackle={})}(this,(function(t){"use strict";function e(t,e){function r(){this.constructor=t}if("function"!=typeof e&&null!==e)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");P(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}function r(t,e,r,n){return new(r||(r=Promise))((function(i,o){function s(t){try{a(n.next(t))}catch(t){o(t)}}function u(t){try{a(n.throw(t))}catch(t){o(t)}}function a(t){var e;t.done?i(t.value):(e=t.value,e instanceof r?e:new r((function(t){t(e)}))).then(s,u)}a((n=n.apply(t,e||[])).next())}))}function n(t,e){function r(r){return function(s){return function(r){if(n)throw new TypeError("Generator is already executing.");for(;u;)try{if(n=1,i&&(o=2&r[0]?i.return:r[0]?i.throw||((o=i.return)&&o.call(i),0):i.next)&&!(o=o.call(i,r[1])).done)return o;switch(i=0,o&&(r=[2&r[0],o.value]),r[0]){case 0:case 1:o=r;break;case 4:return u.label++,{value:r[1],done:!1};case 5:u.label++,i=r[1],r=[0];continue;case 7:r=u.ops.pop(),u.trys.pop();continue;default:if(!((o=(o=u.trys).length>0&&o[o.length-1])||6!==r[0]&&2!==r[0])){u=0;continue}if(3===r[0]&&(!o||r[1]>o[0]&&r[1]<o[3])){u.label=r[1];break}if(6===r[0]&&u.label<o[1]){u.label=o[1],o=r;break}if(o&&u.label<o[2]){u.label=o[2],u.ops.push(r);break}o[2]&&u.ops.pop(),u.trys.pop();continue}r=e.call(t,u)}catch(t){r=[6,t],i=0}finally{n=o=0}if(5&r[0])throw r[1];return{value:r[0]?r[1]:void 0,done:!0}}([r,s])}}var n,i,o,s,u={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return s={next:r(0),throw:r(1),return:r(2)},"function"==typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s}function i(t,e,r){if(r||2===arguments.length)for(var n,i=0,o=e.length;i<o;i++)!n&&i in e||(n||(n=Array.prototype.slice.call(e,0,i)),n[i]=e[i]);return t.concat(n||Array.prototype.slice.call(e))}function o(t,e){for(var r in e)e.hasOwnProperty(r)&&t.setRequestHeader(r,e[r])}function s(t,e){var r=t.find((function(t){return t===e||t.toLowerCase()===e.toLowerCase()}));return r||at.debug("Unsupported type [".concat(e,"]. Please use the latest version of sdk.")),r}function u(t,e){if(!k.isNullOrUndefined(e)){for(var r=new Array,n=0,i=e;n<i.length;n++){var o=s(t,i[n]);if(k.isNullOrUndefined(o))return;r.push(o)}return r}}function a(t,e){return t-e}function c(t,e){return t.name===e.name&&rt.isEquals(t.tags,e.tags)}function f(){if(!x&&!(x="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return x(Re)}function p(t){return"string"==typeof t&&Se.test(t)}function l(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,r=(Me[t[e+0]]+Me[t[e+1]]+Me[t[e+2]]+Me[t[e+3]]+"-"+Me[t[e+4]]+Me[t[e+5]]+"-"+Me[t[e+6]]+Me[t[e+7]]+"-"+Me[t[e+8]]+Me[t[e+9]]+"-"+Me[t[e+10]]+Me[t[e+11]]+Me[t[e+12]]+Me[t[e+13]]+Me[t[e+14]]+Me[t[e+15]]).toLowerCase();if(!p(r))throw TypeError("Stringified UUID is invalid");return r}function h(t,e,r){function n(t,n,i,o){if("string"==typeof t&&(t=function(t){t=unescape(encodeURIComponent(t));for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r));return e}(t)),"string"==typeof n&&(n=function(t){if(!p(t))throw TypeError("Invalid UUID");var e,r=new Uint8Array(16);return r[0]=(e=parseInt(t.slice(0,8),16))>>>24,r[1]=e>>>16&255,r[2]=e>>>8&255,r[3]=255&e,r[4]=(e=parseInt(t.slice(9,13),16))>>>8,r[5]=255&e,r[6]=(e=parseInt(t.slice(14,18),16))>>>8,r[7]=255&e,r[8]=(e=parseInt(t.slice(19,23),16))>>>8,r[9]=255&e,r[10]=(e=parseInt(t.slice(24,36),16))/1099511627776&255,r[11]=e/4294967296&255,r[12]=e>>>24&255,r[13]=e>>>16&255,r[14]=e>>>8&255,r[15]=255&e,r}(n)),16!==n.length)throw TypeError("Namespace must be array-like (16 iterable integer values, 0-255)");var s=new Uint8Array(16+t.length);if(s.set(n),s.set(t,n.length),(s=r(s))[6]=15&s[6]|e,s[8]=63&s[8]|128,i){o=o||0;for(var u=0;u<16;++u)i[o+u]=s[u];return i}return l(s)}try{n.name=t}catch(t){}return n.DNS="6ba7b810-9dad-11d1-80b4-00c04fd430c8",n.URL="6ba7b811-9dad-11d1-80b4-00c04fd430c8",n}function d(t){return 14+(t+64>>>9<<4)+1}function v(t,e){var r=(65535&t)+(65535&e);return(t>>16)+(e>>16)+(r>>16)<<16|65535&r}function y(t,e,r,n,i,o){return v((s=v(v(e,t),v(n,o)))<<(u=i)|s>>>32-u,r);var s,u}function m(t,e,r,n,i,o,s){return y(e&r|~e&n,t,e,i,o,s)}function g(t,e,r,n,i,o,s){return y(e&n|r&~n,t,e,i,o,s)}function E(t,e,r,n,i,o,s){return y(e^r^n,t,e,i,o,s)}function w(t,e,r,n,i,o,s){return y(r^(e|~n),t,e,i,o,s)}function T(t,e,r){var n=(t=t||{}).random||(t.rng||f)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,e){r=r||0;for(var i=0;i<16;++i)e[r+i]=n[i];return e}return l(n)}function _(t,e,r,n){switch(t){case 0:return e&r^~e&n;case 1:case 3:return e^r^n;case 2:return e&r^e&n^r&n}}function I(t,e){return t<<e|t>>>32-e}function A(t){var e=new Array,r=new Array,n=new Array;return t.forEach((function(t){t instanceof dr?dr.isExposure(t)?e.push(t.toDto()):dr.isTrack(t)?r.push(t.toDto()):dr.isRemoteConfig(t)&&n.push(t.toDto()):dr.isExposureDto(t)?e.push(t):dr.isTrackDto(t)?r.push(t):dr.isRemoteConfigDto(t)&&n.push(t)})),{exposureEvents:e,trackEvents:r,remoteConfigEvents:n}}function N(){var t=Dr.getItem(q);return t||(Dr.getItem(J)||R())}function O(t){Dr.setItem(q,t)}function b(){Dr.removeItem(q)}function R(){var t=T();return Dr.setItem(J,t),t}function S(t,e){YN=window.onerror,window.onerror=function(r,n,i,o,s){k.isNotNullOrUndefined(s)&&t.trackException(s,e.resolveCurrentUser()),YN&&YN.apply(this,arguments)}}function M(t,e){pA=window.onunhandledrejection,window.onunhandledrejection=function(r){var n;try{"reason"in r?n=r.reason:"detail"in r&&"reason"in r.detail&&(n=r.detail.reason)}catch(t){}n instanceof Error&&t.trackException(n,e.resolveCurrentUser()),pA&&pA.apply(this,arguments)}}function C(t,e){var r,n,i,o,s,u=U(U({},tb),e);if(F.initCounter((function(t){return Ke.counter("log",{level:t})})),u.log_disabled?F.setLogLevel(L.DISABLE):u.debug&&F.setLogLevel(L.DEBUG),ZO.debug("sdkKey : "+t),t||ZO.error("SDK Key must not be null"),QO)return ZO.debug("use already exists hackleClient"),QO;var a=!1;"undefined"!=typeof window&&(a=window&&window.navigator&&window.navigator.sendBeacon&&!0)&&ZO.debug("support sendBeacon API");var c=-1;void 0!==u.pollingIntervalMillis&&"number"==typeof u.pollingIntervalMillis&&u.pollingIntervalMillis>0&&(c=Math.max(u.pollingIntervalMillis,3e4));var f=new wr(t,tt,{fetchUrl:nO.clientFetch(u.sdkUrl,t),updateInterval:c,headers:(r={},r[G]=u.SDK_NAME_HEADER,r[B]=u.SDK_VERSION_HEADER,r)}),p=new ZN(tO.postfix(Dr,"_".concat(t))),l=p.getUser(),h=u.user||null,d=new $N(p,N(),l,h),v=new QN(u.sessionTimeoutMillis,tO.postfix(Dr,"_".concat(t.slice(8))));d.addListener(v);var y=new XN(window.localStorage,"".concat("hackle-repository-storage","_").concat(t),100),m=new gr(t,tt,{dispatchUrl:nO.clientDispatch(u.eventUrl),beaconDispatchUrl:nO.beaconDispatch(u.eventUrl,t),useBeacon:a,headers:(n={},n[G]=u.SDK_NAME_HEADER,n[B]=u.SDK_VERSION_HEADER,n)}),g=-1;void 0!==u.exposureEventDedupIntervalMillis&&"number"==typeof u.exposureEventDedupIntervalMillis&&-1!==u.exposureEventDedupIntervalMillis&&(u.exposureEventDedupIntervalMillis<1e3||u.exposureEventDedupIntervalMillis>36e5?(ZO.warn("Exposure event dedup interval is outside allowed range[1_000ms..3_600_000ms]. Setting to default value[no dedup]."),g=-1):g=u.exposureEventDedupIntervalMillis);var E=new EA(g),w=new gA(m,100,500,y,E,v,d),T=new xA(new eO(Dr,"".concat("hackle-manual-override_ab","_").concat(t.slice(0,8)))),_=new xA(new eO(Dr,"".concat("hackle-manual-override_ff","_").concat(t.slice(0,8)))),I=new iO(tO.prefix(window.localStorage,"".concat("hackle-iam-hide","_").concat(t.slice(0,8),"_"))),A=new AO(tO.prefix(window.localStorage,"".concat("hackle-iam-impression","_").concat(t.slice(0,8),"_"))),O=zN.create(f,w,[T,_],I),R=new Lr(d),S=new VO(new jO(tO.postfix(Dr,"_".concat(t.slice(0,8)))),new HO,O,d,R),M=new mA(R,O);v.addListener(S),v.addListener(M);var C=new fO(O),x=new UO,P=new oO([new sO,new uO(x),new aO(x),new cO(I,ut.instance)]),k=new NO([new OO(A),new RO(P),new bO]),D=new SO(ut.instance,C,k),V=new CO([new xO,new PO(D)]),H=new mO(nO.inAppMessageRenderer(u.cdnUrl,u.IAM_RENDERER_VERSION_HEADER)),K=new pO(new yO(H),D,V),z=new MO(new gO(VN.get("targetMatcher")),new wO(A)),J=new dO(f,z,O);new lO(w,J,K);var q=new rO(O,d,R,T,_),Y=(null===(o=u.devTool)||void 0===o?void 0:o.userExplorer)&&"function"==typeof(null===(s=u.devTool)||void 0===s?void 0:s.userExplorer),X=u.devTool&&Y?{manager:u.devTool,userExplorer:q}:void 0,W=new hr(O,R,v,d,X);QO=W,u.autoOpenDevTool&&(u.devTool?W.showUserExplorer():ZO.error("DevTool is not provided"));var $,Z,Q,et=function(){w.drainRepository()},rt=new ze(u.monitoringUrl,6e4,tt,((i={})[G]=u.SDK_NAME_HEADER,i[B]=u.SDK_VERSION_HEADER,i[j]=t,i),a);return document.addEventListener("visibilitychange",(function(){document.hidden||et()})),window.addEventListener("pageshow",et),window.addEventListener("onpagehide"in window?"pagehide":"unload",(function(){b(),v.updateLastEventTime((new Date).getTime()),W.close(),Ke.globalRegistry.close()})),Ke.addRegistry(rt),$=Date.now(),Z=d.currentUser,Q=v.currentSessionId,(WN(l,Z)?v.startNewSessionIfNeeded(Z,$):v.startNewSession(l,Z,$))===Q&&S.startNewCampaignIfNeeded(Z,$),W.onReady((function(){(new qN).install(O,R),function(t,e){function r(t){if("function"==typeof window.Event)return new Event(t);var e={bubbles:!1,cancelable:!1,detail:void 0},r=document.createEvent("CustomEvent");return r.initCustomEvent(t,e.bubbles,e.cancelable,e.detail),r}if(e.auto_track_page_view){t.trackPageView();try{history.pushState=function(t){return function(){try{var e=t.apply(this,arguments);return window.dispatchEvent(r("locationchange")),e}catch(t){if(t instanceof Error)ZO.error(t);else try{ZO.error(t)}catch(t){}}}}(history.pushState),history.replaceState=function(t){return function(){try{var e=t.apply(this,arguments);return window.dispatchEvent(r("locationchange")),e}catch(t){if(t instanceof Error)ZO.error(t);else try{ZO.error(t)}catch(t){}}}}(history.replaceState),window.addEventListener("popstate",(function(){try{window.dispatchEvent(r("locationchange"))}catch(t){if(t instanceof Error)ZO.error(t);else try{ZO.error(t)}catch(t){}}})),window.addEventListener("locationchange",(function(){try{t.trackPageView()}catch(t){if(t instanceof Error)ZO.error(t);else try{ZO.error(t)}catch(t){}}}))}catch(t){if(t instanceof Error)ZO.error(t);else try{ZO.error(t)}catch(t){}}}}(W,u)})),W}for(var x,P=function(t,e){return P=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])},P(t,e)},U=function(){return U=Object.assign||function(t){for(var e,r=1,n=arguments.length;r<n;r++)for(var i in e=arguments[r])Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i]);return t},U.apply(this,arguments)},k=function(){function t(){}return t.isNotNullOrUndefined=function(t){return null!=t},t.isNullOrUndefined=function(t){return null==t},t.requiredNotNullOrUndefined=function(t,e){if(void 0===e&&(e=function(){return"Required value is null or undefined"}),this.isNullOrUndefined(t))throw new Error(e());return t},t.fromMap=function(t){var e={};return t.forEach((function(t,r){e[r]=t})),e},t}(),D=function(){function t(){}return t.mapNotNullOrUndefined=function(t,e){for(var r=Array(),n=0,i=t;n<i.length;n++){var o=e(i[n]);k.isNotNullOrUndefined(o)&&r.push(o)}return r},t.mapOrUndefined=function(t,e){for(var r=Array(),n=0,i=t;n<i.length;n++){var o=e(i[n]);if(k.isNullOrUndefined(o))return;r.push(o)}return r},t.associateTo=function(t,e,r){for(var n=0,i=t;n<i.length;n++){var o=r(i[n]);e.set(o[0],o[1])}return e},t.associate=function(t,e){return this.associateTo(t,new Map,e)},t.associateBy=function(t,e){return this.associate(t,(function(t){return[e(t),t]}))},t.chunked=function(t,e){for(var r=[],n=t.slice();n.length;)r.push(n.splice(0,e));return r},t}(),L={DISABLE:0,ERROR:1,WARN:2,INFO:3,DEBUG:4},F=function(){function t(){}return t.setLogLevel=function(t){void 0===t&&(t=L.INFO),this.logLevel=t},t.initCounter=function(t){this.counters=D.associate(Object.keys(L),(function(e){return[e,t(e)]}))},t._log=function(t,e){var r;switch(t){case"WARN":r="orange";break;case"ERROR":r="red";break;default:r="#AAAAAA"}if(e instanceof Error)V.log(t,r,e.message,e);else try{V.log(t,r,e)}catch(t){}},t.increment=function(e){var r,n;null===(n=null===(r=t.counters)||void 0===r?void 0:r.get(e))||void 0===n||n.increment()},t.logLevel=L.INFO,t.log={error:function(e){t.logLevel>=L.ERROR&&(t._log("ERROR",e),t.increment("ERROR"))},warn:function(e){t.logLevel>=L.WARN&&(t._log("WARN",e),t.increment("WARN"))},info:function(e){t.logLevel>=L.INFO&&(t._log("INFO",e),t.increment("INFO"))},debug:function(e){t.logLevel>=L.DEBUG&&(t._log("DEBUG",e),t.increment("DEBUG"))}},t}(),V=function(){function t(){}return t.log=function(){},t}(),j="X-HACKLE-SDK-KEY",G="X-HACKLE-SDK-NAME",B="X-HACKLE-SDK-VERSION",H="X-HACKLE-SDK-TIME",K=3e3,z=[0,8,16,32,64,128,256,512],J="_hackle_hid",q="_hackle_id",Y="_hackle_session_id",X="_hackle_last_event_ts",W="_hackle_uid",$="_hackle_did",Z="_hackle_mkt",Q=F.log,tt={getRequest:function(t,e){return{abort:function(){},responsePromise:new Promise((function(r,n){var i=new XMLHttpRequest;i.open("GET",t),i.onreadystatechange=function(){if(i.readyState===i.DONE){if(0===i.status)return void n(new Error("Request error"));r({statusCode:i.status,body:i.responseText})}},i.onerror=function(){n()},i.setRequestHeader("content-type","application/json"),o(i,e),i.send()}))}},postRequest:function(t,e,r,n,i){var s=JSON.stringify(e),u=new XMLHttpRequest;u.open("POST",t),u.onreadystatechange=function(){u.readyState===u.DONE&&(u.status>=200&&u.status<400?n({statusCode:u.status}):i&&i({statusCode:u.status}))},u.setRequestHeader("content-type","application/json"),o(u,r),u.send(s)},sendBeacon:function(t,e,r,n,i){var o=!1;if("undefined"!=typeof window&&(o=window&&window.navigator&&window.navigator.sendBeacon&&!0),o){var s=JSON.stringify(e),u=new URLSearchParams;if(u.append("sdkName",r[G]),u.append("sdkVersion",r[B]),u.append("sdkKey",r[j]),u.append("data",s),!window.navigator.sendBeacon(t,u))return Q.error("sendBeacon failed to queue request."),void i();n()}else Q.error("Does not support sendBeacon"),i()}},et=F.log,rt=function(){function t(){}return t.isEquals=function(t,e){if(null==e)return!1;var r=Object.keys(t);return r.length===Object.keys(e).length&&r.every((function(r){return t[r]===e[r]}))},t.sanitize=function(t){var e={};if(k.isNullOrUndefined(t))return e;for(var r=0,n=Object.entries(t);r<n.length;r++){var i=n[r],o=i[0],s=i[1];if(this.isValidType(o)){var u=this.sanitizeValue(s);k.isNullOrUndefined(u)?et.debug("Invalid identifier value. The identifier type value be a string of 512 characters or less. [".concat(o,"]")):e[o]=u}else et.debug("Invalid identifier type. The identifier type must be a string of 128 characters or less. [".concat(o,"]"))}return e},t.isValidType=function(t){return!k.isNullOrUndefined(t)&&"string"==typeof t&&t.length>0&&t.length<=this.MAX_IDENTIFIER_TYPE_LENGTH},t.sanitizeValue=function(t){return"string"==typeof t&&t.length>0&&t.length<=this.MAX_IDENTIFIER_VALUE_LENGTH?t:"number"==typeof t?t.toString():null},t.MAX_IDENTIFIER_TYPE_LENGTH=128,t.MAX_IDENTIFIER_VALUE_LENGTH=512,t}(),nt=F.log,it=function(){function t(){}return t.sanitize=function(t){var e={};if(k.isNullOrUndefined(t))return e;for(var r=0,n=Object.entries(t);r<n.length;r++){var i=n[r],o=i[0],s=i[1];if(Object.keys(e).length>=this.MAX_PROPERTIES_COUNT){nt.debug("The number of properties cannot exceed 128. Drops excess properties. [".concat(o,", ").concat(s,"]"));break}if(this.isValidKey(o)){var u=this.sanitizeValue(o,s);k.isNullOrUndefined(u)?nt.debug("Invalid property value. The property value mus be 'string(..1024)', 'number', 'boolean', or 'array' type. [".concat(s,"]")):e[o]=u}else nt.debug("Invalid property key. The property key must be a string of 128 characters or less. [".concat(o,"]"))}return e},t.isValidProperty=function(t,e){return this.isValidKey(t)&&this.isValidValue(e)},t.isValidKey=function(t){return k.isNotNullOrUndefined(t)&&"string"==typeof t&&t.length>0&&t.length<=this.MAX_PROPERTY_KEY_LENGTH},t.sanitizeValue=function(t,e){var r=this;return"string"==typeof t&&t.startsWith(this.SYSTEM_PROPERTY_KEY_PREFIX)?e:this.isValidValue(e)?Array.isArray(e)?e.filter((function(t){return r.isValidElement(t)})):e:null},t.isValidValue=function(t){return!k.isNullOrUndefined(t)&&("string"==typeof t?t.length<=this.MAX_PROPERTY_VALUE_LENGTH:"number"==typeof t?!isNaN(t)&&isFinite(t):"boolean"==typeof t||Array.isArray(t))},t.isValidElement=function(t){return!k.isNullOrUndefined(t)&&("string"==typeof t?t.length>0&&t.length<=this.MAX_PROPERTY_VALUE_LENGTH:"number"==typeof t)},t.SYSTEM_PROPERTY_KEY_PREFIX="$",t.MAX_PROPERTIES_COUNT=128,t.MAX_PROPERTY_KEY_LENGTH=128,t.MAX_PROPERTY_VALUE_LENGTH=1024,t}(),ot=["nanoseconds","microseconds","milliseconds","seconds","minutes","hours","days"],st=function(){function t(){}return t.nanosToUnit=function(e,r){switch(r){case"nanoseconds":return e;case"microseconds":return e/(t.C1/t.C0);case"milliseconds":return e/(t.C2/t.C0);case"seconds":return e/(t.C3/t.C0);case"minutes":return e/(t.C4/t.C0);case"hours":return e/(t.C5/t.C0);case"days":return e/(t.C6/t.C0)}},t.microsToUnit=function(e,r){switch(r){case"nanoseconds":return e*(t.C1/t.C0);case"milliseconds":return e/(t.C2/t.C1);case"microseconds":return e;case"seconds":return e/(t.C3/t.C1);case"minutes":return e/(t.C4/t.C1);case"hours":return e/(t.C5/t.C1);case"days":return e/(t.C6/t.C1)}},t.millisToUnit=function(e,r){switch(r){case"nanoseconds":return e*(t.C2/t.C0);case"microseconds":return e*(t.C2/t.C1);case"milliseconds":return e;case"seconds":return e/(t.C3/t.C2);case"minutes":return e/(t.C4/t.C2);case"hours":return e/(t.C5/t.C2);case"days":return e/(t.C6/t.C2)}},t.secondsToUnit=function(e,r){switch(r){case"nanoseconds":return e*(t.C3/t.C0);case"microseconds":return e*(t.C3/t.C1);case"milliseconds":return e*(t.C3/t.C2);case"seconds":return e;case"minutes":return e/(t.C4/t.C3);case"hours":return e/(t.C5/t.C3);case"days":return e/(t.C6/t.C3)}},t.minutesToUnit=function(e,r){switch(r){case"nanoseconds":return e*(t.C4/t.C0);case"microseconds":return e*(t.C4/t.C1);case"milliseconds":return e*(t.C4/t.C2);case"seconds":return e*(t.C4/t.C3);case"minutes":return e;case"hours":return e/(t.C5/t.C4);case"days":return e/(t.C6/t.C4)}},t.hoursToUnit=function(e,r){switch(r){case"nanoseconds":return e*(t.C5/t.C0);case"microseconds":return e*(t.C5/t.C1);case"milliseconds":return e*(t.C5/t.C2);case"seconds":return e*(t.C5/t.C3);case"minutes":return e*(t.C5/t.C4);case"hours":return e;case"days":return e/(t.C6/t.C5)}},t.daysToUnit=function(e,r){switch(r){case"nanoseconds":return e*(t.C6/t.C0);case"microseconds":return e*(t.C6/t.C1);case"milliseconds":return e*(t.C6/t.C2);case"seconds":return e*(t.C6/t.C3);case"minutes":return e*(t.C6/t.C4);case"hours":return e*(t.C6/t.C5);case"days":return e}},t.C0=1,t.C1=1e3*t.C0,t.C2=1e3*t.C1,t.C3=1e3*t.C2,t.C4=60*t.C3,t.C5=60*t.C4,t.C6=24*t.C5,t.converter={nanoseconds:t.nanosToUnit,microseconds:t.microsToUnit,milliseconds:t.millisToUnit,seconds:t.secondsToUnit,minutes:t.minutesToUnit,hours:t.hoursToUnit,days:t.daysToUnit},t}(),ut=function(){function t(){}return t.prototype.tick=function(){return 1e3*Date.now()},t.prototype.currentMillis=function(){return Date.now()},t.instance=new t,t}(),at=F.log,ct=function(){function t(t,e){this.value=t,this.reason=e}return t.of=function(e,r){return new t(e,r)},t}(),ft=function(){function t(t,e,r){this.inAppMessage=t,this.message=e,this.reason=r}return t.prototype.isShow=function(){return k.isNotNullOrUndefined(this.inAppMessage)&&k.isNotNullOrUndefined(this.message)},t.of=function(e,r,n){return new t(r,n,e)},t}(),pt=function(){function t(t,e,r){this.variation=t,this.reason=e,this.config=r}return t.of=function(e,r,n){return void 0===n&&(n=new dt),new t(e,r,n)},t.prototype.get=function(t,e){return this.config.get(t,e)},t}(),lt=function(){function t(t,e,r){this.isOn=t,this.reason=e,this.config=r}return t.on=function(e,r){return void 0===r&&(r=new dt),new t(!0,e,r)},t.off=function(e,r){return void 0===r&&(r=new dt),new t(!1,e,r)},t.prototype.get=function(t,e){return this.config.get(t,e)},t}(),ht=function(){function t(){}return t.prototype.get=function(t,e){return e},t}(),dt=function(){function t(){}return t.prototype.get=function(t,e){return e},t}(),vt=function(){function t(){}return t.SDK_NOT_READY="SDK_NOT_READY",t.EXCEPTION="EXCEPTION",t.INVALID_INPUT="INVALID_INPUT",t.UNSUPPORTED_PLATFORM="UNSUPPORTED_PLATFORM",t.TYPE_MISMATCH="TYPE_MISMATCH",t.EXPERIMENT_NOT_FOUND="EXPERIMENT_NOT_FOUND",t.EXPERIMENT_DRAFT="EXPERIMENT_DRAFT",t.EXPERIMENT_PAUSED="EXPERIMENT_PAUSED",t.EXPERIMENT_COMPLETED="EXPERIMENT_COMPLETED",t.OVERRIDDEN="OVERRIDDEN",t.TRAFFIC_NOT_ALLOCATED="TRAFFIC_NOT_ALLOCATED",t.NOT_IN_MUTUAL_EXCLUSION_EXPERIMENT="NOT_IN_MUTUAL_EXCLUSION_EXPERIMENT",t.IDENTIFIER_NOT_FOUND="IDENTIFIER_NOT_FOUND",t.VARIATION_DROPPED="VARIATION_DROPPED",t.TRAFFIC_ALLOCATED="TRAFFIC_ALLOCATED",t.TRAFFIC_ALLOCATED_BY_TARGETING="TRAFFIC_ALLOCATED_BY_TARGETING",t.NOT_IN_EXPERIMENT_TARGET="NOT_IN_EXPERIMENT_TARGET",t.FEATURE_FLAG_NOT_FOUND="FEATURE_FLAG_NOT_FOUND",t.FEATURE_FLAG_INACTIVE="FEATURE_FLAG_INACTIVE",t.INDIVIDUAL_TARGET_MATCH="INDIVIDUAL_TARGET_MATCH",t.TARGET_RULE_MATCH="TARGET_RULE_MATCH",t.DEFAULT_RULE="DEFAULT_RULE",t.REMOTE_CONFIG_PARAMETER_NOT_FOUND="REMOTE_CONFIG_PARAMETER_NOT_FOUND",t.IN_APP_MESSAGE_NOT_FOUND="IN_APP_MESSAGE_NOT_FOUND",t.IN_APP_MESSAGE_DRAFT="IN_APP_MESSAGE_DRAFT",t.IN_APP_MESSAGE_PAUSED="IN_APP_MESSAGE_PAUSED",t.IN_APP_MESSAGE_HIDDEN="IN_APP_MESSAGE_HIDDEN",t.IN_APP_MESSAGE_TARGET="IN_APP_MESSAGE_TARGET",t.NOT_IN_IN_APP_MESSAGE_PERIOD="NOT_IN_IN_APP_MESSAGE_PERIOD",t.NOT_IN_IN_APP_MESSAGE_TARGET="NOT_IN_IN_APP_MESSAGE_TARGET",t}(),yt=function(){function t(t,e,r,n,i,o,s,u,a,c,f,p,l,h){this.id=t,this.key=e,this.type=r,this.identifierType=n,this.status=i,this.version=o,this.variations=s,this.userOverrides=u,this.segmentOverrides=a,this.targetAudiences=c,this.targetRules=f,this.defaultRule=p,this.containerId=l,this._winnerVariationId=h}return t.fromJson=function(e,r){var n=t.experimentStatusOrNull(r.execution.status),i=r.variations.map((function(t){return new mt(t.id,t.key,"DROPPED"===t.status,t.parameterConfigurationId)})),o=D.associate(r.execution.userOverrides,(function(t){return[t.userId,t.variationId]})),s=D.mapNotNullOrUndefined(r.execution.segmentOverrides,(function(t){return St.fromJson(t,Jt.IDENTIFIER)})),u=D.mapNotNullOrUndefined(r.execution.targetAudiences,(function(t){return At.fromJson(t,Jt.PROPERTY)})),a=D.mapNotNullOrUndefined(r.execution.targetRules,(function(t){return St.fromJson(t,Jt.PROPERTY)})),c=Rt.fromJson(r.execution.defaultRule);return n&&c&&new t(r.id,r.key,e,r.identifierType,n,r.version,i,o,s,u,a,c,r.containerId,r.winnerVariationId)},t.experimentStatusOrNull=function(t){switch(t){case"READY":return"DRAFT";case"RUNNING":return"RUNNING";case"PAUSED":return"PAUSED";case"STOPPED":return"COMPLETED";default:return void at.debug("Unsupported status [".concat(t,"]"))}},t.prototype._winnerVariationOrNull=function(){if(this._winnerVariationId)return this._getVariationByIdOrNull(this._winnerVariationId)},t.prototype._getVariationByIdOrNull=function(t){return this.variations.find((function(e){return e.id===t}))},t.prototype._getVariationByKeyOrNull=function(t){return this.variations.find((function(e){return e.key===t}))},t}(),mt=function(t,e,r,n){this.id=t,this.key=e,this.isDropped=r,this.parameterConfigurationId=n},gt=function(){function t(t,e,r,n){this.id=t,this.seed=e,this.slotSize=r,this.slots=n}return t.fromJson=function(e){return new t(e.id,e.seed,e.slotSize,e.slots.map((function(t){var e=t.startInclusive,r=t.endExclusive,n=t.variationId;return new Et(e,r,n)})))},t}(),Et=function(){function t(t,e,r){this.startInclusive=t,this.endExclusive=e,this.variationId=r}return t.prototype.contains=function(t){return this.startInclusive<=t&&t<this.endExclusive},t}(),wt=function(){function t(t,e){this.id=t,this.key=e}return t.fromJson=function(e){return new t(e.id,e.key)},t}(),Tt=function(){function t(){}return t.ID="$id",t.USER="$userId",t.DEVICE="$deviceId",t.SESSION="$sessionId",t.HACKLE_DEVICE="$hackleDeviceId",t}(),_t=function(){function t(){this.identifiers={}}return t.prototype.addIdentifiers=function(t){for(var e in t)this.add(e,t[e]);return this},t.prototype.add=function(t,e){var r=rt.sanitizeValue(e);return rt.isValidType(t)&&r?this.identifiers[t]=e:at.warn("Invalid user identifier [type=".concat(t,", value=").concat(e,"]")),this},t.prototype.build=function(){return this.identifiers},t}(),It=function(t){var e,r,n,i={};return i.id=null!==(e=rt.sanitizeValue(t.id))&&void 0!==e?e:void 0,i.userId=null!==(r=rt.sanitizeValue(t.userId))&&void 0!==r?r:void 0,i.deviceId=null!==(n=rt.sanitizeValue(t.deviceId))&&void 0!==n?n:void 0,"object"==typeof t.properties&&(i.properties=it.sanitize(t.properties)),"object"==typeof t.identifiers&&(i.identifiers=rt.sanitize(t.identifiers)),function(t){return Boolean(t.id||t.userId||t.deviceId||t.identifiers&&Object.keys(t.identifiers).length>0)}(i)?i:null},At=function(){function t(t){this.conditions=t}return t.fromJson=function(e,r){return new t(D.mapNotNullOrUndefined(e.conditions,(function(t){return Nt.fromJson(t,r)})))},t.prototype.toJson=function(){return{conditions:this.conditions.map((function(t){return t.toJson()}))}},t}(),Nt=function(){function t(t,e){this.key=t,this.match=e}return t.fromJson=function(e,r){var n=Ot.fromJson(e.key);if(n&&r.supports(n.type)){var i=bt.fromJson(e.match);return i&&new t(n,i)}},t.prototype.toJson=function(){return{key:this.key.toJson(),match:this.match.toJson()}},t}(),Ot=function(){function t(t,e){this.type=t,this.name=e}return t.fromJson=function(e){var r=s(Kt,e.type);return r&&new t(r,e.name)},t.prototype.toJson=function(){return{type:this.type,name:this.name}},t}(),bt=function(){function t(t,e,r,n){this.type=t,this.operator=e,this.valueType=r,this.values=n}return t.fromJson=function(e){var r=s(jt,e.type),n=s(Bt,e.operator),i=s(Gt,e.valueType);return r&&n&&i&&new t(r,n,i,e.values)},t.prototype.toJson=function(){return{operator:this.operator,type:this.type,valueType:this.valueType,values:this.values}},t}(),Rt=function(){function t(t,e,r){this.type=t,this.variationId=e,this.bucketId=r}return t.fromJson=function(e){var r=s(Ht,e.type);return r&&new t(r,e.variationId,e.bucketId)},t}(),St=function(){function t(t,e){this.target=t,this.action=e}return t.fromJson=function(e,r){var n=At.fromJson(e.target,r),i=Rt.fromJson(e.action);return n&&i&&new t(n,i)},t}(),Mt=function(){function t(t,e,r,n){this.id=t,this.key=e,this.type=r,this.targets=n}return t.fromJson=function(e){var r=s(zt,e.type);return r&&new t(e.id,e.key,r,D.mapNotNullOrUndefined(e.targets,(function(t){return At.fromJson(t,Jt.SEGMENT)})))},t}(),Ct=function(){function t(t,e,r){this.id=t,this.bucketId=e,this.groups=r}return t.fromJson=function(e){return new t(e.id,e.bucketId,e.groups.map((function(t){return xt.fromJson(t)})))},t.prototype.getGroupOrNull=function(t){return this.groups.find((function(e){return e.id===t}))},t}(),xt=function(){function t(t,e){this.id=t,this.experiments=e}return t.fromJson=function(e){return new t(e.id,e.experiments)},t}(),Pt=function(){function t(t,e){this.id=t,this.parameters=e}return t.fromJson=function(e){return new t(e.id,D.associate(e.parameters,(function(t){return[t.key,t.value]})))},t.prototype.get=function(t,e){var r=this.parameters.get(t);return k.isNullOrUndefined(r)?e:k.isNullOrUndefined(e)||typeof r==typeof e?r:e},t}(),Ut=function(){function t(t,e,r,n,i,o){this.id=t,this.key=e,this.type=r,this.identifierType=n,this.targetRules=i,this.defaultValue=o}return t.fromJson=function(e){var r=s(Gt,e.type),n=D.mapNotNullOrUndefined(e.targetRules,(function(t){return kt.fromJson(t,Jt.PROPERTY)})),i=Dt.fromJson(e.defaultValue);return r&&new t(e.id,e.key,r,e.identifierType,n,i)},t}(),kt=function(){function t(t,e,r,n,i){this.key=t,this.name=e,this.target=r,this.bucketId=n,this.value=i}return t.fromJson=function(e,r){var n=At.fromJson(e.target,r);return n&&new t(e.key,e.name,n,e.bucketId,Dt.fromJson(e.value))},t}(),Dt=function(){function t(t,e){this.id=t,this.rawValue=e}return t.fromJson=function(e){return new t(e.id,e.value)},t}(),Lt=function(){function t(t,e,r){this.coreVersion=t,this.prerelease=e,this.build=r}return t.tryParse=function(e){var r=t.regExp.exec(e);if(r){r[0];var n=r[1],i=r[2],o=void 0===i?"0":i,s=r[3],u=void 0===s?"0":s,a=r[4],c=r[5];return new t(new Ft(parseInt(n,10),parseInt(o,10),parseInt(u,10)),Vt.parse(a),Vt.parse(c))}},t.prototype.compareTo=function(t){return this.coreVersion.compareTo(t.coreVersion)||this.prerelease.compareTo(t.prerelease)},t.prototype.isEqualTo=function(t){return 0===this.compareTo(t)},t.prototype.isGreaterThan=function(t){return this.compareTo(t)>0},t.prototype.isGreaterThanOrEqualTo=function(t){return this.compareTo(t)>=0},t.prototype.isLessThan=function(t){return this.compareTo(t)<0},t.prototype.isLessThanOrEqualTo=function(t){return this.compareTo(t)<=0},t.regExp=/^(0|[1-9]\d*)(?:\.(0|[1-9]\d*))?(?:\.(0|[1-9]\d*))?(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/,t}(),Ft=function(){function t(t,e,r){this.major=t,this.minor=e,this.patch=r}return t.prototype.compareTo=function(t){return a(this.major,t.major)||a(this.minor,t.minor)||a(this.patch,t.patch)},t}(),Vt=function(){function t(t){this.identifiers=t}return t.parse=function(e){return e?new t(e.split(".")):t.EMPTY},t.prototype.isEmpty=function(){return 0===this.identifiers.length},t.prototype.isNotEmpty=function(){return!this.isEmpty()},t.prototype.compareTo=function(t){return this.isEmpty()&&t.isEmpty()?0:this.isEmpty()&&t.isNotEmpty()?1:this.isNotEmpty()&&t.isEmpty()?-1:this.compareIdentifiers(t)},t.prototype.compareIdentifiers=function(e){for(var r=Math.min(this.identifiers.length,e.identifiers.length),n=0;n<r;n++){var i=t.compareIdentifiers(this.identifiers[n],e.identifiers[n]);if(0!==i)return i}return a(this.identifiers.length,e.identifiers.length)},t.compareIdentifiers=function(e,r){return t.numericIdentifierRegExp.test(e)&&t.numericIdentifierRegExp.test(r)?a(+e,+r):e===r?0:e<r?-1:1},t.EMPTY=new t([]),t.numericIdentifierRegExp=/^(0|[1-9]\d*)$/,t}(),jt=["MATCH","NOT_MATCH"],Gt=["STRING","NUMBER","BOOLEAN","VERSION","JSON","NULL","UNKNOWN"],Bt=["IN","CONTAINS","STARTS_WITH","ENDS_WITH","GT","GTE","LT","LTE"],Ht=["VARIATION","BUCKET"],Kt=["USER_ID","USER_PROPERTY","HACKLE_PROPERTY","SEGMENT","AB_TEST","FEATURE_FLAG","EVENT_PROPERTY"],zt=["USER_ID","USER_PROPERTY"],Jt=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this.supportedKeyTypes=t}return t.prototype.supports=function(t){return this.supportedKeyTypes.includes(t)},t.IDENTIFIER=new t("SEGMENT"),t.PROPERTY=new t("SEGMENT","USER_PROPERTY","HACKLE_PROPERTY","AB_TEST","FEATURE_FLAG","EVENT_PROPERTY"),t.SEGMENT=new t("USER_ID","USER_PROPERTY","HACKLE_PROPERTY"),t}(),qt=["ACTIVE","DRAFT","PAUSE"],Yt=["WEB","ANDROID","IOS"],Xt=["IMMEDIATE","CUSTOM"],Wt=["MODAL"],$t=["IMAGE_TEXT","IMAGE_ONLY","TEXT_ONLY"],Zt=["VERTICAL","HORIZONTAL"],Qt=["CLICK"],te=["CLOSE","WEB_LINK","HIDDEN","LINK_AND_CLOSE"],ee=function(){function t(t,e,r,n,i,o,s){this.id=t,this.key=e,this.status=r,this.period=n,this.eventTrigger=i,this.targetContext=o,this.messageContext=s}return t.fromJson=function(e){var r=s(qt,e.status);if(!k.isNullOrUndefined(r)){var n;switch(s(Xt,e.timeUnit)){case"IMMEDIATE":n=new re;break;case"CUSTOM":if(k.isNullOrUndefined(e.startEpochTimeMillis))return;if(k.isNullOrUndefined(e.endEpochTimeMillis))return;n=new ne(e.startEpochTimeMillis,e.endEpochTimeMillis);break;default:return}var i=pe.fromJson(e.messageContext);if(!k.isNullOrUndefined(i)){var o=e.eventTriggerRules.map(oe.fromJson),u=se.fromJson(e.eventFrequencyCap);return new t(e.id,e.key,r,n,new ie(o,u),ce.fromJson(e.targetContext),i)}}},t.prototype.supports=function(t){return this.messageContext.platformTypes.includes(t)},t}(),re=function(){function t(){this.type="IMMEDIATE"}return t.prototype.within=function(){return!0},t}(),ne=function(){function t(t,e){this.startMillisInclusive=t,this.endMillisExclusive=e,this.type="CUSTOM"}return t.prototype.within=function(t){return this.startMillisInclusive<=t&&t<this.endMillisExclusive},t
}(),ie=function(t,e){this.rules=t,this.frequencyCap=e},oe=function(){function t(t,e){this.eventKey=t,this.targets=e}return t.fromJson=function(e){return new t(e.eventKey,D.mapNotNullOrUndefined(e.targets,(function(t){return At.fromJson(t,Jt.PROPERTY)})))},t}(),se=function(){function t(t,e){this.identifierCaps=t,this.durationCap=e}return t.fromJson=function(e){return e?new t(e.identifiers.map(ue.fromJson),ae.fromJson(e.duration)):null},t}(),ue=function(){function t(t,e){this.identifierType=t,this.count=e}return t.fromJson=function(e){return new t(e.identifierType,e.countPerIdentifier)},t}(),ae=function(){function t(t,e){this.durationMillis=t,this.count=e}return t.fromJson=function(e){if(!e)return null;var r=s(ot,e.durationUnit.timeUnit);return r?new t(st.converter[r](e.durationUnit.amount,"milliseconds"),e.countPerDuration):null},t}(),ce=function(){function t(t,e){this.overrides=t,this.targets=e}return t.fromJson=function(e){return new t(e.overrides.map(fe.fromJson),D.mapNotNullOrUndefined(e.targets,(function(t){return At.fromJson(t,Jt.PROPERTY)})))},t}(),fe=function(){function t(t,e){this.identifierType=t,this.identifiers=e}return t.fromJson=function(e){return new t(e.identifierType,e.identifiers)},t}(),pe=function(){function t(t,e,r,n){this.defaultLang=t,this.platformTypes=e,this.orientations=r,this.messages=n}return t.fromJson=function(e){var r=u(Yt,e.platformTypes);if(!k.isNullOrUndefined(r)){var n=u(Zt,e.orientations);if(!k.isNullOrUndefined(n)){var i=D.mapOrUndefined(e.messages,le.fromJson);if(!k.isNullOrUndefined(i))return new t(e.defaultLang,r,n,i)}}},t}(),le=function(){function t(t,e,r,n,i,o,s){this.lang=t,this.layout=e,this.images=r,this.text=n,this.buttons=i,this.closeButton=o,this.background=s}return t.fromJson=function(e){var r=he.fromJson(e.layout);if(!k.isNullOrUndefined(r)){var n=D.mapOrUndefined(e.images,de.fromJson);if(!k.isNullOrUndefined(n)){var i=D.mapOrUndefined(e.buttons,ge.fromJson);if(!k.isNullOrUndefined(i)){var o=void 0;if(!k.isNotNullOrUndefined(e.closeButton)||(o=ge.fromJson2(e.closeButton),!k.isNullOrUndefined(o)))return new t(e.lang,r,n,e.text?ve.fromJson(e.text):void 0,i,o,new we(e.background.color))}}}},t.prototype.toJson=function(){var t,e,r,n;return{lang:this.lang,layout:{layoutType:this.layout.layoutType,displayType:this.layout.displayType},images:this.images.map((function(t){return t.toJson()})),text:null!==(e=null===(t=this.text)||void 0===t?void 0:t.toJson())&&void 0!==e?e:null,closeButton:null!==(n=null===(r=this.closeButton)||void 0===r?void 0:r.toCloseButtonJson())&&void 0!==n?n:null,buttons:this.buttons.map((function(t){return t.toJson()})),background:{color:this.background.color}}},t}(),he=function(){function t(t,e){this.displayType=t,this.layoutType=e}return t.fromJson=function(e){var r=s($t,e.layoutType),n=s(Wt,e.displayType);if(!k.isNullOrUndefined(n)&&!k.isNullOrUndefined(r))return new t(n,r)},t}(),de=function(){function t(t,e,r){this.orientation=t,this.imagePath=e,this.action=r}return t.fromJson=function(e){var r=s(Zt,e.orientation);if(!k.isNullOrUndefined(r)){var n=void 0;if(!k.isNotNullOrUndefined(e.action)||(n=Te.fromJson(e.action),!k.isNullOrUndefined(n)))return new t(r,e.imagePath,n)}},t.prototype.toJson=function(){var t,e;return{orientation:this.orientation,imagePath:this.imagePath,action:null!==(e=null===(t=this.action)||void 0===t?void 0:t.toJson())&&void 0!==e?e:null}},t}(),ve=function(){function t(t,e){this.title=t,this.body=e}return t.fromJson=function(e){return new t(ye.fromJson(e.title),ye.fromJson(e.body))},t.prototype.toJson=function(){return{title:{text:this.title.text,style:{textColor:this.title.style.color}},body:{text:this.body.text,style:{textColor:this.body.style.color}}}},t}(),ye=function(){function t(t,e){this.text=t,this.style=e}return t.fromJson=function(e){return new t(e.text,new me(e.style.textColor))},t}(),me=function(t){this.color=t},ge=function(){function t(t,e,r){this.text=t,this.style=e,this.action=r}return t.fromJson=function(e){var r=Te.fromJson(e.action);if(!k.isNullOrUndefined(r))return new t(e.text,new Ee(e.style.textColor,e.style.bgColor,e.style.borderColor),r)},t.fromJson2=function(e){var r=Te.fromJson(e.action);if(!k.isNullOrUndefined(r))return new t("\u2715",new Ee(e.style.color,"#FFFFFF","#FFFFFF"),r)},t.prototype.toJson=function(){return{text:this.text,action:this.action.toJson(),style:{textColor:this.style.textColor,bgColor:this.style.backgroundColor,borderColor:this.style.backgroundColor}}},t.prototype.toCloseButtonJson=function(){return{action:this.action.toJson(),style:{color:this.style.textColor}}},t}(),Ee=function(t,e,r){this.textColor=t,this.backgroundColor=e,this.borderColor=r},we=function(t){this.color=t},Te=function(){function t(t,e,r){this.behavior=t,this.type=e,this.value=r}return t.fromJson=function(e){var r,n=s(Qt,e.behavior);if(!k.isNullOrUndefined(n)){var i=s(te,e.type);if(!k.isNullOrUndefined(i))return new t(n,i,null!==(r=e.value)&&void 0!==r?r:void 0)}},t.prototype.toJson=function(){var t;return{behavior:this.behavior,type:this.type,value:null!==(t=this.value)&&void 0!==t?t:null}},t}(),_e=function(){function t(t){this.name=t,this._tags={},this.name=t}return t.prototype.tags=function(t){var e=this;return Object.entries(t).forEach((function(t){var r=t[0],n=t[1];e._tags[r]=n})),this},t.prototype.tag=function(t,e){return this._tags[t]=e,this},t.prototype.register=function(t){return t.registerTimer({name:this.name,tags:this._tags,type:"TIMER"})},t}(),Ie=function(){function t(t){this._clock=t,this.startTime=this._clock.tick()}return t.start=function(e){return void 0===e&&(e=t.defaultClock),new t(e)},t.prototype.stop=function(t){var e=this._clock.tick()-this.startTime;t.record(e,"microseconds")},t.defaultClock=new ut,t}(),Ae=function(){function t(t){this.name=t,this._tags={}}return t.prototype.tags=function(t){var e=this;return Object.entries(t).forEach((function(t){var r=t[0],n=t[1];e._tags[r]=n})),this},t.prototype.tag=function(t,e){return this._tags[t]=e,this},t.prototype.register=function(t){return t.registerCounter({name:this.name,tags:this._tags,type:"COUNTER"})},t}(),Ne=function(){function t(t,e){this.valueSupplier=e,this.field=t}return Object.defineProperty(t.prototype,"value",{get:function(){return this.valueSupplier()},enumerable:!1,configurable:!0}),t}(),Oe=function(){function t(t){this.counterValue=0,this.id=t}return t.prototype.count=function(){return this.counterValue},t.prototype.increment=function(t){this.counterValue+=null!=t?t:1},t.prototype.measure=function(){return[new Ne("count",this.count.bind(this))]},t}(),be=function(){function t(t){this.id=t,this.currentCounter=new Oe(t)}return t.prototype.flush=function(){var t=this.currentCounter;return this.currentCounter=new Oe(this.id),t},t.prototype.count=function(){return this.currentCounter.count()},t.prototype.increment=function(t){this.currentCounter.increment(t)},t.prototype.measure=function(){return[new Ne("count",this.count.bind(this))]},t}(),Re=new Uint8Array(16),Se=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i,Me=[],Ce=0;Ce<256;++Ce)Me.push((Ce+256).toString(16).substr(1));h("v3",48,(function(t){if("string"==typeof t){var e=unescape(encodeURIComponent(t));t=new Uint8Array(e.length);for(var r=0;r<e.length;++r)t[r]=e.charCodeAt(r)}return function(t){for(var e=[],r=32*t.length,n="0123456789abcdef",i=0;i<r;i+=8){var o=t[i>>5]>>>i%32&255,s=parseInt(n.charAt(o>>>4&15)+n.charAt(15&o),16);e.push(s)}return e}(function(t,e){t[e>>5]|=128<<e%32,t[d(e)-1]=e;for(var r=1732584193,n=-271733879,i=-1732584194,o=271733878,s=0;s<t.length;s+=16){var u=r,a=n,c=i,f=o;r=m(r,n,i,o,t[s],7,-680876936),o=m(o,r,n,i,t[s+1],12,-389564586),i=m(i,o,r,n,t[s+2],17,606105819),n=m(n,i,o,r,t[s+3],22,-1044525330),r=m(r,n,i,o,t[s+4],7,-176418897),o=m(o,r,n,i,t[s+5],12,1200080426),i=m(i,o,r,n,t[s+6],17,-1473231341),n=m(n,i,o,r,t[s+7],22,-45705983),r=m(r,n,i,o,t[s+8],7,1770035416),o=m(o,r,n,i,t[s+9],12,-1958414417),i=m(i,o,r,n,t[s+10],17,-42063),n=m(n,i,o,r,t[s+11],22,-1990404162),r=m(r,n,i,o,t[s+12],7,1804603682),o=m(o,r,n,i,t[s+13],12,-40341101),i=m(i,o,r,n,t[s+14],17,-1502002290),r=g(r,n=m(n,i,o,r,t[s+15],22,1236535329),i,o,t[s+1],5,-165796510),o=g(o,r,n,i,t[s+6],9,-1069501632),i=g(i,o,r,n,t[s+11],14,643717713),n=g(n,i,o,r,t[s],20,-373897302),r=g(r,n,i,o,t[s+5],5,-701558691),o=g(o,r,n,i,t[s+10],9,38016083),i=g(i,o,r,n,t[s+15],14,-660478335),n=g(n,i,o,r,t[s+4],20,-405537848),r=g(r,n,i,o,t[s+9],5,568446438),o=g(o,r,n,i,t[s+14],9,-1019803690),i=g(i,o,r,n,t[s+3],14,-187363961),n=g(n,i,o,r,t[s+8],20,1163531501),r=g(r,n,i,o,t[s+13],5,-1444681467),o=g(o,r,n,i,t[s+2],9,-51403784),i=g(i,o,r,n,t[s+7],14,1735328473),r=E(r,n=g(n,i,o,r,t[s+12],20,-1926607734),i,o,t[s+5],4,-378558),o=E(o,r,n,i,t[s+8],11,-2022574463),i=E(i,o,r,n,t[s+11],16,1839030562),n=E(n,i,o,r,t[s+14],23,-35309556),r=E(r,n,i,o,t[s+1],4,-1530992060),o=E(o,r,n,i,t[s+4],11,1272893353),i=E(i,o,r,n,t[s+7],16,-155497632),n=E(n,i,o,r,t[s+10],23,-1094730640),r=E(r,n,i,o,t[s+13],4,681279174),o=E(o,r,n,i,t[s],11,-358537222),i=E(i,o,r,n,t[s+3],16,-722521979),n=E(n,i,o,r,t[s+6],23,76029189),r=E(r,n,i,o,t[s+9],4,-640364487),o=E(o,r,n,i,t[s+12],11,-421815835),i=E(i,o,r,n,t[s+15],16,530742520),r=w(r,n=E(n,i,o,r,t[s+2],23,-995338651),i,o,t[s],6,-198630844),o=w(o,r,n,i,t[s+7],10,1126891415),i=w(i,o,r,n,t[s+14],15,-1416354905),n=w(n,i,o,r,t[s+5],21,-57434055),r=w(r,n,i,o,t[s+12],6,1700485571),o=w(o,r,n,i,t[s+3],10,-1894986606),i=w(i,o,r,n,t[s+10],15,-1051523),n=w(n,i,o,r,t[s+1],21,-2054922799),r=w(r,n,i,o,t[s+8],6,1873313359),o=w(o,r,n,i,t[s+15],10,-30611744),i=w(i,o,r,n,t[s+6],15,-1560198380),n=w(n,i,o,r,t[s+13],21,1309151649),r=w(r,n,i,o,t[s+4],6,-145523070),o=w(o,r,n,i,t[s+11],10,-1120210379),i=w(i,o,r,n,t[s+2],15,718787259),n=w(n,i,o,r,t[s+9],21,-343485551),r=v(r,u),n=v(n,a),i=v(i,c),o=v(o,f)}return[r,n,i,o]}(function(t){if(0===t.length)return[];for(var e=8*t.length,r=new Uint32Array(d(e)),n=0;n<e;n+=8)r[n>>5]|=(255&t[n/8])<<n%32;return r}(t),8*t.length))})),h("v5",80,(function(t){var e=[1518500249,1859775393,2400959708,3395469782],r=[1732584193,4023233417,2562383102,271733878,3285377520];if("string"==typeof t){var n=unescape(encodeURIComponent(t));t=[];for(var i=0;i<n.length;++i)t.push(n.charCodeAt(i))}else Array.isArray(t)||(t=Array.prototype.slice.call(t));t.push(128);for(var o=t.length/4+2,s=Math.ceil(o/16),u=new Array(s),a=0;a<s;++a){for(var c=new Uint32Array(16),f=0;f<16;++f)c[f]=t[64*a+4*f]<<24|t[64*a+4*f+1]<<16|t[64*a+4*f+2]<<8|t[64*a+4*f+3];u[a]=c}u[s-1][14]=8*(t.length-1)/Math.pow(2,32),u[s-1][14]=Math.floor(u[s-1][14]),u[s-1][15]=8*(t.length-1)&4294967295;for(var p=0;p<s;++p){for(var l=new Uint32Array(80),h=0;h<16;++h)l[h]=u[p][h];for(var d=16;d<80;++d)l[d]=I(l[d-3]^l[d-8]^l[d-14]^l[d-16],1);for(var v=r[0],y=r[1],m=r[2],g=r[3],E=r[4],w=0;w<80;++w){var T=Math.floor(w/20),A=I(v,5)+_(T,y,m,g)+E+e[T]+l[w]>>>0;E=g,g=m,m=I(y,30)>>>0,y=v,v=A}r[0]=r[0]+v>>>0,r[1]=r[1]+y>>>0,r[2]=r[2]+m>>>0,r[3]=r[3]+g>>>0,r[4]=r[4]+E>>>0}return[r[0]>>24&255,r[0]>>16&255,r[0]>>8&255,255&r[0],r[1]>>24&255,r[1]>>16&255,r[1]>>8&255,255&r[1],r[2]>>24&255,r[2]>>16&255,r[2]>>8&255,255&r[2],r[3]>>24&255,r[3]>>16&255,r[3]>>8&255,255&r[3],r[4]>>24&255,r[4]>>16&255,r[4]>>8&255,255&r[4]]}));var xe,Pe=function(){function t(t){this.compareFn=t,this.data=new Map,this.compareFn=t,this.data=new Map}return t.prototype.values=function(){return Array.from(this.data.values())},t.prototype.keys=function(){return Array.from(this.data.keys())},t.prototype.get=function(t){var e=this,r=this.keys().find((function(r){return e.compareFn(r,t)}));return r?this.data.get(r):void 0},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.add=function(t,e){var r=e;return r||(r=t),this.data.set(t,r),this},t.prototype.delete=function(t){if(this.has(t)){var e=this.get(t);return this.data.delete(t),e}},t.prototype.forEach=function(t){this.data.forEach(t)},t.prototype.entries=function(){return Array.from(this.data.entries())},t}(),Ue=function(){function t(){this.id=T(),this.name="MetricRegistry",this._metrics=new Pe(c)}return Object.defineProperty(t.prototype,"metrics",{get:function(){return Array.from(this._metrics.values())},enumerable:!1,configurable:!0}),t.prototype.registerCounter=function(t){return this.registerMetricIfNecessary(t,this.createCounter.bind(this))},t.prototype.registerTimer=function(t){return this.registerMetricIfNecessary(t,this.createTimer.bind(this))},t.prototype.counter=function(t,e){return void 0===e&&(e={}),new Ae(t).tags(e).register(this)},t.prototype.timer=function(t,e){return void 0===e&&(e={}),new _e(t).tags(e).register(this)},t.prototype.registerMetricIfNecessary=function(t,e){return this.getOrCreateMetric(t,e)},t.prototype.getOrCreateMetric=function(t,e){var r,n=this._metrics.get(t);return n?r=n:(r=e(t),this._metrics.add(t,r)),r},t.prototype.close=function(){},t}(),ke=function(t){function r(e){var r=t.call(this)||this;return r.pushIntervalMillis=e,r.currentIntervalId=void 0,r.pushIntervalMillis=e,r}return e(r,t),r.prototype.start=function(){var t=this;void 0===this.currentIntervalId&&(this.currentIntervalId=setInterval((function(){t.publish()}),this.pushIntervalMillis),F.log.debug("PushMetricRegistry started. Publish metrics every ".concat(this.pushIntervalMillis,"ms.")))},r.prototype.stop=function(){void 0!==this.currentIntervalId&&(clearInterval(this.currentIntervalId),this.currentIntervalId=void 0,this.publish(),F.log.debug("PushMetricRegistry stopped."))},r.prototype.close=function(){this.stop()},r}(Ue),De=function(){function t(t){this._count=0,this._total=0,this._max=0,this.id=t}return t.prototype.count=function(){return this._count},t.prototype.totalTime=function(t){return st.nanosToUnit(this._total,t)},t.prototype.max=function(t){return st.nanosToUnit(this._max,t)},t.prototype.mean=function(t){return 0===this.count()?0:this.totalTime(t)/this.count()},t.prototype.record=function(t,e){if(!(t<0)){var r=st.converter[e](t,"nanoseconds");this._count=this.count()+1,this._total+=r,this._max=Math.max(r,this._max)}},t.prototype.measure=function(){var t=this;return[new Ne("count",this.count.bind(this)),new Ne("total",(function(){return t.totalTime("milliseconds")})),new Ne("max",(function(){return t.max("milliseconds")})),new Ne("mean",(function(){return t.mean("milliseconds")}))]},t}(),Le=function(){function t(t){this.id=t,this.currentTimer=new De(t)}return t.prototype.flush=function(){var t=this.currentTimer;return this.currentTimer=new De(this.id),t},t.prototype.count=function(){return this.currentTimer.count()},t.prototype.totalTime=function(t){return this.currentTimer.totalTime(t)},t.prototype.max=function(t){return this.currentTimer.max(t)},t.prototype.record=function(t,e){this.currentTimer.record(t,e)},t.prototype.mean=function(t){return 0===this.count()?0:this.totalTime(t)/this.count()},t.prototype.measure=function(){var t=this;return[new Ne("count",this.count.bind(this)),new Ne("total",(function(){return t.totalTime("milliseconds")})),new Ne("max",(function(){return t.max("milliseconds")})),new Ne("mean",(function(){return t.mean("milliseconds")}))]},t}(),Fe=function(t){function r(e){return t.call(this,e)||this}return e(r,t),r.prototype.createCounter=function(t){return new be(t)},r.prototype.createTimer=function(t){return new Le(t)},r.prototype.publish=function(){var t=this.metrics.reduce((function(t,e){return function(t){return void 0!==t.flush&&"function"==typeof t.flush}(e)?t.concat(e.flush()):t}),[]);this.flushMetrics(t)},r.prototype.close=function(){t.prototype.close.call(this)},r}(ke),Ve=function(){function t(t){this.id=t}return t.prototype.count=function(){return 0},t.prototype.increment=function(){},t.prototype.measure=function(){return[new Ne("count",this.count.bind(this))]},t}(),je=function(){function t(t){this._counters=new Pe((function(t,e){return t.id===e.id})),this.id=t,this.noopCounter=new Ve(t)}return Object.defineProperty(t.prototype,"counters",{get:function(){return Array.from(this._counters.values())},enumerable:!1,configurable:!0}),t.prototype.add=function(t){this._counters.add(t,t.registerCounter(this.id))},t.prototype.count=function(){return(this.counters[0]||this.noopCounter).count()},t.prototype.increment=function(t){this.counters.forEach((function(e){e.increment(t)}))},t.prototype.measure=function(){return[new Ne("count",this.count.bind(this))]},t}(),Ge=function(){function t(t){this.id=t}return t.prototype.measure=function(){var t=this;return[new Ne("count",this.count.bind(this)),new Ne("total",(function(){return t.totalTime("milliseconds")})),new Ne("max",(function(){return t.max("milliseconds")})),new Ne("mean",(function(){return t.mean("milliseconds")}))]},t.prototype.count=function(){return 0},t.prototype.totalTime=function(){return 0},t.prototype.max=function(){return 0},t.prototype.mean=function(){return 0},t.prototype.record=function(){},t}(),Be=function(){function t(t){this._timers=new Pe((function(t,e){return t.id===e.id})),this.id=t,this.noopTimer=new Ge(t)}return Object.defineProperty(t.prototype,"firstTimer",{get:function(){return this.timers[0]||this.noopTimer},enumerable:!1,configurable:!0}),t.prototype.totalTime=function(t){return this.firstTimer.totalTime(t)},t.prototype.max=function(t){return this.firstTimer.max(t)},t.prototype.mean=function(t){return this.firstTimer.mean(t)},t.prototype.record=function(t,e){this.timers.forEach((function(r){r.record(t,e)}))},Object.defineProperty(t.prototype,"timers",{get:function(){return Array.from(this._timers.values())},enumerable:!1,configurable:!0}),t.prototype.add=function(t){this._timers.add(t,t.registerTimer(this.id))},t.prototype.count=function(){return this.firstTimer.count()},t.prototype.measure=function(){var t=this;return[new Ne("count",this.count.bind(this)),new Ne("total",(function(){return t.totalTime("milliseconds")})),new Ne("max",(function(){return t.max("milliseconds")})),new Ne("mean",(function(){return t.mean("milliseconds")}))]},t}(),He=function(t){function r(){var e=null!==t&&t.apply(this,arguments)||this;return e.registries=new Pe((function(t,e){return t.id===e.id})),e}return e(r,t),r.prototype.createCounter=function(t){var e=new je(t);return this.addRegistry(e),e},r.prototype.createTimer=function(t){var e=new Be(t);return this.addRegistry(e),e},r.prototype.addRegistry=function(t){this.registries.forEach((function(e){return t.add(e)}))},r.prototype.add=function(t){t instanceof r||this.registries.has(t)||(this.registries.add(t),this.metrics.forEach((function(e){(function(t){return void 0!==t.add&&"function"==typeof t.add})(e)&&e.add(t)})))},r.prototype.close=function(){this.registries.forEach((function(t){t.close()}))},r}(Ue),Ke=function(){function t(){}return t.counter=function(e,r){return t.globalRegistry.counter(e,r)},t.timer=function(e,r){return t.globalRegistry.timer(e,r)},t.addRegistry=function(e){t.globalRegistry.add(e),F.log.debug("MetricRegistry added ".concat(e.name))},t.globalRegistry=new He,t}(),ze=function(t){function r(e,r,n,i,o){var s=t.call(this,r)||this;return s.monitoringBaseUrl=e,s.httpClient=n,s.httpHeader=i,s.useBeacon=o,s.monitoringEndPoint="".concat(s.monitoringBaseUrl,"/metrics"),s.shouldUseBeacon=!1,s.start(),s.monitoringBaseUrl=e,s}return e(r,t),r.prototype.flushMetrics=function(t){var e=this;D.chunked(t.filter(this.isDispatchTarget.bind(this)),100).forEach((function(t){e.dispatch(t)}))},r.prototype.isDispatchTarget=function(t){return!(!function(t){return"COUNTER"===t.id.type}(t)&&!function(t){return"TIMER"===t.id.type}(t))&&t.count()>0},r.prototype.dispatch=function(t){this.useBeacon&&this.shouldUseBeacon?this.httpClient.sendBeacon(this.monitoringEndPoint,this.batch(t),this.httpHeader,(function(){F.log.debug("Beacon called.")})):this.httpClient.postRequest(this.monitoringEndPoint,this.batch(t),this.httpHeader,(function(){}),(function(){F.log.debug("Failed to flushing metrics.")}))},r.prototype.batch=function(t){return{metrics:t.map((function(t){return{name:t.id.name,type:t.id.type,tags:t.id.tags,measurements:k.fromMap(D.associate(t.measure(),(function(t){return[t.field,t.value]})))}}))}},r.prototype.createCounter=function(t){return new be(t)},r.prototype.createTimer=function(t){return new Le(t)},r.prototype.close=function(){this.shouldUseBeacon=!0,t.prototype.close.call(this)},r}(Fe),Je=function(){function t(){}return t.experiment=function(t,e,r){var n=Ke.timer("experiment.decision",{key:String(e),variation:r.variation,reason:String(r.reason)});t.stop(n)},t.featureFlag=function(t,e,r){var n=Ke.timer("feature.flag.decision",{key:String(e),on:String(r.isOn),reason:String(r.reason)});t.stop(n)},t.remoteConfig=function(t,e,r){var n=Ke.timer("remote.config.decision",{key:String(e),reason:String(r.reason)});t.stop(n)},t.inAppMessage=function(t,e,r){var n=Ke.timer("iam.decision",{key:String(e),show:String(r.isShow()),reason:String(r.reason)});t.stop(n)},t}(),qe=function(){function t(){}return t.record=function(t,e,r){var n=Ke.timer("api.call",{operation:t,success:String(r)});e.stop(n)},t}(),Ye=function(){function t(){}return t.decide=function(t,e,r,n){if(k.isNullOrUndefined(r))return this.decision(t,e,"NULL",r,n);switch(typeof r){case"string":return this.decision(t,e,"STRING",r,n);case"number":return this.decision(t,e,"NUMBER",r,n);case"boolean":return this.decision(t,e,"BOOLEAN",r,n);default:return this.decision(t,e,"UNKNOWN",r,n)}},t.decision=function(t,e,r,n,i){return k.isNullOrUndefined(e)?ct.of(n,vt.INVALID_INPUT):t.remoteConfig(e,i,r,n)},t}(),Xe=F.log,We=function(){function t(t,e,r,n){this.core=t,this.userManager=e,this.hackleUserResolver=r,this.user=n}return t.prototype.get=function(t,e){var r,n=Ie.start();try{r=this.decide(t,e)}catch(n){Xe.error("Unexpected exception while deciding remote config parameter[".concat(t,"]. Returning default value. : ").concat(n)),r=ct.of(e,vt.EXCEPTION)}return Je.remoteConfig(n,t,r),r.value},t.prototype.decide=function(t,e){var r=this.userManager.resolveCurrentOrNull(this.user);if(!r)return Xe.warn("invalid user"),ct.of(e,vt.INVALID_INPUT);var n=this.hackleUserResolver.resolve(r);return Ye.decide(this.core,t,e,n)},t}(),$e=function(){function t(){this._properties=new Map,this.MAX_PROPERTIES_COUNT=128,this.MAX_PROPERTY_KEY_LENGTH=128}return t.prototype.contains=function(t){return this._properties.has(t)},t.prototype.remove=function(t){var e=this;return t instanceof Map&&t.forEach((function(t,r){e.remove(r)})),"string"==typeof t&&this._properties.delete(t),this},t.prototype.compute=function(t,e){var r=this._properties.get(t),n=e(r);null!==n?this.add(t,n):(null!==r||this.contains(t))&&this.remove(t)},t.prototype.add=function(t,e,r){if(void 0===r&&(r=!1),r&&this.contains(t))return this;if(this._properties.size>=this.MAX_PROPERTIES_COUNT)return this;if("string"==typeof t&&t.length>this.MAX_PROPERTY_KEY_LENGTH)return this;var n=it.sanitizeValue(t,e);return n?(this._properties.set(t,n),this):this},t.prototype.addProperties=function(t,e){var r=this;return void 0===e&&(e=!1),t.forEach((function(t,n){r.add(n,t,e)})),this},t.prototype.build=function(){return this._properties},t}();!function(t){t.SET="$set",t.SET_ONCE="$setOnce",t.UNSET="$unset",t.INCREMENT="$increment",t.APPEND="$append",t.APPEND_ONCE="$appendOnce",t.PREPEND="$prepend",t.PREPEND_ONCE="$prependOnce",t.REMOVE="$remove",t.CLEAR_ALL="$clearAll"}(xe||(xe={}));var Ze=function(){function t(){}return t.prototype.operate=function(t,e){return 0===t.size?e:0===e.size?t:(new $e).addProperties(t).addProperties(e).build()},t}(),Qe=function(){function t(){}return t.prototype.operate=function(t,e){return 0===t.size?e:0===e.size?t:(new $e).addProperties(t).addProperties(e,!0).build()},t}(),tr=function(){function t(){}return t.prototype.operate=function(t,e){return 0===t.size?new Map:0===e.size?t:(new $e).addProperties(t).remove(e).build()},t}(),er=function(){function t(){}return t.prototype.operate=function(t,e){var r=this;if(0===e.size)return t;var n=new $e;return n.addProperties(t),e.forEach((function(t,e){n.compute(e,(function(e){return r.increment(e,t)}))})),n.build()},t.prototype.increment=function(t,e){return"number"!=typeof e?t:"number"!=typeof t?null==t?e:t:t+e},t}(),rr=function(){function t(){}return t.prototype.operate=function(t,e){var r=this;if(0===e.size)return t;var n=new $e;return n.addProperties(t),e.forEach((function(t,e){n.compute(e,(function(e){return r.compute(e,t)}))})),n.build()},t.prototype.compute=function(t,e){var r=this.toArray(t),n=this.toArray(e);return this.operateArray(r,n)},t.prototype.toArray=function(t){return null==t?[]:Array.isArray(t)?t:[t]},t.prototype.contains=function(t,e){return t.includes(e)},t.prototype.prepend=function(t,e,r){return void 0===r&&(r=!1),r&&this.contains(e,t)?e:i([t],e,!0)},t.prototype.append=function(t,e,r){return void 0===r&&(r=!1),r&&this.contains(t,e)?t:i(i([],t,!0),[e],!1)},t}(),nr=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.operateArray=function(t,e){var r=this;return e.reduce((function(t,e){return r.append.bind(r)(t,e)}),t)},r}(rr),ir=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.operateArray=function(t,e){return e.reduce(this.appendOnce.bind(this),t)},r.prototype.appendOnce=function(t,e){return this.append(t,e,!0)},r}(rr),or=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.operateArray=function(t,e){var r=this;return e.reduceRight((function(t,e){return r.prepend.bind(r)(e,t)}),t)},r}(rr),sr=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.operateArray=function(t,e){var r=this;return e.reduce(this.appendOnce.bind(this),[]).reduceRight((function(t,e){return r.prependOnce.bind(r)(e,t)}),t)},r.prototype.appendOnce=function(t,e){return this.append(t,e,!0)},r.prototype.prependOnce=function(t,e){return this.prepend(t,e,!0)},r}(rr),ur=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r.prototype.operateArray=function(t,e){return e.reduce(this.remove.bind(this),t)},r.prototype.remove=function(t,e){return t.filter((function(t){return t!==e}))},r}(rr),ar=function(){function t(){}return t.prototype.operate=function(){return new Map},t}(),cr=function(){function t(){}return t.get=function(t){switch(t){case xe.SET:return new Ze;case xe.SET_ONCE:return new Qe;case xe.UNSET:return new tr;case xe.INCREMENT:return new er;case xe.APPEND:return new nr;case xe.APPEND_ONCE:return new ir;case xe.PREPEND:return new or;case xe.PREPEND_ONCE:return new sr;case xe.CLEAR_ALL:return new ar;case xe.REMOVE:return new ur}},t}(),fr=function(){function t(){this.operations=new Map}return t.prototype.set=function(t,e){return this.add(xe.SET,t,e)},t.prototype.setOnce=function(t,e){return this.add(xe.SET_ONCE,t,e)},t.prototype.unset=function(t){return this.add(xe.UNSET,t,"-")},t.prototype.increment=function(t,e){return this.add(xe.INCREMENT,t,e)},t.prototype.append=function(t,e){return this.add(xe.APPEND,t,e)},t.prototype.appendOnce=function(t,e){return this.add(xe.APPEND_ONCE,t,e)},t.prototype.prepend=function(t,e){return this.add(xe.PREPEND,t,e)},t.prototype.prependOnce=function(t,e){return this.add(xe.PREPEND_ONCE,t,e)},t.prototype.remove=function(t,e){return this.add(xe.REMOVE,t,e)},t.prototype.clearAll=function(){return this.add(xe.CLEAR_ALL,"clearAll","-")},t.prototype.build=function(){var t=Array.from(this.operations.entries()).map((function(t){return[t[0],t[1].build()]}));return new pr(new Map(t))},t.prototype.containsKey=function(t){return Array.from(this.operations.entries()).some((function(e){return e[0],e[1].contains(t)}))},t.prototype.add=function(t,e,r){if(this.containsKey(e))return this;this.operations.has(t)||this.operations.set(t,new $e);var n=this.operations.get(t);return null==n||n.add(e,r),this},t}(),pr=function(){function t(t){this.operations=null!=t?t:new Map}return t.prototype.operate=function(t){var e=t;return this.operations.forEach((function(t,r){e=cr.get(r).operate(e,t)})),e},t.prototype.toEvent=function(){var t={key:"$properties"};return this.operations.forEach((function(e,r){var n,i;t.properties=U(U({},t.properties),((n={})[r]=U(U({},null===(i=t.properties)||void 0===i?void 0:i[r]),it.sanitize(k.fromMap(e))),n))})),t},t}(),lr=F.log,hr=function(){function t(t,e,r,n,i){this.core=t,this.hackleUserResolver=e,this.sessionManager=r,this.userManager=n,this.devTools=i}return t.prototype.getSessionId=function(){return this.sessionManager.sessionId},t.prototype.getUser=function(){return this.userManager.currentUser},t.prototype.setUser=function(t){try{var e=It(t);if(!e)return void lr.warn("invalid user");this.userManager.setUser(e)}catch(t){lr.error("Unexpected exception while set user: ".concat(t))}},t.prototype.setUserId=function(t){try{void 0===t&&this.userManager.setUserId(void 0);var e=rt.sanitizeValue(t);if(!e)return void lr.warn("Invalid userId. [userId=".concat(t,"]"));this.userManager.setUserId(e)}catch(t){lr.error("Unexpected exception while set userId: ".concat(t))}},t.prototype.setDeviceId=function(t){try{if(!rt.sanitizeValue(t))return void lr.warn("Invalid deviceId. [deviceId=".concat(t,"]"));this.userManager.setDeviceId(t)}catch(t){lr.error("Unexpected exception while set deviceId: ".concat(t))}},t.prototype.setUserProperty=function(t,e){var r=(new fr).set(t,e).build();this.updateUserProperties(r)},t.prototype.setUserProperties=function(t){try{var e=it.sanitize(t),r=new fr;Object.entries(e).forEach((function(t){var e=t[0],n=t[1];r.set(e,n)})),this.updateUserProperties(r.build())}catch(t){lr.error("Unexpected exception while set userProperties: ".concat(t))}},t.prototype.updateUserProperties=function(t){try{var e=t.toEvent();this.track(e),this.userManager.updateUserProperties(t)}catch(t){lr.error("Unexpected exception while update userProperties: ".concat(t))}},t.prototype.resetUser=function(){try{this.userManager.resetUser();var t=(new fr).clearAll().build();this.track(t.toEvent())}catch(t){lr.error("Unexpected exception while reset user: ".concat(t))}},t.prototype.variation=function(t,e,r){return this.variationDetail(t,e,r).variation},t.prototype.variationDetail=function(t,e,r){var n=r||"A",i=Ie.start(),o=function(r){try{var i=r.userManager.resolveCurrentOrNull(e);if(!i)return lr.warn("invalid user"),pt.of(n,vt.INVALID_INPUT);var o=r.hackleUserResolver.resolve(i);return r.core.experiment(t,o,n)}catch(e){return lr.error("Unexpected exception while deciding variation for experiment[".concat(t,"]. Returning default variation[").concat(n,"] : ").concat(e)),pt.of(n,vt.EXCEPTION)}}(this);return Je.experiment(i,t,o),o},t.prototype.isFeatureOn=function(t,e){return this.featureFlagDetail(t,e).isOn},t.prototype.featureFlagDetail=function(t,e){var r=Ie.start(),n=function(r){try{var n=r.userManager.resolveCurrentOrNull(e);if(!n)return lr.warn("invalid user"),lt.off(vt.INVALID_INPUT);var i=r.hackleUserResolver.resolve(n);return r.core.featureFlag(t,i)}catch(e){return lr.error("Unexpected exception while deciding feature flag[".concat(t,"]. Returning default value[false] : ").concat(e)),lt.off(vt.EXCEPTION)}}(this);return Je.featureFlag(r,t,n),n},t.prototype.track=function(t,e){try{lr.debug("track event : ".concat(JSON.stringify(t)));var r=this._convertEvent(t),n=this.userManager.resolveCurrentOrNull(e);if(!n)return void lr.warn("invalid user");var i=this.hackleUserResolver.resolve(n);this.core.track(r,i)}catch(t){lr.error("Unexpected exception while tracking event: ".concat(t))}},t.prototype.trackPageView=function(){lr.debug("tracking page view");var t=this.hackleUserResolver.resolve(this.userManager.currentUser);this.core.track({key:"$page_view"},t)},t.prototype.remoteConfig=function(t){return new We(this.core,this.userManager,this.hackleUserResolver,t)},t.prototype.onReady=function(t,e){void 0===e&&(e=K),this.core.onReady(t,e)},t.prototype.onInitialized=function(t){return this.core.onInitialized({timeout:null==t?void 0:t.timeout})},t.prototype.close=function(){lr.debug("Hackle Client is closing"),this.core.close()},t.prototype._convertEvent=function(t){return"string"==typeof t?{key:t}:t},t.prototype.showUserExplorer=function(){var t;(null===(t=this.devTools)||void 0===t?void 0:t.userExplorer)?(lr.debug("UserExplorer opened."),Ke.counter("user.explorer.show",{}).increment(),this.devTools.manager.userExplorer(this.devTools.userExplorer)):lr.error("UserExplorer is not provided")},t.prototype.hideUserExplorer=function(){this.devTools?this.devTools.manager.close():lr.warn("There is no active HackleDevtools.")},t}(),dr=function(){function t(t,e,r){void 0===r&&(r=T()),this.timestamp=t,this.user=e,this.insertId=r}return t.exposure=function(t,e,r,n){return new vr(n,t,e.experiment,e.variationId,e.variationKey,e.reason,r)},t.track=function(t,e,r,n){return new yr(n,r,t,e)},t.remoteConfig=function(t,e,r,n){
return new mr(n,t,e.parameter,e.valueId,e.reason,r)},t.isExposure=function(t){return void 0!==t.experiment},t.isTrack=function(t){return void 0!==t.eventType},t.isRemoteConfig=function(t){return void 0!==t.parameter},t.isExposureDto=function(t){return"experimentId"in t&&void 0!==t.experimentId},t.isTrackDto=function(t){return"eventTypeId"in t&&void 0!==t.eventTypeId},t.isRemoteConfigDto=function(t){return"parameterId"in t&&void 0!==t.parameterId},t.prototype.toDto=function(){return{insertId:this.insertId,timestamp:this.timestamp,userId:this.user.identifiers[Tt.ID],identifiers:this.user.identifiers,userProperties:it.sanitize(this.user.properties),hackleProperties:it.sanitize(this.user.hackleProperties)}},t}(),vr=function(t){function r(e,r,n,i,o,s,u,a){var c=t.call(this,e,r,a)||this;return c.experiment=n,c.variationId=i,c.variationKey=o,c.decisionReason=s,c.properties=u,c}return e(r,t),r.prototype.copyWithUser=function(t){return new r(this.timestamp,t,this.experiment,this.variationId,this.variationKey,this.decisionReason,this.properties,this.insertId)},r.prototype.toDto=function(){return U(U({},t.prototype.toDto.call(this)),{experimentId:this.experiment.id,experimentKey:this.experiment.key,experimentType:this.experiment.type,experimentVersion:this.experiment.version,variationId:this.variationId,variationKey:this.variationKey,decisionReason:this.decisionReason.toString(),properties:this.properties})},r}(dr),yr=function(t){function r(e,r,n,i,o){var s=t.call(this,e,r,o)||this;return s.eventType=n,s.event=i,s}return e(r,t),r.prototype.copyWithUser=function(t){return new r(this.timestamp,t,this.eventType,this.event,this.insertId)},r.prototype.toDto=function(){return U(U({},t.prototype.toDto.call(this)),{eventTypeId:this.eventType.id,eventTypeKey:this.eventType.key,value:this.event.value||0,properties:it.sanitize(this.event.properties)})},r}(dr),mr=function(t){function r(e,r,n,i,o,s,u){var a=t.call(this,e,r,u)||this;return a.parameter=n,a.valueId=i,a.decisionReason=o,a.properties=s,a}return e(r,t),r.prototype.copyWithUser=function(t){return new r(this.timestamp,t,this.parameter,this.valueId,this.decisionReason,this.properties,this.insertId)},r.prototype.toDto=function(){return U(U({},t.prototype.toDto.call(this)),{parameterId:this.parameter.id,parameterKey:this.parameter.key,parameterType:this.parameter.type,valueId:this.valueId,decisionReason:this.decisionReason.toString(),properties:it.sanitize(this.properties)})},r}(dr),gr=function(){function t(t,e,r){this.sdkKey=t,this.httpRequest=e,this.headers=r.headers,this.dispatchUrl=r.dispatchUrl,this.beaconDispatchUrl=r.beaconDispatchUrl||"",this.useBeacon=r.useBeacon||!1}return t.prototype.dispatch=function(t,e,r){var n={};n[j]=this.sdkKey,n[G]=this.headers[G],n[B]=this.headers[B],n[H]=(new Date).getTime().toString();var i=A(t),o=Ie.start();this.httpRequest.postRequest(this.dispatchUrl,i,n,(function(t){e(t),qe.record("post.events",o,!0)}),(function(t){null==r||r(t),qe.record("post.events",o,!1)}))},t.prototype.dispatchXhrOrBeacon=function(t,e,r){if(this.useBeacon){var n={};n[j]=this.sdkKey,n[G]=this.headers[G],n[B]=this.headers[B],n[H]=(new Date).getTime().toString();var i=A(t),o=Ie.start();this.httpRequest.sendBeacon(this.beaconDispatchUrl,i,n,(function(t){e(t),qe.record("post.events",o,!0)}),(function(t){null==r||r(t),qe.record("post.events",o,!1)}))}else this.dispatch(t,e,r)},t}(),Er=function(){function t(t,e,r,n,i,o,s,u,a){this.experiments=D.associateBy(t,(function(t){return t.key})),this.featureFlags=D.associateBy(e,(function(t){return t.key})),this.buckets=D.associateBy(r,(function(t){return t.id})),this.eventTypes=D.associateBy(n,(function(t){return t.key})),this.segments=D.associateBy(i,(function(t){return t.key})),this.containers=D.associateBy(o,(function(t){return t.id})),this.parameterConfigurations=D.associateBy(s,(function(t){return t.id})),this.remoteConfigParameters=D.associateBy(u,(function(t){return t.key})),this.inAppMessages=D.associateBy(a,(function(t){return t.key}))}return t.prototype.getExperiments=function(){return Array.from(this.experiments.values())},t.prototype.getFeatureFlags=function(){return Array.from(this.featureFlags.values())},t.prototype.getInAppMessages=function(){return Array.from(this.inAppMessages.values())},t.prototype.getExperimentOrNull=function(t){return this.experiments.get(t)},t.prototype.getFeatureFlagOrNull=function(t){return this.featureFlags.get(t)},t.prototype.getBucketOrNull=function(t){return this.buckets.get(t)},t.prototype.getEventTypeOrNull=function(t){return this.eventTypes.get(t)},t.prototype.getSegmentOrNull=function(t){return this.segments.get(t)},t.prototype.getContainerOrNull=function(t){return this.containers.get(t)},t.prototype.getParameterConfigurationOrNull=function(t){return this.parameterConfigurations.get(t)},t.prototype.getRemoteConfigParameterOrNull=function(t){return this.remoteConfigParameters.get(t)},t.prototype.getInAppMessageOrNull=function(t){return this.inAppMessages.get(t)},t.from=function(e){return new t(D.mapNotNullOrUndefined(e.experiments,(function(t){return yt.fromJson("AB_TEST",t)})),D.mapNotNullOrUndefined(e.featureFlags,(function(t){return yt.fromJson("FEATURE_FLAG",t)})),e.buckets.map(gt.fromJson),e.events.map(wt.fromJson),D.mapNotNullOrUndefined(e.segments,Mt.fromJson),e.containers.map(Ct.fromJson),e.parameterConfigurations.map(Pt.fromJson),D.mapNotNullOrUndefined(e.remoteConfigParameters,Ut.fromJson),D.mapNotNullOrUndefined(e.inAppMessages,ee.fromJson))},t}(),wr=function(){function t(t,e,r){var n=this;this.workspace=null,this.sdkKey=t,this.httpRequest=e,this.isStarted=!1,this.updateInterval=r.updateInterval,this.fetchUrl=r.fetchUrl,this.headers=r.headers,this.readyPromiseResolver=function(){},this.readyPromiseRejecter=function(){},this.readyPromise=new Promise((function(t,e){n.readyPromiseResolver=t,n.readyPromiseRejecter=e})),this.currentTimeout=null,this.errorRetryController=new Tr,this.currentRequest=null,this.syncOnCurrentRequestComplete=!1,this.isReadyPromiseSettled=!1}return t.prototype.onReady=function(){return this.readyPromise},t.prototype.start=function(){this.isStarted||(this.isStarted=!0,this.errorRetryController.reset(),this.fetch())},t.prototype.stop=function(){return this.isStarted=!1,this.currentTimeout&&(clearTimeout(this.currentTimeout),this.currentTimeout=null),this.currentRequest&&(this.currentRequest.abort(),this.currentRequest=null),Promise.resolve()},t.prototype.get=function(){return this.workspace},t.prototype.scheduleNextUpdate=function(){var t=this,e=this.errorRetryController.getDelay(),r=Math.max(e,this.updateInterval);this.currentTimeout=setTimeout((function(){t.currentRequest?t.syncOnCurrentRequestComplete=!0:t.fetch()}),r)},t.prototype.fetch=function(){var t,e,r=this,n=((t={})[j]=this.sdkKey,t[H]=(new Date).getTime().toString(),t[G]=this.headers[G],t[B]=this.headers[B],t),i=Ie.start();this.currentRequest=this.httpRequest.getRequest(this.fetchUrl,n);var o=function(t){var e=t.isSuccess;qe.record("get.workspace",i,e)},s=function(){r.onRequestComplete()};null===(e=this.currentRequest)||void 0===e||e.responsePromise.then((function(t){r.onRequestResolved(t,o)}),(function(t){r.onRequestRejected(t,o)})).then(s,s),this.updateInterval>0&&this.scheduleNextUpdate()},t.prototype.onRequestComplete=function(){this.isStarted&&(this.currentRequest=null,this.syncOnCurrentRequestComplete&&this.fetch(),this.syncOnCurrentRequestComplete=!1)},t.prototype.onRequestResolved=function(t,e){if(this.isStarted){if(void 0!==t.statusCode&&t.statusCode>=200&&t.statusCode<400)this.errorRetryController.reset(),e({isSuccess:!0});else{if(e({isSuccess:!1}),401===t.statusCode||403===t.statusCode)return void this.readyPromiseRejecter(new Error("Invalid key provided."));this.errorRetryController.countError()}if(t.body){var r=JSON.parse(t.body);this.workspace=Er.from(r),this.readyPromiseResolver()}}},t.prototype.onRequestRejected=function(t,e){this.isStarted&&(e({isSuccess:!1}),this.errorRetryController.countError())},t.prototype.close=function(){this.stop()},t}(),Tr=function(){function t(){this.errorCount=0}return t.prototype.getDelay=function(){return 0===this.errorCount?0:1e3*z[Math.min(z.length-1,this.errorCount)]+Math.round(1e3*Math.random())},t.prototype.countError=function(){this.errorCount<z.length-1&&this.errorCount++},t.prototype.reset=function(){this.errorCount=0},t}(),_r="model",Ir="name",Ar="type",Nr="vendor",Or="version",br="architecture",Rr="console",Sr="mobile",Mr="tablet",Cr="smarttv",xr="wearable",Pr=function(){function t(){}return t.parse=function(e){return{browser:t.getBrowser(e),cpu:t.getCPU(e),device:t.getDevice(e),engine:t.getEngine(e),os:t.getOS(e)}},t.getBrowser=function(e){var r={name:void 0,version:void 0,major:void 0};return t.mapper.rgx.call(r,e,t.regexes.browser),r.major=t.util.major(r.version),r},t.getCPU=function(e){var r={architecture:void 0};return t.mapper.rgx.call(r,e,t.regexes.cpu),r},t.getDevice=function(e){var r={model:void 0,type:void 0,vendor:void 0};return t.mapper.rgx.call(r,e,t.regexes.device),r},t.getEngine=function(e){var r={name:void 0,version:void 0};return t.mapper.rgx.call(r,e,t.regexes.os),r},t.getOS=function(e){var r={name:void 0,version:void 0};return t.mapper.rgx.call(r,e,t.regexes.os),r},t.util={extend:function(t,e){var r={};for(var n in t)e[n]&&e[n].length%2==0?r[n]=e[n].concat(t[n]):r[n]=t[n];return r},has:function(t,e){return"string"==typeof t&&-1!==e.toLowerCase().indexOf(t.toLowerCase())},lowerize:function(t){return t.toLowerCase()},major:function(t){return"string"==typeof t?t.replace(/[^\d\.]/g,"").split(".")[0]:void 0},trim:function(t){return t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},t.mapper={rgx:function(t,e){for(var r,n,i,o,s,u,a=0;a<e.length&&!s;){var c=e[a],f=e[a+1];for(r=n=0;r<c.length&&!s;)if(s=c[r++].exec(t))for(i=0;i<f.length;i++)u=s[++n],"object"==typeof(o=f[i])&&o.length>0?2==o.length?"function"==typeof o[1]?this[o[0]]=o[1].call(this,u):this[o[0]]=o[1]:3==o.length?"function"!=typeof o[1]||o[1].exec&&o[1].test?this[o[0]]=u?u.replace(o[1],o[2]):void 0:this[o[0]]=u?o[1].call(this,u,o[2]):void 0:4==o.length&&(this[o[0]]=u?o[3].call(this,u.replace(o[1],o[2])):void 0):this[o]=u||void 0;a+=2}},str:function(e,r){for(var n in r)if("object"==typeof r[n]&&r[n].length>0){for(var i=0;i<r[n].length;i++)if(t.util.has(r[n][i],e))return"?"===n?void 0:n}else if(t.util.has(r[n],e))return"?"===n?void 0:n;return e}},t.maps={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},t.regexes={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[Ir,Or],[/(opios)[\/\s]+([\w\.]+)/i],[[Ir,"Opera Mini"],Or],[/\s(opr)\/([\w\.]+)/i],[[Ir,"Opera"],Or],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(bidubrowser|baidubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[Ir,Or],[/(konqueror)\/([\w\.]+)/i],[[Ir,"Konqueror"],Or],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[Ir,"IE"],Or],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[Ir,"Edge"],Or],[/(yabrowser)\/([\w\.]+)/i],[[Ir,"Yandex"],Or],[/(Avast)\/([\w\.]+)/i],[[Ir,"Avast Secure Browser"],Or],[/(AVG)\/([\w\.]+)/i],[[Ir,"AVG Secure Browser"],Or],[/(puffin)\/([\w\.]+)/i],[[Ir,"Puffin"],Or],[/(focus)\/([\w\.]+)/i],[[Ir,"Firefox Focus"],Or],[/(opt)\/([\w\.]+)/i],[[Ir,"Opera Touch"],Or],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[Ir,"UCBrowser"],Or],[/(comodo_dragon)\/([\w\.]+)/i],[[Ir,/_/g," "],Or],[/(windowswechat qbcore)\/([\w\.]+)/i],[[Ir,"WeChat(Win) Desktop"],Or],[/(micromessenger)\/([\w\.]+)/i],[[Ir,"WeChat"],Or],[/(brave)\/([\w\.]+)/i],[[Ir,"Brave"],Or],[/(whale)\/([\w\.]+)/i],[[Ir,"Whale"],Or],[/(qqbrowserlite)\/([\w\.]+)/i],[Ir,Or],[/(QQ)\/([\d\.]+)/i],[Ir,Or],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[Ir,Or],[/(baiduboxapp)[\/\s]?([\w\.]+)/i],[Ir,Or],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[Ir,Or],[/(MetaSr)[\/\s]?([\w\.]+)/i],[Ir],[/(LBBROWSER)/i],[Ir],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[Or,[Ir,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[Or,[Ir,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[Ir,Or],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[Or,[Ir,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[Ir,/(.+)/,"$1 WebView"],Or],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[Ir,/(.+(?:g|us))(.+)/,"$1 $2"],Or],[/((?:android.+)crmo|crios)\/([\w\.]+)/i,/android.+(chrome)\/([\w\.]+)\s+(?:mobile\s?safari)/i],[[Ir,"Chrome Mobile"],Or],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[Or,[Ir,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[Ir,"Sailfish Browser"],Or],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[Ir,Or],[/(dolfin)\/([\w\.]+)/i],[[Ir,"Dolphin"],Or],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[Ir,"360 Browser"]],[/(coast)\/([\w\.]+)/i],[[Ir,"Opera Coast"],Or],[/fxios\/([\w\.-]+)/i],[Or,[Ir,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[Or,[Ir,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[Or,Ir],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[Ir,"GSA"],Or],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[Ir,[Or,t.mapper.str,t.maps.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[Ir,Or],[/(navigator|netscape)\/([\w\.-]+)/i],[[Ir,"Netscape"],Or],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[Ir,Or]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[br,"amd64"]],[/(ia32(?=;))/i],[[br,t.util.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[br,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[br,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[br,/ower/,"",t.util.lowerize]],[/(sun4\w)[;\)]/i],[[br,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[br,t.util.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[_r,Nr,[Ar,Mr]],[/applecoremedia\/[\w\.]+ \((ipad)/],[_r,[Nr,"Apple"],[Ar,Mr]],[/(apple\s{0,1}tv)/i],[[_r,"Apple TV"],[Nr,"Apple"],[Ar,Cr]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[Nr,_r,[Ar,Mr]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[_r,[Nr,"Amazon"],[Ar,Mr]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[_r,t.mapper.str,t.maps.device.amazon.model],[Nr,"Amazon"],[Ar,Sr]],[/android.+aft([bms])\sbuild/i],[_r,[Nr,"Amazon"],[Ar,Cr]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[_r,Nr,[Ar,Sr]],[/\((ip[honed|\s\w*]+);/i],[_r,[Nr,"Apple"],[Ar,Sr]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[Nr,_r,[Ar,Sr]],[/\(bb10;\s(\w+)/i],[_r,[Nr,"BlackBerry"],[Ar,Sr]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[_r,[Nr,"Asus"],[Ar,Mr]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[Nr,"Sony"],[_r,"Xperia Tablet"],[Ar,Mr]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[_r,[Nr,"Sony"],[Ar,Sr]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[Nr,_r,[Ar,Rr]],[/android.+;\s(shield)\sbuild/i],[_r,[Nr,"Nvidia"],[Ar,Rr]],[/(playstation\s[34portablevi]+)/i],[_r,[Nr,"Sony"],[Ar,Rr]],[/(sprint\s(\w+))/i],[[Nr,t.mapper.str,t.maps.device.sprint.vendor],[_r,t.mapper.str,t.maps.device.sprint.model],[Ar,Sr]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[Nr,[_r,/_/g," "],[Ar,Sr]],[/(nexus\s9)/i],[_r,[Nr,"HTC"],[Ar,Mr]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p|vog-l29|ane-lx1|eml-l29)/i],[_r,[Nr,"Huawei"],[Ar,Sr]],[/android.+(bah2?-a?[lw]\d{2})/i],[_r,[Nr,"Huawei"],[Ar,Mr]],[/(microsoft);\s(lumia[\s\w]+)/i],[Nr,_r,[Ar,Sr]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[_r,[Nr,"Microsoft"],[Ar,Rr]],[/(kin\.[onetw]{3})/i],[[_r,/\./g," "],[Nr,"Microsoft"],[Ar,Sr]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[_r,[Nr,"Motorola"],[Ar,Sr]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[_r,[Nr,"Motorola"],[Ar,Mr]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[Nr,t.util.trim],[_r,t.util.trim],[Ar,Cr]],[/hbbtv.+maple;(\d+)/i],[[_r,/^/,"SmartTV"],[Nr,"Samsung"],[Ar,Cr]],[/\(dtv[\);].+(aquos)/i],[_r,[Nr,"Sharp"],[Ar,Cr]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[Nr,"Samsung"],_r,[Ar,Mr]],[/smart-tv.+(samsung)/i],[Nr,[Ar,Cr],_r],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[Nr,"Samsung"],_r,[Ar,Sr]],[/sie-(\w*)/i],[_r,[Nr,"Siemens"],[Ar,Sr]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[Nr,"Nokia"],_r,[Ar,Sr]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[_r,[Nr,"Acer"],[Ar,Mr]],[/android.+([vl]k\-?\d{3})\s+build/i],[_r,[Nr,"LG"],[Ar,Mr]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[Nr,"LG"],_r,[Ar,Mr]],[/(lg) netcast\.tv/i],[Nr,_r,[Ar,Cr]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[_r,[Nr,"LG"],[Ar,Sr]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[Nr,_r,[Ar,Mr]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[_r,[Nr,"Lenovo"],[Ar,Mr]],[/(lenovo)[_\s-]?([\w-]+)/i],[Nr,_r,[Ar,Sr]],[/linux;.+((jolla));/i],[Nr,_r,[Ar,Sr]],[/((pebble))app\/[\d\.]+\s/i],[Nr,_r,[Ar,xr]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[Nr,_r,[Ar,Sr]],[/crkey/i],[[_r,"Chromecast"],[Nr,"Google"],[Ar,Cr]],[/android.+;\s(glass)\s\d/i],[_r,[Nr,"Google"],[Ar,xr]],[/android.+;\s(pixel c)[\s)]/i],[_r,[Nr,"Google"],[Ar,Mr]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[_r,[Nr,"Google"],[Ar,Sr]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]*[\w\s]+))\s+build/i],[[_r,/_/g," "],[Nr,"Xiaomi"],[Ar,Sr]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]*[\w\s]+))\s+build/i],[[_r,/_/g," "],[Nr,"Xiaomi"],[Ar,Mr]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[_r,[Nr,"Meizu"],[Ar,Sr]],[/(mz)-([\w-]{2,})/i],[[Nr,"Meizu"],_r,[Ar,Sr]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})[\s)]/i],[_r,[Nr,"OnePlus"],[Ar,Sr]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[_r,[Nr,"RCA"],[Ar,Mr]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[_r,[Nr,"Dell"],[Ar,Mr]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[_r,[Nr,"Verizon"],[Ar,Mr]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[Nr,"Barnes & Noble"],_r,[Ar,Mr]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[_r,[Nr,"NuVision"],[Ar,Mr]],[/android.+;\s(k88)\sbuild/i],[_r,[Nr,"ZTE"],[Ar,Mr]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[_r,[Nr,"Swiss"],[Ar,Sr]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[_r,[Nr,"Swiss"],[Ar,Mr]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[_r,[Nr,"Zeki"],[Ar,Mr]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[Nr,"Dragon Touch"],_r,[Ar,Mr]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[_r,[Nr,"Insignia"],[Ar,Mr]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[_r,[Nr,"NextBook"],[Ar,Mr]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[Nr,"Voice"],_r,[Ar,Sr]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[Nr,"LvTel"],_r,[Ar,Sr]],[/android.+;\s(PH-1)\s/i],[_r,[Nr,"Essential"],[Ar,Sr]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[_r,[Nr,"Envizen"],[Ar,Mr]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[Nr,_r,[Ar,Mr]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[_r,[Nr,"MachSpeed"],[Ar,Mr]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[Nr,_r,[Ar,Mr]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[_r,[Nr,"Rotor"],[Ar,Mr]],[/android.+(KS(.+))\s+build/i],[_r,[Nr,"Amazon"],[Ar,Mr]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[Nr,_r,[Ar,Mr]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[Ar,t.util.lowerize],Nr,_r],[/[\s\/\(](smart-?tv)[;\)]/i],[[Ar,Cr]],[/(android[\w\.\s\-]{0,9});.+build/i],[_r,[Nr,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[Or,[Ir,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[Or,[Ir,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[Ir,Or],[/rv\:([\w\.]{1,9}).+(gecko)/i],[Or,Ir]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[Ir,Or],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[[Ir,t.mapper.str,t.maps.os.windows],[Or,t.mapper.str,t.maps.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[Ir,"Windows"],[Or,t.mapper.str,t.maps.os.windows.version]],[/\((bb)(10);/i],[[Ir,"BlackBerry"],Or],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[Ir,Or],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[Ir,"Symbian"],Or],[/\((series40);/i],[Ir],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[Ir,"Firefox OS"],Or],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[[Ir,"Linux"],Or],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[Ir,"Chromium OS"],Or],[/(sunos)\s?([\w\.\d]*)/i],[[Ir,"Solaris"],Or],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[[Ir,"Linux"],Or],[/(iphone)(?:.*os\s*([\w]*)\slike\smac|;\sopera)/i],[[Ir,"iPhone"],[Or,/_/g,"."]],[/(ipad)(?:.*os\s*([\w]*)\slike\smac|;\sopera)/i],[[Ir,"iPad"],[Or,/_/g,"."]],[/(haiku)\s(\w+)/i],[Ir,Or],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[Or,/_/g,"."],[Ir,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[Ir,"Mac"],[Or,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[Ir,Or]]},t}(),Ur=function(){function t(){}return t.generate=function(t){var e,r;if(void 0===t){var n={hostname:"",pathname:"",host:"",search:"",protocol:""};r={navigator:{userAgent:"",vendor:"",languages:[]},document:{location:n,title:""},location:n,screen:{width:"",height:""}}}else r=t;var i=Pr.parse(r.navigator.userAgent),o=i.browser,s=i.os,u=i.device,a=u.type?"mobile"===u.type?"Mobile":"ETC":"Web",c=(r.location.protocol||"").replace(":",""),f=r.screen,p="";try{p=Intl.DateTimeFormat().resolvedOptions().timeZone}catch(t){}return{platform:a||"",browserName:o.name||"",browserMajorVersion:o.major||"",browserVersion:o.version||"",osName:s.name||"",osVersion:s.version||"",deviceModel:u.model||"",deviceType:u.type||"",deviceVendor:u.vendor||"",language:(null===(e=r.navigator.languages)||void 0===e?void 0:e[0])||"",userAgent:r.navigator.userAgent||"",pagePath:r.location.pathname||"",pageTitle:r.document.title||"",host:r.location.host||"",protocol:c,referrer:r.document.referrer||"",queryParameter:r.location.search||"",screenWidth:f.width||"",screenHeight:f.height||"",timeZone:p||""}},t}(),kr=function(){function t(t){void 0===t&&(t={days:0,isCrossSubdomain:!1,isSecure:!1,isCrossSite:!1}),this.options=t}return t.extractDomain=function(t){var e=/[a-z0-9][a-z0-9-]+\.[a-z.]{2,6}$/i,r=t.split("."),n=r[r.length-1];(n.length>4||"com"===n||"org"===n)&&(e=/[a-z0-9][a-z0-9-]*\.[a-z]+$/i);var i=t.match(e);return i?i[0]:""},t.prototype.getItem=function(t){for(var e=t+"=",r=document.cookie.split(";"),n=0;n<r.length;n++){for(var i=r[n];" "==i.charAt(0);)i=i.substring(1,i.length);if(0===i.indexOf(e))return decodeURIComponent(i.substring(e.length,i.length))}return null},t.prototype.getAllItem=function(t){var e=document.cookie.split("; ").map((function(t){return t.split("=")})),r=null==t?void 0:t.keyPrefix;return r?e.filter((function(t){var e=t[0];return t[1],e.startsWith(r)})):e},t.prototype.setItem=function(e,r,n){var i=U(U({},this.options),n),o=i.isSecure,s="",u="",a="";if(i.isCrossSubdomain){var c=t.extractDomain(document.location.hostname);s=c?"; domain=."+c:""}if(i.days){var f=new Date;f.setTime(f.getTime()+24*i.days*60*60*1e3),u="; expires="+f.toUTCString()}i.isCrossSite&&(o=!0,a="; SameSite=None"),o&&(a+="; secure");var p=e+"="+encodeURIComponent(r)+u+"; path=/"+s+a;return document.cookie=p,p},t.prototype.removeItem=function(t,e){this.setItem(t,"",U(U({},e),{days:-1}))},t}(),Dr=new kr({days:3650,isCrossSubdomain:!0}),Lr=function(){function t(t){this.userManager=t,Fr.initialize()}return t.prototype.resolve=function(t){var e=N(),r=(new _t).addIdentifiers(t.identifiers||{}).add(Tt.ID,t.id||e).add(Tt.DEVICE,t.deviceId||e).add(Tt.HACKLE_DEVICE,e);return k.isNotNullOrUndefined(t.userId)&&r.add(Tt.USER,t.userId),{identifiers:r.build(),properties:t.properties||{},hackleProperties:this._getHackleProperties()}},t.prototype.resolveCurrentUser=function(){return this.resolve(this.userManager.currentUser)},t.prototype._getHackleProperties=function(){var t;return"undefined"!=typeof window&&(t=Ur.generate(window)),t||{}},t}(),Fr=function(){function t(){}return t.initialize=function(){Dr.getItem(J)||R()},t.reInitialize=function(){R()},t}(),Vr="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{},jr=function(t){return t&&t.Math==Math&&t},Gr=jr("object"==typeof globalThis&&globalThis)||jr("object"==typeof window&&window)||jr("object"==typeof self&&self)||jr("object"==typeof Vr&&Vr)||function(){return this}()||Function("return this")(),Br={},Hr=function(t){try{return!!t()}catch(t){return!0}},Kr=!Hr((function(){return 7!=Object.defineProperty({},1,{get:function(){return 7}})[1]})),zr=!Hr((function(){var t=function(){}.bind();return"function"!=typeof t||t.hasOwnProperty("prototype")})),Jr=zr,qr=Function.prototype.call,Yr=Jr?qr.bind(qr):function(){return qr.apply(qr,arguments)},Xr={},Wr={}.propertyIsEnumerable,$r=Object.getOwnPropertyDescriptor,Zr=$r&&!Wr.call({1:2},1);Xr.f=Zr?function(t){var e=$r(this,t);return!!e&&e.enumerable}:Wr;var Qr,tn,en=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},rn=zr,nn=Function.prototype,on=nn.bind,sn=nn.call,un=rn&&on.bind(sn,sn),an=rn?function(t){return t&&un(t)}:function(t){return t&&function(){return sn.apply(t,arguments)}},cn=an,fn=cn({}.toString),pn=cn("".slice),ln=function(t){return pn(fn(t),8,-1)},hn=Hr,dn=ln,vn=Object,yn=an("".split),mn=hn((function(){return!vn("z").propertyIsEnumerable(0)}))?function(t){return"String"==dn(t)?yn(t,""):vn(t)}:vn,gn=TypeError,En=function(t){if(null==t)throw gn("Can't call method on "+t);return t},wn=mn,Tn=En,_n=function(t){return wn(Tn(t))},In=function(t){return"function"==typeof t},An=In,Nn=function(t){return"object"==typeof t?null!==t:An(t)},On=Gr,bn=In,Rn=function(t){return bn(t)?t:void 0},Sn=function(t,e){return arguments.length<2?Rn(On[t]):On[t]&&On[t][e]},Mn=an({}.isPrototypeOf),Cn=Sn("navigator","userAgent")||"",xn=Gr,Pn=Cn,Un=xn.process,kn=xn.Deno,Dn=Un&&Un.versions||kn&&kn.version,Ln=Dn&&Dn.v8;Ln&&(tn=(Qr=Ln.split("."))[0]>0&&Qr[0]<4?1:+(Qr[0]+Qr[1])),!tn&&Pn&&(!(Qr=Pn.match(/Edge\/(\d+)/))||Qr[1]>=74)&&(Qr=Pn.match(/Chrome\/(\d+)/))&&(tn=+Qr[1]);var Fn=tn,Vn=Fn,jn=Hr,Gn=!!Object.getOwnPropertySymbols&&!jn((function(){var t=Symbol();return!String(t)||!(Object(t)instanceof Symbol)||!Symbol.sham&&Vn&&Vn<41})),Bn=Gn&&!Symbol.sham&&"symbol"==typeof Symbol.iterator,Hn=Sn,Kn=In,zn=Mn,Jn=Object,qn=Bn?function(t){return"symbol"==typeof t}:function(t){var e=Hn("Symbol");return Kn(e)&&zn(e.prototype,Jn(t))},Yn=String,Xn=function(t){try{return Yn(t)}catch(t){return"Object"}},Wn=In,$n=Xn,Zn=TypeError,Qn=function(t){if(Wn(t))return t;throw Zn($n(t)+" is not a function")},ti=Qn,ei=function(t,e){var r=t[e];return null==r?void 0:ti(r)},ri=Yr,ni=In,ii=Nn,oi=TypeError,si={exports:{}},ui=Gr,ai=Object.defineProperty,ci=function(t,e){try{ai(ui,t,{value:e,configurable:!0,writable:!0})}catch(r){ui[t]=e}return e},fi=ci,pi="__core-js_shared__",li=Gr[pi]||fi(pi,{}),hi=li;(si.exports=function(t,e){return hi[t]||(hi[t]=void 0!==e?e:{})})("versions",[]).push({version:"3.24.1",mode:"global",copyright:"\xa9 2014-2022 Denis Pushkarev (zloirock.ru)",license:"https://github.com/zloirock/core-js/blob/v3.24.1/LICENSE",source:"https://github.com/zloirock/core-js"});var di=En,vi=Object,yi=function(t){return vi(di(t))},mi=yi,gi=an({}.hasOwnProperty),Ei=Object.hasOwn||function(t,e){return gi(mi(t),e)},wi=an,Ti=0,_i=Math.random(),Ii=wi(1..toString),Ai=function(t){return"Symbol("+(void 0===t?"":t)+")_"+Ii(++Ti+_i,36)},Ni=Gr,Oi=si.exports,bi=Ei,Ri=Ai,Si=Gn,Mi=Bn,Ci=Oi("wks"),xi=Ni.Symbol,Pi=xi&&xi.for,Ui=Mi?xi:xi&&xi.withoutSetter||Ri,ki=function(t){if(!bi(Ci,t)||!Si&&"string"!=typeof Ci[t]){var e="Symbol."+t;Si&&bi(xi,t)?Ci[t]=xi[t]:Ci[t]=Mi&&Pi?Pi(e):Ui(e)}return Ci[t]},Di=Yr,Li=Nn,Fi=qn,Vi=ei,ji=function(t,e){var r,n;if("string"===e&&ni(r=t.toString)&&!ii(n=ri(r,t)))return n;if(ni(r=t.valueOf)&&!ii(n=ri(r,t)))return n;if("string"!==e&&ni(r=t.toString)&&!ii(n=ri(r,t)))return n;throw oi("Can't convert object to primitive value")},Gi=TypeError,Bi=ki("toPrimitive"),Hi=function(t,e){if(!Li(t)||Fi(t))return t;var r,n=Vi(t,Bi);if(n){if(void 0===e&&(e="default"),r=Di(n,t,e),!Li(r)||Fi(r))return r;throw Gi("Can't convert object to primitive value")}return void 0===e&&(e="number"),ji(t,e)},Ki=qn,zi=function(t){var e=Hi(t,"string");return Ki(e)?e:e+""},Ji=Nn,qi=Gr.document,Yi=Ji(qi)&&Ji(qi.createElement),Xi=function(t){return Yi?qi.createElement(t):{}},Wi=Xi,$i=!Kr&&!Hr((function(){return 7!=Object.defineProperty(Wi("div"),"a",{get:function(){return 7}}).a})),Zi=Kr,Qi=Yr,to=Xr,eo=en,ro=_n,no=zi,io=Ei,oo=$i,so=Object.getOwnPropertyDescriptor;Br.f=Zi?so:function(t,e){if(t=ro(t),e=no(e),oo)try{return so(t,e)}catch(t){}if(io(t,e))return eo(!Qi(to.f,t,e),t[e])};var uo={},ao=Kr&&Hr((function(){return 42!=Object.defineProperty((function(){}),"prototype",{value:42,writable:!1}).prototype})),co=Nn,fo=String,po=TypeError,lo=function(t){if(co(t))return t;throw po(fo(t)+" is not an object")},ho=Kr,vo=$i,yo=ao,mo=lo,go=zi,Eo=TypeError,wo=Object.defineProperty,To=Object.getOwnPropertyDescriptor,_o="enumerable",Io="configurable",Ao="writable";uo.f=ho?yo?function(t,e,r){if(mo(t),e=go(e),mo(r),"function"==typeof t&&"prototype"===e&&"value"in r&&Ao in r&&!r.writable){var n=To(t,e);n&&n.writable&&(t[e]=r.value,r={configurable:Io in r?r.configurable:n.configurable,enumerable:_o in r?r.enumerable:n.enumerable,writable:!1})}return wo(t,e,r)}:wo:function(t,e,r){if(mo(t),e=go(e),mo(r),vo)try{return wo(t,e,r)}catch(t){}if("get"in r||"set"in r)throw Eo("Accessors not supported");return"value"in r&&(t[e]=r.value),t};var No=uo,Oo=en,bo=Kr?function(t,e,r){return No.f(t,e,Oo(1,r))}:function(t,e,r){return t[e]=r,t},Ro={exports:{}},So=Kr,Mo=Ei,Co=Function.prototype,xo=So&&Object.getOwnPropertyDescriptor,Po=Mo(Co,"name"),Uo={EXISTS:Po,PROPER:Po&&"something"===function(){}.name,CONFIGURABLE:Po&&(!So||So&&xo(Co,"name").configurable)},ko=In,Do=li,Lo=an(Function.toString);ko(Do.inspectSource)||(Do.inspectSource=function(t){return Lo(t)});var Fo,Vo,jo,Go=Do.inspectSource,Bo=In,Ho=Go,Ko=Gr.WeakMap,zo=Bo(Ko)&&/native code/.test(Ho(Ko)),Jo=si.exports,qo=Ai,Yo=Jo("keys"),Xo=function(t){return Yo[t]||(Yo[t]=qo(t))},Wo={},$o=zo,Zo=Gr,Qo=an,ts=Nn,es=bo,rs=Ei,ns=li,is=Xo,os=Wo,ss="Object already initialized",us=Zo.TypeError,as=Zo.WeakMap;if($o||ns.state){
var cs=ns.state||(ns.state=new as),fs=Qo(cs.get),ps=Qo(cs.has),ls=Qo(cs.set);Fo=function(t,e){if(ps(cs,t))throw new us(ss);return e.facade=t,ls(cs,t,e),e},Vo=function(t){return fs(cs,t)||{}},jo=function(t){return ps(cs,t)}}else{var hs=is("state");os[hs]=!0,Fo=function(t,e){if(rs(t,hs))throw new us(ss);return e.facade=t,es(t,hs,e),e},Vo=function(t){return rs(t,hs)?t[hs]:{}},jo=function(t){return rs(t,hs)}}var ds={set:Fo,get:Vo,has:jo,enforce:function(t){return jo(t)?Vo(t):Fo(t,{})},getterFor:function(t){return function(e){var r;if(!ts(e)||(r=Vo(e)).type!==t)throw us("Incompatible receiver, "+t+" required");return r}}},vs=Hr,ys=In,ms=Ei,gs=Kr,Es=Uo.CONFIGURABLE,ws=Go,Ts=ds.enforce,_s=ds.get,Is=Object.defineProperty,As=gs&&!vs((function(){return 8!==Is((function(){}),"length",{value:8}).length})),Ns=String(String).split("String"),Os=Ro.exports=function(t,e,r){"Symbol("===String(e).slice(0,7)&&(e="["+String(e).replace(/^Symbol\(([^)]*)\)/,"$1")+"]"),r&&r.getter&&(e="get "+e),r&&r.setter&&(e="set "+e),(!ms(t,"name")||Es&&t.name!==e)&&(gs?Is(t,"name",{value:e,configurable:!0}):t.name=e),As&&r&&ms(r,"arity")&&t.length!==r.arity&&Is(t,"length",{value:r.arity});try{r&&ms(r,"constructor")&&r.constructor?gs&&Is(t,"prototype",{writable:!1}):t.prototype&&(t.prototype=void 0)}catch(t){}var n=Ts(t);return ms(n,"source")||(n.source=Ns.join("string"==typeof e?e:"")),t};Function.prototype.toString=Os((function(){return ys(this)&&_s(this).source||ws(this)}),"toString");var bs=In,Rs=uo,Ss=Ro.exports,Ms=ci,Cs=function(t,e,r,n){n||(n={});var i=n.enumerable,o=void 0!==n.name?n.name:e;if(bs(r)&&Ss(r,o,n),n.global)i?t[e]=r:Ms(e,r);else{try{n.unsafe?t[e]&&(i=!0):delete t[e]}catch(t){}i?t[e]=r:Rs.f(t,e,{value:r,enumerable:!1,configurable:!n.nonConfigurable,writable:!n.nonWritable})}return t},xs={},Ps=Math.ceil,Us=Math.floor,ks=Math.trunc||function(t){var e=+t;return(e>0?Us:Ps)(e)},Ds=function(t){var e=+t;return e!=e||0===e?0:ks(e)},Ls=Ds,Fs=Math.max,Vs=Math.min,js=function(t,e){var r=Ls(t);return r<0?Fs(r+e,0):Vs(r,e)},Gs=Ds,Bs=Math.min,Hs=function(t){return t>0?Bs(Gs(t),9007199254740991):0},Ks=function(t){return Hs(t.length)},zs=_n,Js=js,qs=Ks,Ys=function(t){return function(e,r,n){var i,o=zs(e),s=qs(o),u=Js(n,s);if(t&&r!=r){for(;s>u;)if((i=o[u++])!=i)return!0}else for(;s>u;u++)if((t||u in o)&&o[u]===r)return t||u||0;return!t&&-1}},Xs={includes:Ys(!0),indexOf:Ys(!1)},Ws=Ei,$s=_n,Zs=Xs.indexOf,Qs=Wo,tu=an([].push),eu=function(t,e){var r,n=$s(t),i=0,o=[];for(r in n)!Ws(Qs,r)&&Ws(n,r)&&tu(o,r);for(;e.length>i;)Ws(n,r=e[i++])&&(~Zs(o,r)||tu(o,r));return o},ru=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toLocaleString","toString","valueOf"],nu=eu,iu=ru.concat("length","prototype");xs.f=Object.getOwnPropertyNames||function(t){return nu(t,iu)};var ou={};ou.f=Object.getOwnPropertySymbols;var su=Sn,uu=xs,au=ou,cu=lo,fu=an([].concat),pu=su("Reflect","ownKeys")||function(t){var e=uu.f(cu(t)),r=au.f;return r?fu(e,r(t)):e},lu=Ei,hu=pu,du=Br,vu=uo,yu=function(t,e,r){for(var n=hu(e),i=vu.f,o=du.f,s=0;s<n.length;s++){var u=n[s];lu(t,u)||r&&lu(r,u)||i(t,u,o(e,u))}},mu=Hr,gu=In,Eu=/#|\.prototype\./,wu=function(t,e){var r=_u[Tu(t)];return r==Au||r!=Iu&&(gu(e)?mu(e):!!e)},Tu=wu.normalize=function(t){return String(t).replace(Eu,".").toLowerCase()},_u=wu.data={},Iu=wu.NATIVE="N",Au=wu.POLYFILL="P",Nu=wu,Ou=Gr,bu=Br.f,Ru=bo,Su=Cs,Mu=ci,Cu=yu,xu=Nu,Pu=function(t,e){var r,n,i,o,s,u=t.target,a=t.global,c=t.stat;if(r=a?Ou:c?Ou[u]||Mu(u,{}):(Ou[u]||{}).prototype)for(n in e){if(o=e[n],i=t.dontCallGetSet?(s=bu(r,n))&&s.value:r[n],!xu(a?n:u+(c?".":"#")+n,t.forced)&&void 0!==i){if(typeof o==typeof i)continue;Cu(o,i)}(t.sham||i&&i.sham)&&Ru(o,"sham",!0),Su(r,n,o,t)}},Uu=!Hr((function(){function t(){}return t.prototype.constructor=null,Object.getPrototypeOf(new t)!==t.prototype})),ku=Ei,Du=In,Lu=yi,Fu=Uu,Vu=Xo("IE_PROTO"),ju=Object,Gu=ju.prototype,Bu=Fu?ju.getPrototypeOf:function(t){var e=Lu(t);if(ku(e,Vu))return e[Vu];var r=e.constructor;return Du(r)&&e instanceof r?r.prototype:e instanceof ju?Gu:null},Hu=In,Ku=String,zu=TypeError,Ju=an,qu=lo,Yu=function(t){if("object"==typeof t||Hu(t))return t;throw zu("Can't set "+Ku(t)+" as a prototype")},Xu=Object.setPrototypeOf||("__proto__"in{}?function(){var t,e=!1,r={};try{(t=Ju(Object.getOwnPropertyDescriptor(Object.prototype,"__proto__").set))(r,[]),e=r instanceof Array}catch(t){}return function(r,n){return qu(r),Yu(n),e?t(r,n):r.__proto__=n,r}}():void 0),Wu={},$u=eu,Zu=ru,Qu=Object.keys||function(t){return $u(t,Zu)},ta=Kr,ea=ao,ra=uo,na=lo,ia=_n,oa=Qu;Wu.f=ta&&!ea?Object.defineProperties:function(t,e){na(t);for(var r,n=ia(e),i=oa(e),o=i.length,s=0;o>s;)ra.f(t,r=i[s++],n[r]);return t};var sa,ua=Sn("document","documentElement"),aa=lo,ca=Wu,fa=ru,pa=Wo,la=ua,ha=Xi,da=Xo("IE_PROTO"),va=function(){},ya=function(t){return"<script>"+t+"</script>"},ma=function(t){t.write(ya("")),t.close();var e=t.parentWindow.Object;return t=null,e},ga=function(){try{sa=new ActiveXObject("htmlfile")}catch(t){}var t,e;ga="undefined"!=typeof document?document.domain&&sa?ma(sa):((e=ha("iframe")).style.display="none",la.appendChild(e),e.src=String("javascript:"),(t=e.contentWindow.document).open(),t.write(ya("document.F=Object")),t.close(),t.F):ma(sa);for(var r=fa.length;r--;)delete ga.prototype[fa[r]];return ga()};pa[da]=!0;var Ea=Object.create||function(t,e){var r;return null!==t?(va.prototype=aa(t),r=new va,va.prototype=null,r[da]=t):r=ga(),void 0===e?r:ca.f(r,e)},wa=Error,Ta=an("".replace),_a=String(wa("zxcasd").stack),Ia=/\n\s*at [^:]*:[^\n]*/,Aa=Ia.test(_a),Na=Nn,Oa=bo,ba=Qn,Ra=zr,Sa=an(an.bind),Ma=function(t,e){return ba(t),void 0===e?t:Ra?Sa(t,e):function(){return t.apply(e,arguments)}},Ca={},xa=Ca,Pa=ki("iterator"),Ua=Array.prototype,ka=function(t){return void 0!==t&&(xa.Array===t||Ua[Pa]===t)},Da={};Da[ki("toStringTag")]="z";var La="[object z]"===String(Da),Fa=La,Va=In,ja=ln,Ga=ki("toStringTag"),Ba=Object,Ha="Arguments"==ja(function(){return arguments}()),Ka=Fa?ja:function(t){var e,r,n;return void 0===t?"Undefined":null===t?"Null":"string"==typeof(r=function(t,e){try{return t[e]}catch(t){}}(e=Ba(t),Ga))?r:Ha?ja(e):"Object"==(n=ja(e))&&Va(e.callee)?"Arguments":n},za=Ka,Ja=ei,qa=Ca,Ya=ki("iterator"),Xa=function(t){if(null!=t)return Ja(t,Ya)||Ja(t,"@@iterator")||qa[za(t)]},Wa=Yr,$a=Qn,Za=lo,Qa=Xn,tc=Xa,ec=TypeError,rc=function(t,e){var r=arguments.length<2?tc(t):e;if($a(r))return Za(Wa(r,t));throw ec(Qa(t)+" is not iterable")},nc=Yr,ic=lo,oc=ei,sc=function(t,e,r){var n,i;ic(t);try{if(!(n=oc(t,"return"))){if("throw"===e)throw r;return r}n=nc(n,t)}catch(t){i=!0,n=t}if("throw"===e)throw r;if(i)throw n;return ic(n),r},uc=Ma,ac=Yr,cc=lo,fc=Xn,pc=ka,lc=Ks,hc=Mn,dc=rc,vc=Xa,yc=sc,mc=TypeError,gc=function(t,e){this.stopped=t,this.result=e},Ec=gc.prototype,wc=function(t,e,r){var n,i,o,s,u,a,c,f=r&&r.that,p=!(!r||!r.AS_ENTRIES),l=!(!r||!r.IS_RECORD),h=!(!r||!r.IS_ITERATOR),d=!(!r||!r.INTERRUPTED),v=uc(e,f),y=function(t){return n&&yc(n,"normal",t),new gc(!0,t)},m=function(t){return p?(cc(t),d?v(t[0],t[1],y):v(t[0],t[1])):d?v(t,y):v(t)};if(l)n=t.iterator;else if(h)n=t;else{if(!(i=vc(t)))throw mc(fc(t)+" is not iterable");if(pc(i)){for(o=0,s=lc(t);s>o;o++)if((u=m(t[o]))&&hc(Ec,u))return u;return new gc(!1)}n=dc(t,i)}for(a=l?t.next:n.next;!(c=ac(a,n)).done;){try{u=m(c.value)}catch(t){yc(n,"throw",t)}if("object"==typeof u&&u&&hc(Ec,u))return u}return new gc(!1)},Tc=Ka,_c=String,Ic=function(t){if("Symbol"===Tc(t))throw TypeError("Cannot convert a Symbol value to a string");return _c(t)},Ac=Ic,Nc=en,Oc=!Hr((function(){var t=Error("a");return!("stack"in t)||(Object.defineProperty(t,"stack",Nc(1,7)),7!==t.stack)})),bc=Pu,Rc=Mn,Sc=Bu,Mc=Xu,Cc=yu,xc=Ea,Pc=bo,Uc=en,kc=function(t,e){if(Aa&&"string"==typeof t&&!wa.prepareStackTrace)for(;e--;)t=Ta(t,Ia,"");return t},Dc=function(t,e){Na(e)&&"cause"in e&&Oa(t,"cause",e.cause)},Lc=wc,Fc=function(t,e){return void 0===t?arguments.length<2?"":e:Ac(t)},Vc=Oc,jc=ki("toStringTag"),Gc=Error,Bc=[].push,Hc=function(t,e){var r,n=arguments.length>2?arguments[2]:void 0,i=Rc(Kc,this);Mc?r=Mc(new Gc,i?Sc(this):Kc):(r=i?this:xc(Kc),Pc(r,jc,"Error")),void 0!==e&&Pc(r,"message",Fc(e)),Vc&&Pc(r,"stack",kc(r.stack,1)),Dc(r,n);var o=[];return Lc(t,Bc,{that:o}),Pc(r,"errors",o),r};Mc?Mc(Hc,Gc):Cc(Hc,Gc,{name:!0});var Kc=Hc.prototype=xc(Gc.prototype,{constructor:Uc(1,Hc),message:Uc(1,""),name:Uc(1,"AggregateError")});bc({global:!0,constructor:!0,arity:2},{AggregateError:Hc});var zc=ki,Jc=Ea,qc=uo.f,Yc=zc("unscopables"),Xc=Array.prototype;null==Xc[Yc]&&qc(Xc,Yc,{configurable:!0,value:Jc(null)});var Wc,$c,Zc,Qc=function(t){Xc[Yc][t]=!0},tf=Hr,ef=In,rf=Bu,nf=Cs,of=ki("iterator"),sf=!1;[].keys&&("next"in(Zc=[].keys())?($c=rf(rf(Zc)))!==Object.prototype&&(Wc=$c):sf=!0);var uf=null==Wc||tf((function(){var t={};return Wc[of].call(t)!==t}));uf&&(Wc={}),ef(Wc[of])||nf(Wc,of,(function(){return this}));var af={IteratorPrototype:Wc,BUGGY_SAFARI_ITERATORS:sf},cf=uo.f,ff=Ei,pf=ki("toStringTag"),lf=function(t,e,r){t&&!r&&(t=t.prototype),t&&!ff(t,pf)&&cf(t,pf,{configurable:!0,value:e})},hf=af.IteratorPrototype,df=Ea,vf=en,yf=lf,mf=Ca,gf=function(){return this},Ef=Pu,wf=Yr,Tf=In,_f=function(t,e,r,n){var i=e+" Iterator";return t.prototype=df(hf,{next:vf(+!n,r)}),yf(t,i,!1),mf[i]=gf,t},If=Bu,Af=Xu,Nf=lf,Of=bo,bf=Cs,Rf=Ca,Sf=Uo.PROPER,Mf=Uo.CONFIGURABLE,Cf=af.IteratorPrototype,xf=af.BUGGY_SAFARI_ITERATORS,Pf=ki("iterator"),Uf="keys",kf="values",Df="entries",Lf=function(){return this},Ff=function(t,e,r,n,i,o,s){_f(r,e,n);var u,a,c,f=function(t){if(t===i&&v)return v;if(!xf&&t in h)return h[t];switch(t){case Uf:case kf:case Df:return function(){return new r(this,t)}}return function(){return new r(this)}},p=e+" Iterator",l=!1,h=t.prototype,d=h[Pf]||h["@@iterator"]||i&&h[i],v=!xf&&d||f(i),y="Array"==e&&h.entries||d;if(y&&(u=If(y.call(new t)))!==Object.prototype&&u.next&&(If(u)!==Cf&&(Af?Af(u,Cf):Tf(u[Pf])||bf(u,Pf,Lf)),Nf(u,p,!0)),Sf&&i==kf&&d&&d.name!==kf&&(Mf?Of(h,"name",kf):(l=!0,v=function(){return wf(d,this)})),i)if(a={values:f(kf),keys:o?v:f(Uf),entries:f(Df)},s)for(c in a)(xf||l||!(c in h))&&bf(h,c,a[c]);else Ef({target:e,proto:!0,forced:xf||l},a);return h[Pf]!==v&&bf(h,Pf,v,{name:i}),Rf[e]=v,a},Vf=_n,jf=Qc,Gf=Ca,Bf=ds,Hf=uo.f,Kf=Ff,zf=Kr,Jf="Array Iterator",qf=Bf.set,Yf=Bf.getterFor(Jf),Xf=Kf(Array,"Array",(function(t,e){qf(this,{type:Jf,target:Vf(t),index:0,kind:e})}),(function(){var t=Yf(this),e=t.target,r=t.kind,n=t.index++;return!e||n>=e.length?(t.target=void 0,{value:void 0,done:!0}):"keys"==r?{value:n,done:!1}:"values"==r?{value:e[n],done:!1}:{value:[n,e[n]],done:!1}}),"values"),Wf=Gf.Arguments=Gf.Array;if(jf("keys"),jf("values"),jf("entries"),zf&&"values"!==Wf.name)try{Hf(Wf,"name",{value:"values"})}catch(t){}var $f=Ka,Zf=La?{}.toString:function(){return"[object "+$f(this)+"]"};La||Cs(Object.prototype,"toString",Zf,{unsafe:!0});var Qf="process"==ln(Gr.process),tp=Sn,ep=uo,rp=Kr,np=ki("species"),ip=function(t){var e=tp(t),r=ep.f;rp&&e&&!e[np]&&r(e,np,{configurable:!0,get:function(){return this}})},op=Mn,sp=TypeError,up=function(t,e){if(op(e,t))return t;throw sp("Incorrect invocation")},ap=an,cp=Hr,fp=In,pp=Ka,lp=Go,hp=function(){},dp=[],vp=Sn("Reflect","construct"),yp=/^\s*(?:class|function)\b/,mp=ap(yp.exec),gp=!yp.exec(hp),Ep=function(t){if(!fp(t))return!1;try{return vp(hp,dp,t),!0}catch(t){return!1}},wp=function(t){if(!fp(t))return!1;switch(pp(t)){case"AsyncFunction":case"GeneratorFunction":case"AsyncGeneratorFunction":return!1}try{return gp||!!mp(yp,lp(t))}catch(t){return!0}};wp.sham=!0;var Tp,_p,Ip,Ap,Np=!vp||cp((function(){var t;return Ep(Ep.call)||!Ep(Object)||!Ep((function(){t=!0}))||t}))?wp:Ep,Op=Np,bp=Xn,Rp=TypeError,Sp=lo,Mp=function(t){if(Op(t))return t;throw Rp(bp(t)+" is not a constructor")},Cp=ki("species"),xp=function(t,e){var r,n=Sp(t).constructor;return void 0===n||null==(r=Sp(n)[Cp])?e:Mp(r)},Pp=zr,Up=Function.prototype,kp=Up.apply,Dp=Up.call,Lp="object"==typeof Reflect&&Reflect.apply||(Pp?Dp.bind(kp):function(){return Dp.apply(kp,arguments)}),Fp=an([].slice),Vp=TypeError,jp=/(?:ipad|iphone|ipod).*applewebkit/i.test(Cn),Gp=Gr,Bp=Lp,Hp=Ma,Kp=In,zp=Ei,Jp=Hr,qp=ua,Yp=Fp,Xp=Xi,Wp=function(t,e){if(t<e)throw Vp("Not enough arguments");return t},$p=jp,Zp=Qf,Qp=Gp.setImmediate,tl=Gp.clearImmediate,el=Gp.process,rl=Gp.Dispatch,nl=Gp.Function,il=Gp.MessageChannel,ol=Gp.String,sl=0,ul={},al="onreadystatechange";try{Tp=Gp.location}catch(t){}var cl=function(t){if(zp(ul,t)){var e=ul[t];delete ul[t],e()}},fl=function(t){return function(){cl(t)}},pl=function(t){cl(t.data)},ll=function(t){Gp.postMessage(ol(t),Tp.protocol+"//"+Tp.host)};Qp&&tl||(Qp=function(t){Wp(arguments.length,1);var e=Kp(t)?t:nl(t),r=Yp(arguments,1);return ul[++sl]=function(){Bp(e,void 0,r)},_p(sl),sl},tl=function(t){delete ul[t]},Zp?_p=function(t){el.nextTick(fl(t))}:rl&&rl.now?_p=function(t){rl.now(fl(t))}:il&&!$p?(Ap=(Ip=new il).port2,Ip.port1.onmessage=pl,_p=Hp(Ap.postMessage,Ap)):Gp.addEventListener&&Kp(Gp.postMessage)&&!Gp.importScripts&&Tp&&"file:"!==Tp.protocol&&!Jp(ll)?(_p=ll,Gp.addEventListener("message",pl,!1)):_p=al in Xp("script")?function(t){qp.appendChild(Xp("script")).onreadystatechange=function(){qp.removeChild(this),cl(t)}}:function(t){setTimeout(fl(t),0)});var hl,dl,vl,yl,ml,gl,El,wl,Tl={set:Qp,clear:tl},_l=Gr,Il=/ipad|iphone|ipod/i.test(Cn)&&void 0!==_l.Pebble,Al=/web0s(?!.*chrome)/i.test(Cn),Nl=Gr,Ol=Ma,bl=Br.f,Rl=Tl.set,Sl=jp,Ml=Il,Cl=Al,xl=Qf,Pl=Nl.MutationObserver||Nl.WebKitMutationObserver,Ul=Nl.document,kl=Nl.process,Dl=Nl.Promise,Ll=bl(Nl,"queueMicrotask"),Fl=Ll&&Ll.value;Fl||(hl=function(){var t,e;for(xl&&(t=kl.domain)&&t.exit();dl;){e=dl.fn,dl=dl.next;try{e()}catch(t){throw dl?yl():vl=void 0,t}}vl=void 0,t&&t.enter()},Sl||xl||Cl||!Pl||!Ul?!Ml&&Dl&&Dl.resolve?((El=Dl.resolve(void 0)).constructor=Dl,wl=Ol(El.then,El),yl=function(){wl(hl)}):xl?yl=function(){kl.nextTick(hl)}:(Rl=Ol(Rl,Nl),yl=function(){Rl(hl)}):(ml=!0,gl=Ul.createTextNode(""),new Pl(hl).observe(gl,{characterData:!0}),yl=function(){gl.data=ml=!ml}));var Vl=Fl||function(t){var e={fn:t,next:void 0};vl&&(vl.next=e),dl||(dl=e,yl()),vl=e},jl=Gr,Gl=function(t){try{return{error:!1,value:t()}}catch(t){return{error:!0,value:t}}},Bl=function(){this.head=null,this.tail=null};Bl.prototype={add:function(t){var e={item:t,next:null};this.head?this.tail.next=e:this.head=e,this.tail=e},get:function(){var t=this.head;if(t)return this.head=t.next,this.tail===t&&(this.tail=null),t.item}};var Hl=Bl,Kl=Gr.Promise,zl="object"==typeof Deno&&Deno&&"object"==typeof Deno.version,Jl=!zl&&!Qf&&"object"==typeof window&&"object"==typeof document,ql=Gr,Yl=Kl,Xl=In,Wl=Nu,$l=Go,Zl=ki,Ql=Jl,th=zl,eh=Fn;Yl&&Yl.prototype;var rh=Zl("species"),nh=!1,ih=Xl(ql.PromiseRejectionEvent),oh=Wl("Promise",(function(){var t=$l(Yl),e=t!==String(Yl);if(!e&&66===eh)return!0;if(!eh||eh<51||!/native code/.test(t)){var r=new Yl((function(t){t(1)})),n=function(t){t((function(){}),(function(){}))};if((r.constructor={})[rh]=n,!(nh=r.then((function(){}))instanceof n))return!0}return!e&&(Ql||th)&&!ih})),sh={CONSTRUCTOR:oh,REJECTION_EVENT:ih,SUBCLASSING:nh},uh={},ah=Qn,ch=function(t){var e,r;this.promise=new t((function(t,n){if(void 0!==e||void 0!==r)throw TypeError("Bad Promise constructor");e=t,r=n})),this.resolve=ah(e),this.reject=ah(r)};uh.f=function(t){return new ch(t)};var fh,ph,lh,hh=Pu,dh=Qf,vh=Gr,yh=Yr,mh=Cs,gh=Xu,Eh=lf,wh=ip,Th=Qn,_h=In,Ih=Nn,Ah=up,Nh=xp,Oh=Tl.set,bh=Vl,Rh=function(t,e){var r=jl.console;r&&r.error&&(1==arguments.length?r.error(t):r.error(t,e))},Sh=Gl,Mh=Hl,Ch=ds,xh=Kl,Ph=uh,Uh="Promise",kh=sh.CONSTRUCTOR,Dh=sh.REJECTION_EVENT,Lh=sh.SUBCLASSING,Fh=Ch.getterFor(Uh),Vh=Ch.set,jh=xh&&xh.prototype,Gh=xh,Bh=jh,Hh=vh.TypeError,Kh=vh.document,zh=vh.process,Jh=Ph.f,qh=Jh,Yh=!!(Kh&&Kh.createEvent&&vh.dispatchEvent),Xh="unhandledrejection",Wh=function(t){var e;return!(!Ih(t)||!_h(e=t.then))&&e},$h=function(t,e){var r,n,i,o=e.value,s=1==e.state,u=s?t.ok:t.fail,a=t.resolve,c=t.reject,f=t.domain;try{u?(s||(2===e.rejection&&rd(e),e.rejection=1),!0===u?r=o:(f&&f.enter(),r=u(o),f&&(f.exit(),i=!0)),r===t.promise?c(Hh("Promise-chain cycle")):(n=Wh(r))?yh(n,r,a,c):a(r)):c(o)}catch(t){f&&!i&&f.exit(),c(t)}},Zh=function(t,e){t.notified||(t.notified=!0,bh((function(){for(var r,n=t.reactions;r=n.get();)$h(r,t);t.notified=!1,e&&!t.rejection&&td(t)})))},Qh=function(t,e,r){var n,i;Yh?((n=Kh.createEvent("Event")).promise=e,n.reason=r,n.initEvent(t,!1,!0),vh.dispatchEvent(n)):n={promise:e,reason:r},!Dh&&(i=vh["on"+t])?i(n):t===Xh&&Rh("Unhandled promise rejection",r)},td=function(t){yh(Oh,vh,(function(){var e,r=t.facade,n=t.value;if(ed(t)&&(e=Sh((function(){dh?zh.emit("unhandledRejection",n,r):Qh(Xh,r,n)})),t.rejection=dh||ed(t)?2:1,e.error))throw e.value}))},ed=function(t){return 1!==t.rejection&&!t.parent},rd=function(t){yh(Oh,vh,(function(){var e=t.facade;dh?zh.emit("rejectionHandled",e):Qh("rejectionhandled",e,t.value)}))},nd=function(t,e,r){return function(n){t(e,n,r)}},id=function(t,e,r){t.done||(t.done=!0,r&&(t=r),t.value=e,t.state=2,Zh(t,!0))},od=function(t,e,r){if(!t.done){t.done=!0,r&&(t=r);try{if(t.facade===e)throw Hh("Promise can't be resolved itself");var n=Wh(e);n?bh((function(){var r={done:!1};try{yh(n,e,nd(od,r,t),nd(id,r,t))}catch(e){id(r,e,t)}})):(t.value=e,t.state=1,Zh(t,!1))}catch(e){id({done:!1},e,t)}}};if(kh&&(Bh=(Gh=function(t){Ah(this,Bh),Th(t),yh(fh,this);var e=Fh(this);try{t(nd(od,e),nd(id,e))}catch(t){id(e,t)}}).prototype,(fh=function(){Vh(this,{type:Uh,done:!1,notified:!1,parent:!1,reactions:new Mh,rejection:!1,state:0,value:void 0})}).prototype=mh(Bh,"then",(function(t,e){var r=Fh(this),n=Jh(Nh(this,Gh));return r.parent=!0,n.ok=!_h(t)||t,n.fail=_h(e)&&e,n.domain=dh?zh.domain:void 0,0==r.state?r.reactions.add(n):bh((function(){$h(n,r)})),n.promise})),ph=function(){var t=new fh,e=Fh(t);this.promise=t,this.resolve=nd(od,e),this.reject=nd(id,e)},Ph.f=Jh=function(t){return t===Gh||void 0===t?new ph(t):qh(t)},_h(xh)&&jh!==Object.prototype)){lh=jh.then,Lh||mh(jh,"then",(function(t,e){var r=this;return new Gh((function(t,e){yh(lh,r,t,e)})).then(t,e)}),{unsafe:!0});try{delete jh.constructor}catch(t){}gh&&gh(jh,Bh)}hh({global:!0,constructor:!0,wrap:!0,forced:kh},{Promise:Gh}),Eh(Gh,Uh,!1),wh(Uh);var sd=ki("iterator"),ud=!1;try{var ad=0,cd={next:function(){return{done:!!ad++}},return:function(){ud=!0}};cd[sd]=function(){return this},Array.from(cd,(function(){throw 2}))}catch(t){}var fd=function(t,e){if(!e&&!ud)return!1;var r=!1;try{var n={};n[sd]=function(){return{next:function(){return{done:r=!0}}}},t(n)}catch(t){}return r},pd=Kl,ld=sh.CONSTRUCTOR||!fd((function(t){pd.all(t).then(void 0,(function(){}))})),hd=Yr,dd=Qn,vd=uh,yd=Gl,md=wc;Pu({target:"Promise",stat:!0,forced:ld},{all:function(t){var e=this,r=vd.f(e),n=r.resolve,i=r.reject,o=yd((function(){var r=dd(e.resolve),o=[],s=0,u=1;md(t,(function(t){var a=s++,c=!1;u++,hd(r,e,t).then((function(t){c||(c=!0,o[a]=t,--u||n(o))}),i)})),--u||n(o)}));return o.error&&i(o.value),r.promise}});var gd=Pu,Ed=sh.CONSTRUCTOR,wd=Kl,Td=Sn,_d=In,Id=Cs,Ad=wd&&wd.prototype;if(gd({target:"Promise",proto:!0,forced:Ed,real:!0},{catch:function(t){return this.then(void 0,t)}}),_d(wd)){var Nd=Td("Promise").prototype.catch;Ad.catch!==Nd&&Id(Ad,"catch",Nd,{unsafe:!0})}var Od=Yr,bd=Qn,Rd=uh,Sd=Gl,Md=wc;Pu({target:"Promise",stat:!0,forced:ld},{race:function(t){var e=this,r=Rd.f(e),n=r.reject,i=Sd((function(){var i=bd(e.resolve);Md(t,(function(t){Od(i,e,t).then(r.resolve,n)}))}));return i.error&&n(i.value),r.promise}});var Cd=Yr,xd=uh;Pu({target:"Promise",stat:!0,forced:sh.CONSTRUCTOR},{reject:function(t){var e=xd.f(this);return Cd(e.reject,void 0,t),e.promise}});var Pd=lo,Ud=Nn,kd=uh,Dd=function(t,e){if(Pd(t),Ud(e)&&e.constructor===t)return e;var r=kd.f(t);return(0,r.resolve)(e),r.promise},Ld=Pu,Fd=sh.CONSTRUCTOR,Vd=Dd;Sn("Promise"),Ld({target:"Promise",stat:!0,forced:Fd},{resolve:function(t){return Vd(this,t)}});var jd=Yr,Gd=Qn,Bd=uh,Hd=Gl,Kd=wc;Pu({target:"Promise",stat:!0},{allSettled:function(t){var e=this,r=Bd.f(e),n=r.resolve,i=r.reject,o=Hd((function(){var r=Gd(e.resolve),i=[],o=0,s=1;Kd(t,(function(t){var u=o++,a=!1;s++,jd(r,e,t).then((function(t){a||(a=!0,i[u]={status:"fulfilled",value:t},--s||n(i))}),(function(t){a||(a=!0,i[u]={status:"rejected",reason:t},--s||n(i))}))})),--s||n(i)}));return o.error&&i(o.value),r.promise}});var zd=Yr,Jd=Qn,qd=Sn,Yd=uh,Xd=Gl,Wd=wc,$d="No one promise resolved";Pu({target:"Promise",stat:!0},{any:function(t){var e=this,r=qd("AggregateError"),n=Yd.f(e),i=n.resolve,o=n.reject,s=Xd((function(){var n=Jd(e.resolve),s=[],u=0,a=1,c=!1;Wd(t,(function(t){var f=u++,p=!1;a++,zd(n,e,t).then((function(t){p||c||(c=!0,i(t))}),(function(t){p||c||(p=!0,s[f]=t,--a||o(new r(s,$d)))}))})),--a||o(new r(s,$d))}));return s.error&&o(s.value),n.promise}});var Zd=Pu,Qd=Kl,tv=Hr,ev=Sn,rv=In,nv=xp,iv=Dd,ov=Cs,sv=Qd&&Qd.prototype;if(Zd({target:"Promise",proto:!0,real:!0,forced:!!Qd&&tv((function(){sv.finally.call({then:function(){}},(function(){}))}))},{finally:function(t){var e=nv(this,ev("Promise")),r=rv(t);return this.then(r?function(r){return iv(e,t()).then((function(){return r}))}:t,r?function(r){return iv(e,t()).then((function(){throw r}))}:t)}}),rv(Qd)){var uv=ev("Promise").prototype.finally;sv.finally!==uv&&ov(sv,"finally",uv,{unsafe:!0})}var av=an,cv=Ds,fv=Ic,pv=En,lv=av("".charAt),hv=av("".charCodeAt),dv=av("".slice),vv=function(t){return function(e,r){var n,i,o=fv(pv(e)),s=cv(r),u=o.length;return s<0||s>=u?t?"":void 0:(n=hv(o,s))<55296||n>56319||s+1===u||(i=hv(o,s+1))<56320||i>57343?t?lv(o,s):n:t?dv(o,s,s+2):i-56320+(n-55296<<10)+65536}},yv=(vv(!1),vv(!0)),mv=Ic,gv=ds,Ev=Ff,wv="String Iterator",Tv=gv.set,_v=gv.getterFor(wv);Ev(String,"String",(function(t){Tv(this,{type:wv,string:mv(t),index:0})}),(function(){var t,e=_v(this),r=e.string,n=e.index;return n>=r.length?{value:void 0,done:!0}:(t=yv(r,n),e.index+=t.length,{value:t,done:!1})}));var Iv=Gr,Av=Iv.Promise,Nv=Xi("span").classList,Ov=Nv&&Nv.constructor&&Nv.constructor.prototype,bv=Ov===Object.prototype?void 0:Ov,Rv=Gr,Sv={CSSRuleList:0,CSSStyleDeclaration:0,CSSValueList:0,ClientRectList:0,DOMRectList:0,DOMStringList:0,DOMTokenList:1,DataTransferItemList:0,FileList:0,HTMLAllCollection:0,HTMLCollection:0,HTMLFormElement:0,HTMLSelectElement:0,MediaList:0,MimeTypeArray:0,NamedNodeMap:0,NodeList:1,PaintRequestList:0,Plugin:0,PluginArray:0,SVGLengthList:0,SVGNumberList:0,SVGPathSegList:0,SVGPointList:0,SVGStringList:0,SVGTransformList:0,SourceBufferList:0,StyleSheetList:0,TextTrackCueList:0,TextTrackList:0,TouchList:0},Mv=bv,Cv=Xf,xv=bo,Pv=ki,Uv=Pv("iterator"),kv=Pv("toStringTag"),Dv=Cv.values,Lv=function(t,e){if(t){if(t[Uv]!==Dv)try{xv(t,Uv,Dv)}catch(e){t[Uv]=Dv}if(t[kv]||xv(t,kv,e),Sv[e])for(var r in Cv)if(t[r]!==Cv[r])try{xv(t,r,Cv[r])}catch(e){t[r]=Cv[r]}}};for(var Fv in Sv)Lv(Rv[Fv]&&Rv[Fv].prototype,Fv);Lv(Mv,"DOMTokenList");var Vv=Av,jv=uh,Gv=Gl;Pu({target:"Promise",stat:!0,forced:!0},{try:function(t){var e=jv.f(this),r=Gv(t);return(r.error?e.reject:e.resolve)(r.value),e.promise}});var Bv=Vv;({exports:{}}).exports=Bv;var Hv=lo,Kv=sc,zv=zi,Jv=uo,qv=en,Yv=function(t,e,r){var n=zv(e);n in t?Jv.f(t,n,qv(0,r)):t[n]=r},Xv=Ma,Wv=Yr,$v=yi,Zv=function(t,e,r,n){try{return n?e(Hv(r)[0],r[1]):e(r)}catch(e){Kv(t,"throw",e)}},Qv=ka,ty=Np,ey=Ks,ry=Yv,ny=rc,iy=Xa,oy=Array,sy=function(t){var e=$v(t),r=ty(this),n=arguments.length,i=n>1?arguments[1]:void 0,o=void 0!==i;o&&(i=Xv(i,n>2?arguments[2]:void 0));var s,u,a,c,f,p,l=iy(e),h=0;if(!l||this===oy&&Qv(l))for(s=ey(e),u=r?new this(s):oy(s);s>h;h++)p=o?i(e[h],h):e[h],ry(u,h,p);else for(f=(c=ny(e,l)).next,u=r?new this:[];!(a=Wv(f,c)).done;h++)p=o?Zv(c,i,[a.value,h],!0):a.value,ry(u,h,p);return u.length=h,u};Pu({target:"Array",stat:!0,forced:!fd((function(t){Array.from(t)}))},{from:sy});var uy=ln,ay=Array.isArray||function(t){return"Array"==uy(t)};Pu({target:"Array",stat:!0},{isArray:ay});var cy=Np,fy=Yv,py=Array;Pu({target:"Array",stat:!0,forced:Hr((function(){function t(){}return!(py.of.call(t)instanceof t)}))},{of:function(){for(var t=0,e=arguments.length,r=new(cy(this)?this:py)(e);e>t;)fy(r,t,arguments[t++]);return r.length=e,r}});var ly=yi,hy=Ks,dy=Ds,vy=Qc;Pu({target:"Array",proto:!0},{at:function(t){var e=ly(this),r=hy(e),n=dy(t),i=n>=0?n:r+n;return i<0||i>=r?void 0:e[i]}}),vy("at");var yy=TypeError,my=function(t){if(t>9007199254740991)throw yy("Maximum allowed index exceeded");return t},gy=ay,Ey=Np,wy=Nn,Ty=ki("species"),_y=Array,Iy=function(t){var e;return gy(t)&&(e=t.constructor,(Ey(e)&&(e===_y||gy(e.prototype))||wy(e)&&null===(e=e[Ty]))&&(e=void 0)),void 0===e?_y:e},Ay=function(t,e){return new(Iy(t))(0===e?0:e)},Ny=Hr,Oy=Fn,by=ki("species"),Ry=function(t){return Oy>=51||!Ny((function(){var e=[];return(e.constructor={})[by]=function(){return{foo:1}},1!==e[t](Boolean).foo}))},Sy=Pu,My=Hr,Cy=ay,xy=Nn,Py=yi,Uy=Ks,ky=my,Dy=Yv,Ly=Ay,Fy=Ry,Vy=Fn,jy=ki("isConcatSpreadable"),Gy=Vy>=51||!My((function(){var t=[];return t[jy]=!1,t.concat()[0]!==t})),By=Fy("concat"),Hy=function(t){if(!xy(t))return!1;var e=t[jy];return void 0!==e?!!e:Cy(t)};Sy({target:"Array",proto:!0,arity:1,forced:!Gy||!By},{concat:function(){var t,e,r,n,i,o=Py(this),s=Ly(o,0),u=0;for(t=-1,r=arguments.length;t<r;t++)if(Hy(i=-1===t?o:arguments[t]))for(n=Uy(i),ky(u+n),e=0;e<n;e++,u++)e in i&&Dy(s,u,i[e]);else ky(u+1),Dy(s,u++,i);return s.length=u,s}});var Ky=Xn,zy=TypeError,Jy=function(t,e){if(!delete t[e])throw zy("Cannot delete property "+Ky(e)+" of "+Ky(t))},qy=yi,Yy=js,Xy=Ks,Wy=Jy,$y=Math.min,Zy=[].copyWithin||function(t,e){var r=qy(this),n=Xy(r),i=Yy(t,n),o=Yy(e,n),s=arguments.length>2?arguments[2]:void 0,u=$y((void 0===s?n:Yy(s,n))-o,n-i),a=1;for(o<i&&i<o+u&&(a=-1,o+=u-1,i+=u-1);u-- >0;)o in r?r[i]=r[o]:Wy(r,i),i+=a,o+=a;return r},Qy=Qc;Pu({target:"Array",proto:!0},{copyWithin:Zy}),Qy("copyWithin");var tm=Ma,em=mn,rm=yi,nm=Ks,im=Ay,om=an([].push),sm=function(t){var e=1==t,r=2==t,n=3==t,i=4==t,o=6==t,s=7==t,u=5==t||o;return function(a,c,f,p){for(var l,h,d=rm(a),v=em(d),y=tm(c,f),m=nm(v),g=0,E=p||im,w=e?E(a,m):r||s?E(a,0):void 0;m>g;g++)if((u||g in v)&&(h=y(l=v[g],g,d),t))if(e)w[g]=h;else if(h)switch(t){case 3:return!0;case 5:return l;case 6:return g;case 2:om(w,l)}else switch(t){case 4:return!1;case 7:om(w,l)}return o?-1:n||i?i:w}},um={forEach:sm(0),map:sm(1),filter:sm(2),some:sm(3),every:sm(4),find:sm(5),findIndex:sm(6),filterReject:sm(7)},am=Hr,cm=function(t,e){var r=[][t];return!!r&&am((function(){r.call(null,e||function(){return 1},1)}))},fm=um.every;Pu({target:"Array",proto:!0,forced:!cm("every")},{every:function(t){return fm(this,t,arguments.length>1?arguments[1]:void 0)}});var pm=yi,lm=js,hm=Ks,dm=function(t){for(var e=pm(this),r=hm(e),n=arguments.length,i=lm(n>1?arguments[1]:void 0,r),o=n>2?arguments[2]:void 0,s=void 0===o?r:lm(o,r);s>i;)e[i++]=t;return e},vm=Qc;Pu({target:"Array",proto:!0},{fill:dm}),vm("fill");var ym=um.filter;Pu({target:"Array",proto:!0,forced:!Ry("filter")},{filter:function(t){return ym(this,t,arguments.length>1?arguments[1]:void 0)}});var mm=Pu,gm=um.find,Em=Qc,wm="find",Tm=!0;wm in[]&&Array(1).find((function(){Tm=!1})),mm({target:"Array",proto:!0,forced:Tm},{find:function(t){return gm(this,t,arguments.length>1?arguments[1]:void 0)}}),Em(wm);var _m=Pu,Im=um.findIndex,Am=Qc,Nm="findIndex",Om=!0;Nm in[]&&Array(1).findIndex((function(){Om=!1})),_m({target:"Array",proto:!0,forced:Om},{findIndex:function(t){return Im(this,t,arguments.length>1?arguments[1]:void 0)}}),Am(Nm);var bm=Ma,Rm=mn,Sm=yi,Mm=Ks,Cm=function(t){var e=1==t;return function(r,n,i){for(var o,s=Sm(r),u=Rm(s),a=bm(n,i),c=Mm(u);c-- >0;)if(a(o=u[c],c,s))switch(t){case 0:return o;case 1:return c}return e?-1:void 0}},xm={findLast:Cm(0),findLastIndex:Cm(1)},Pm=xm.findLast,Um=Qc;Pu({target:"Array",proto:!0},{findLast:function(t){return Pm(this,t,arguments.length>1?arguments[1]:void 0)}}),Um("findLast");var km=xm.findLastIndex,Dm=Qc;Pu({target:"Array",proto:!0},{findLastIndex:function(t){return km(this,t,arguments.length>1?arguments[1]:void 0)}}),Dm("findLastIndex");var Lm=ay,Fm=Ks,Vm=my,jm=Ma,Gm=function(t,e,r,n,i,o,s,u){for(var a,c,f=i,p=0,l=!!s&&jm(s,u);p<n;)p in r&&(a=l?l(r[p],p,e):r[p],o>0&&Lm(a)?(c=Fm(a),f=Gm(t,e,a,c,f,o-1)-1):(Vm(f+1),t[f]=a),f++),p++;return f},Bm=Gm,Hm=Bm,Km=yi,zm=Ks,Jm=Ds,qm=Ay;Pu({target:"Array",proto:!0},{flat:function(){var t=arguments.length?arguments[0]:void 0,e=Km(this),r=zm(e),n=qm(e,0);return n.length=Hm(n,e,e,r,0,void 0===t?1:Jm(t)),n}});var Ym=Bm,Xm=Qn,Wm=yi,$m=Ks,Zm=Ay;Pu({target:"Array",proto:!0},{flatMap:function(t){var e,r=Wm(this),n=$m(r);return Xm(t),(e=Zm(r,0)).length=Ym(e,r,r,n,0,1,t,arguments.length>1?arguments[1]:void 0),e}});var Qm=um.forEach,tg=cm("forEach")?[].forEach:function(t){return Qm(this,t,arguments.length>1?arguments[1]:void 0)};Pu({target:"Array",proto:!0,forced:[].forEach!=tg},{forEach:tg});var eg=Xs.includes,rg=Qc;Pu({target:"Array",proto:!0,forced:Hr((function(){return!Array(1).includes()}))},{includes:function(t){return eg(this,t,arguments.length>1?arguments[1]:void 0)}}),rg("includes");var ng=Pu,ig=Xs.indexOf,og=cm,sg=an([].indexOf),ug=!!sg&&1/sg([1],1,-0)<0,ag=og("indexOf");ng({target:"Array",proto:!0,forced:ug||!ag},{indexOf:function(t){var e=arguments.length>1?arguments[1]:void 0;return ug?sg(this,t,e)||0:ig(this,t,e)}});var cg=Pu,fg=mn,pg=_n,lg=cm,hg=an([].join),dg=fg!=Object,vg=lg("join",",");cg({target:"Array",proto:!0,forced:dg||!vg},{join:function(t){return hg(pg(this),void 0===t?",":t)}});var yg=Lp,mg=_n,gg=Ds,Eg=Ks,wg=cm,Tg=Math.min,_g=[].lastIndexOf,Ig=!!_g&&1/[1].lastIndexOf(1,-0)<0,Ag=wg("lastIndexOf"),Ng=Ig||!Ag?function(t){if(Ig)return yg(_g,this,arguments)||0;var e=mg(this),r=Eg(e),n=r-1;for(arguments.length>1&&(n=Tg(n,gg(arguments[1]))),n<0&&(n=r+n);n>=0;n--)if(n in e&&e[n]===t)return n||0;return-1}:_g;Pu({target:"Array",proto:!0,forced:Ng!==[].lastIndexOf},{lastIndexOf:Ng});var Og=um.map;Pu({target:"Array",proto:!0,forced:!Ry("map")},{map:function(t){return Og(this,t,arguments.length>1?arguments[1]:void 0)}});var bg=Pu,Rg=yi,Sg=Ks,Mg=my,Cg=Hr((function(){return 4294967297!==[].push.call({length:4294967296},1)})),xg=!function(){try{Object.defineProperty([],"length",{writable:!1}).push()}catch(t){return t instanceof TypeError}}();bg({target:"Array",proto:!0,arity:1,forced:Cg||xg},{push:function(){var t=Rg(this),e=Sg(t),r=arguments.length;Mg(e+r);for(var n=0;n<r;n++)t[e]=arguments[n],e++;return t.length=e,e}});var Pg=Qn,Ug=yi,kg=mn,Dg=Ks,Lg=TypeError,Fg=function(t){return function(e,r,n,i){Pg(r);var o=Ug(e),s=kg(o),u=Dg(o),a=t?u-1:0,c=t?-1:1;if(n<2)for(;;){if(a in s){i=s[a],a+=c;break}if(a+=c,t?a<0:u<=a)throw Lg("Reduce of empty array with no initial value")}for(;t?a>=0:u>a;a+=c)a in s&&(i=r(i,s[a],a,o));return i}},Vg={left:Fg(!1),right:Fg(!0)},jg=Vg.left,Gg=Fn,Bg=Qf;Pu({target:"Array",proto:!0,forced:!cm("reduce")||!Bg&&Gg>79&&Gg<83},{reduce:function(t){var e=arguments.length;return jg(this,t,e,e>1?arguments[1]:void 0)}});var Hg=Vg.right,Kg=Fn,zg=Qf;Pu({target:"Array",proto:!0,forced:!cm("reduceRight")||!zg&&Kg>79&&Kg<83},{reduceRight:function(t){return Hg(this,t,arguments.length,arguments.length>1?arguments[1]:void 0)}});var Jg=Pu,qg=ay,Yg=an([].reverse),Xg=[1,2];Jg({target:"Array",proto:!0,forced:String(Xg)===String(Xg.reverse())},{reverse:function(){return qg(this)&&(this.length=this.length),Yg(this)}});var Wg=Pu,$g=ay,Zg=Np,Qg=Nn,tE=js,eE=Ks,rE=_n,nE=Yv,iE=ki,oE=Fp,sE=Ry("slice"),uE=iE("species"),aE=Array,cE=Math.max;Wg({target:"Array",proto:!0,forced:!sE},{slice:function(t,e){var r,n,i,o=rE(this),s=eE(o),u=tE(t,s),a=tE(void 0===e?s:e,s);if($g(o)&&(r=o.constructor,(Zg(r)&&(r===aE||$g(r.prototype))||Qg(r)&&null===(r=r[uE]))&&(r=void 0),r===aE||void 0===r))return oE(o,u,a);for(n=new(void 0===r?aE:r)(cE(a-u,0)),i=0;u<a;u++,i++)u in o&&nE(n,i,o[u]);return n.length=i,n}});var fE=um.some;Pu({target:"Array",proto:!0,forced:!cm("some")},{some:function(t){return fE(this,t,arguments.length>1?arguments[1]:void 0)}});var pE=js,lE=Ks,hE=Yv,dE=Array,vE=Math.max,yE=function(t,e,r){for(var n=lE(t),i=pE(e,n),o=pE(void 0===r?n:r,n),s=dE(vE(o-i,0)),u=0;i<o;i++,u++)hE(s,u,t[i]);return s.length=u,s},mE=yE,gE=Math.floor,EE=function(t,e){var r=t.length,n=gE(r/2);return r<8?wE(t,e):TE(t,EE(mE(t,0,n),e),EE(mE(t,n),e),e)},wE=function(t,e){for(var r,n,i=t.length,o=1;o<i;){for(n=o,r=t[o];n&&e(t[n-1],r)>0;)t[n]=t[--n];n!==o++&&(t[n]=r)}return t},TE=function(t,e,r,n){for(var i=e.length,o=r.length,s=0,u=0;s<i||u<o;)t[s+u]=s<i&&u<o?n(e[s],r[u])<=0?e[s++]:r[u++]:s<i?e[s++]:r[u++];return t},_E=EE,IE=Cn.match(/firefox\/(\d+)/i),AE=!!IE&&+IE[1],NE=/MSIE|Trident/.test(Cn),OE=Cn.match(/AppleWebKit\/(\d+)\./),bE=!!OE&&+OE[1],RE=Pu,SE=an,ME=Qn,CE=yi,xE=Ks,PE=Jy,UE=Ic,kE=Hr,DE=_E,LE=cm,FE=AE,VE=NE,jE=Fn,GE=bE,BE=[],HE=SE(BE.sort),KE=SE(BE.push),zE=kE((function(){BE.sort(void 0)})),JE=kE((function(){BE.sort(null)})),qE=LE("sort"),YE=!kE((function(){if(jE)return jE<70;if(!(FE&&FE>3)){if(VE)return!0
;if(GE)return GE<603;var t,e,r,n,i="";for(t=65;t<76;t++){switch(e=String.fromCharCode(t),t){case 66:case 69:case 70:case 72:r=3;break;case 68:case 71:r=4;break;default:r=2}for(n=0;n<47;n++)BE.push({k:e+n,v:r})}for(BE.sort((function(t,e){return e.v-t.v})),n=0;n<BE.length;n++)e=BE[n].k.charAt(0),i.charAt(i.length-1)!==e&&(i+=e);return"DGBEFHACIJK"!==i}}));RE({target:"Array",proto:!0,forced:zE||!JE||!qE||!YE},{sort:function(t){void 0!==t&&ME(t);var e=CE(this);if(YE)return void 0===t?HE(e):HE(e,t);var r,n,i=[],o=xE(e);for(n=0;n<o;n++)n in e&&KE(i,e[n]);for(DE(i,function(t){return function(e,r){return void 0===r?-1:void 0===e?1:void 0!==t?+t(e,r)||0:UE(e)>UE(r)?1:-1}}(t)),r=i.length,n=0;n<r;)e[n]=i[n++];for(;n<o;)PE(e,n++);return e}}),ip("Array");var XE=Pu,WE=yi,$E=js,ZE=Ds,QE=Ks,tw=my,ew=Ay,rw=Yv,nw=Jy,iw=Ry("splice"),ow=Math.max,sw=Math.min;XE({target:"Array",proto:!0,forced:!iw},{splice:function(t,e){var r,n,i,o,s,u,a=WE(this),c=QE(a),f=$E(t,c),p=arguments.length;for(0===p?r=n=0:1===p?(r=0,n=c-f):(r=p-2,n=sw(ow(ZE(e),0),c-f)),tw(c+r-n),i=ew(a,n),o=0;o<n;o++)(s=f+o)in a&&rw(i,o,a[s]);if(i.length=n,r<n){for(o=f;o<c-n;o++)u=o+r,(s=o+n)in a?a[u]=a[s]:nw(a,u);for(o=c;o>c-n+r;o--)nw(a,o-1)}else if(r>n)for(o=c-n;o>f;o--)u=o+r-1,(s=o+n-1)in a?a[u]=a[s]:nw(a,u);for(o=0;o<r;o++)a[o+f]=arguments[o+2];return a.length=c-n+r,i}}),Qc("flat"),Qc("flatMap");var uw=Pu,aw=yi,cw=Ks,fw=Jy,pw=my,lw=1!==[].unshift(0),hw=!function(){try{Object.defineProperty([],"length",{writable:!1}).unshift()}catch(t){return t instanceof TypeError}}();uw({target:"Array",proto:!0,arity:1,forced:lw||hw},{unshift:function(){var t=aw(this),e=cw(t),r=arguments.length;if(r){pw(e+r);for(var n=e;n--;){var i=n+r;n in t?t[i]=t[n]:fw(t,i)}for(var o=0;o<r;o++)t[o]=arguments[o]}return t.length=e+r}});var dw=Iv.Array,vw={exports:{}},yw={},mw=ln,gw=_n,Ew=xs.f,ww=yE,Tw="object"==typeof window&&window&&Object.getOwnPropertyNames?Object.getOwnPropertyNames(window):[];yw.f=function(t){return Tw&&"Window"==mw(t)?function(t){try{return Ew(t)}catch(t){return ww(Tw)}}(t):Ew(gw(t))};var _w=Hr((function(){if("function"==typeof ArrayBuffer){var t=new ArrayBuffer(8);Object.isExtensible(t)&&Object.defineProperty(t,"a",{value:8})}})),Iw=Hr,Aw=Nn,Nw=ln,Ow=_w,bw=Object.isExtensible,Rw=Iw((function(){bw(1)}))||Ow?function(t){return!!Aw(t)&&(!Ow||"ArrayBuffer"!=Nw(t))&&(!bw||bw(t))}:bw,Sw=!Hr((function(){return Object.isExtensible(Object.preventExtensions({}))})),Mw=Pu,Cw=an,xw=Wo,Pw=Nn,Uw=Ei,kw=uo.f,Dw=xs,Lw=yw,Fw=Rw,Vw=Sw,jw=!1,Gw=Ai("meta"),Bw=0,Hw=function(t){kw(t,Gw,{value:{objectID:"O"+Bw++,weakData:{}}})},Kw=vw.exports={enable:function(){Kw.enable=function(){},jw=!0;var t=Dw.f,e=Cw([].splice),r={};r[Gw]=1,t(r).length&&(Dw.f=function(r){for(var n=t(r),i=0,o=n.length;i<o;i++)if(n[i]===Gw){e(n,i,1);break}return n},Mw({target:"Object",stat:!0,forced:!0},{getOwnPropertyNames:Lw.f}))},fastKey:function(t,e){if(!Pw(t))return"symbol"==typeof t?t:("string"==typeof t?"S":"P")+t;if(!Uw(t,Gw)){if(!Fw(t))return"F";if(!e)return"E";Hw(t)}return t[Gw].objectID},getWeakData:function(t,e){if(!Uw(t,Gw)){if(!Fw(t))return!0;if(!e)return!1;Hw(t)}return t[Gw].weakData},onFreeze:function(t){return Vw&&jw&&Fw(t)&&!Uw(t,Gw)&&Hw(t),t}};xw[Gw]=!0;var zw=In,Jw=Nn,qw=Xu,Yw=Pu,Xw=Gr,Ww=an,$w=Nu,Zw=Cs,Qw=vw.exports,tT=wc,eT=up,rT=In,nT=Nn,iT=Hr,oT=fd,sT=lf,uT=function(t,e,r){var n,i;return qw&&zw(n=e.constructor)&&n!==r&&Jw(i=n.prototype)&&i!==r.prototype&&qw(t,i),t},aT=Cs,cT=function(t,e,r){for(var n in e)aT(t,n,e[n],r);return t},fT=uo.f,pT=Ea,lT=cT,hT=Ma,dT=up,vT=wc,yT=Ff,mT=ip,gT=Kr,ET=vw.exports.fastKey,wT=ds.set,TT=ds.getterFor,_T={getConstructor:function(t,e,r,n){var i=t((function(t,i){dT(t,o),wT(t,{type:e,index:pT(null),first:void 0,last:void 0,size:0}),gT||(t.size=0),null!=i&&vT(i,t[n],{that:t,AS_ENTRIES:r})})),o=i.prototype,s=TT(e),u=function(t,e,r){var n,i,o=s(t),u=a(t,e);return u?u.value=r:(o.last=u={index:i=ET(e,!0),key:e,value:r,previous:n=o.last,next:void 0,removed:!1},o.first||(o.first=u),n&&(n.next=u),gT?o.size++:t.size++,"F"!==i&&(o.index[i]=u)),t},a=function(t,e){var r,n=s(t),i=ET(e);if("F"!==i)return n.index[i];for(r=n.first;r;r=r.next)if(r.key==e)return r};return lT(o,{clear:function(){for(var t=s(this),e=t.index,r=t.first;r;)r.removed=!0,r.previous&&(r.previous=r.previous.next=void 0),delete e[r.index],r=r.next;t.first=t.last=void 0,gT?t.size=0:this.size=0},delete:function(t){var e=this,r=s(e),n=a(e,t);if(n){var i=n.next,o=n.previous;delete r.index[n.index],n.removed=!0,o&&(o.next=i),i&&(i.previous=o),r.first==n&&(r.first=i),r.last==n&&(r.last=o),gT?r.size--:e.size--}return!!n},forEach:function(t){for(var e,r=s(this),n=hT(t,arguments.length>1?arguments[1]:void 0);e=e?e.next:r.first;)for(n(e.value,e.key,this);e&&e.removed;)e=e.previous},has:function(t){return!!a(this,t)}}),lT(o,r?{get:function(t){var e=a(this,t);return e&&e.value},set:function(t,e){return u(this,0===t?0:t,e)}}:{add:function(t){return u(this,t=0===t?0:t,t)}}),gT&&fT(o,"size",{get:function(){return s(this).size}}),i},setStrong:function(t,e,r){var n=e+" Iterator",i=TT(e),o=TT(n);yT(t,e,(function(t,e){wT(this,{type:n,target:t,state:i(t),kind:e,last:void 0})}),(function(){for(var t=o(this),e=t.kind,r=t.last;r&&r.removed;)r=r.previous;return t.target&&(t.last=r=r?r.next:t.state.first)?"keys"==e?{value:r.key,done:!1}:"values"==e?{value:r.value,done:!1}:{value:[r.key,r.value],done:!1}:(t.target=void 0,{value:void 0,done:!0})}),r?"entries":"values",!r,!0),mT(e)}};!function(t,e,r){var n=-1!==t.indexOf("Map"),i=-1!==t.indexOf("Weak"),o=n?"set":"add",s=Xw[t],u=s&&s.prototype,a=s,c={},f=function(t){var e=Ww(u[t]);Zw(u,t,"add"==t?function(t){return e(this,0===t?0:t),this}:"delete"==t?function(t){return!(i&&!nT(t))&&e(this,0===t?0:t)}:"get"==t?function(t){return i&&!nT(t)?void 0:e(this,0===t?0:t)}:"has"==t?function(t){return!(i&&!nT(t))&&e(this,0===t?0:t)}:function(t,r){return e(this,0===t?0:t,r),this})};if($w(t,!rT(s)||!(i||u.forEach&&!iT((function(){(new s).entries().next()})))))a=r.getConstructor(e,t,n,o),Qw.enable();else if($w(t,!0)){var p=new a,l=p[o](i?{}:-0,1)!=p,h=iT((function(){p.has(1)})),d=oT((function(t){new s(t)})),v=!i&&iT((function(){for(var t=new s,e=5;e--;)t[o](e,e);return!t.has(-0)}));d||((a=e((function(t,e){eT(t,u);var r=uT(new s,t,a);return null!=e&&tT(e,r[o],{that:r,AS_ENTRIES:n}),r}))).prototype=u,u.constructor=a),(h||v)&&(f("delete"),f("has"),n&&f("get")),(v||l)&&f(o),i&&u.clear&&delete u.clear}c[t]=a,Yw({global:!0,constructor:!0,forced:a!=s},c),sT(a,t),i||r.setStrong(a,t,n)}("Map",(function(t){return function(){return t(this,arguments.length?arguments[0]:void 0)}}),_T);var IT=Ks,AT=function(t,e){for(var r=0,n=IT(e),i=new t(n);n>r;)i[r]=e[r++];return i},NT=Ma,OT=mn,bT=yi,RT=zi,ST=Ks,MT=Ea,CT=AT,xT=Array,PT=an([].push),UT=function(t,e,r,n){for(var i,o,s,u=bT(t),a=OT(u),c=NT(e,r),f=MT(null),p=ST(a),l=0;p>l;l++)s=a[l],(o=RT(c(s,l,u)))in f?PT(f[o],s):f[o]=[s];if(n&&(i=n(u))!==xT)for(o in f)f[o]=CT(i,f[o]);return f},kT=UT,DT=Qc;Pu({target:"Array",proto:!0},{group:function(t){var e=arguments.length>1?arguments[1]:void 0;return kT(this,t,e)}}),DT("group");var LT=UT,FT=Qc;Pu({target:"Array",proto:!0,forced:!cm("groupBy")},{groupBy:function(t){var e=arguments.length>1?arguments[1]:void 0;return LT(this,t,e)}}),FT("groupBy");var VT=Ma,jT=an,GT=mn,BT=yi,HT=Ks,KT=Sn("Map"),zT=KT.prototype,JT=jT(zT.get),qT=jT(zT.has),YT=jT(zT.set),XT=jT([].push),WT=function(t){for(var e,r,n=BT(this),i=GT(n),o=VT(t,arguments.length>1?arguments[1]:void 0),s=new KT,u=HT(i),a=0;u>a;a++)e=o(r=i[a],a,n),qT(s,e)?XT(JT(s,e),r):YT(s,e,[r]);return s},$T=Qc,ZT=WT;Pu({target:"Array",proto:!0,name:"groupToMap",forced:!cm("groupByToMap")},{groupByToMap:ZT}),$T("groupByToMap");var QT=Qc;Pu({target:"Array",proto:!0},{groupToMap:WT}),QT("groupToMap");var t_=Ks,e_=function(t,e){for(var r=t_(t),n=new e(r),i=0;i<r;i++)n[i]=t[r-i-1];return n},r_=_n,n_=Qc,i_=Array;Pu({target:"Array",proto:!0},{toReversed:function(){return e_(r_(this),i_)}}),n_("toReversed");var o_=Gr,s_=function(t){return o_[t].prototype},u_=Pu,a_=Qn,c_=_n,f_=AT,p_=Qc,l_=Array,h_=an(s_("Array").sort);u_({target:"Array",proto:!0},{toSorted:function(t){void 0!==t&&a_(t);var e=c_(this),r=f_(l_,e);return h_(r,t)}}),p_("toSorted");var d_=Pu,v_=Qc,y_=my,m_=Ks,g_=js,E_=_n,w_=Ds,T_=Array,__=Math.max,I_=Math.min;d_({target:"Array",proto:!0},{toSpliced:function(t,e){var r,n,i,o,s=E_(this),u=m_(s),a=g_(t,u),c=arguments.length,f=0;for(0===c?r=n=0:1===c?(r=0,n=u-a):(r=c-2,n=I_(__(w_(e),0),u-a)),i=y_(u+r-n),o=T_(i);f<a;f++)o[f]=s[f];for(;f<a+r;f++)o[f]=arguments[f-a+2];for(;f<i;f++)o[f]=s[f+n-r];return o}}),v_("toSpliced");var A_=Ks,N_=Ds,O_=RangeError,b_=function(t,e,r,n){var i=A_(t),o=N_(r),s=o<0?i+o:o;if(s>=i||s<0)throw O_("Incorrect index");for(var u=new e(i),a=0;a<i;a++)u[a]=a===s?n:t[a];return u},R_=_n,S_=Array;Pu({target:"Array",proto:!0},{with:function(t,e){return b_(R_(this),S_,t,e)}});var M_,C_,x_=dw,P_=Gr,U_=li,k_=In,D_=Bu,L_=Cs,F_=ki("asyncIterator"),V_=P_.AsyncIterator,j_=U_.AsyncIteratorPrototype;if(j_)M_=j_;else if(k_(V_))M_=V_.prototype;else if(U_.USE_FUNCTION_CONSTRUCTOR||P_.USE_FUNCTION_CONSTRUCTOR)try{C_=D_(D_(D_(Function("return async function*(){}()")()))),D_(C_)===Object.prototype&&(M_=C_)}catch(t){}M_||(M_={}),k_(M_[F_])||L_(M_,F_,(function(){return this}));var G_=Yr,B_=lo,H_=Ea,K_=ei,z_=cT,J_=ds,q_=M_,Y_=Sn("Promise"),X_="AsyncFromSyncIterator",W_=J_.set,$_=J_.getterFor(X_),Z_=function(t,e,r){var n=t.done;Y_.resolve(t.value).then((function(t){e({done:n,value:t})}),r)},Q_=function(t){W_(this,{type:X_,iterator:B_(t),next:t.next})};Q_.prototype=z_(H_(q_),{next:function(){var t=$_(this);return new Y_((function(e,r){var n=B_(G_(t.next,t.iterator));Z_(n,e,r)}))},return:function(){var t=$_(this).iterator;return new Y_((function(e,r){var n=K_(t,"return");if(void 0===n)return e({done:!0,value:void 0});var i=B_(G_(n,t));Z_(i,e,r)}))}});var tI=Q_,eI=Yr,rI=tI,nI=lo,iI=rc,oI=ei,sI=ki("asyncIterator"),uI=Qn,aI=lo,cI=Yr,fI=Sn,pI=ei,lI=Yr,hI=Qn,dI=lo,vI=my,yI=Sn,mI=function(t){return{iterator:t,next:uI(aI(t).next)}},gI=function(t,e,r,n){try{var i=pI(t,"return");if(i)return fI("Promise").resolve(cI(i,t)).then((function(){e(r)}),(function(t){n(t)}))}catch(t){return n(t)}e(r)},EI=function(t){var e=0==t,r=1==t,n=2==t,i=3==t;return function(t,o,s){var u=mI(t),a=yI("Promise"),c=u.iterator,f=u.next,p=0,l=void 0!==o;return!l&&e||hI(o),new a((function(t,u){var h=function(t){gI(c,u,t,u)},d=function(){try{if(e&&l)try{vI(p)}catch(t){h(t)}a.resolve(dI(lI(f,c))).then((function(f){try{if(dI(f).done)e?(s.length=p,t(s)):t(!i&&(n||void 0));else{var v=f.value;try{l?a.resolve(e?o(v,p):o(v)).then((function(o){if(r)d();else if(n)o?d():gI(c,t,!1,u);else if(e)try{s[p++]=o,d()}catch(t){h(t)}else o?gI(c,t,i||v,u):d()}),h):(s[p++]=v,d())}catch(t){h(t)}}}catch(t){u(t)}}),u)}catch(t){u(t)}};d()}))}},wI={toArray:EI(0),forEach:EI(1),every:EI(2),some:EI(3),find:EI(4)},TI=Ma,_I=yi,II=Np,AI=function(t,e){var r=arguments.length<2?oI(t,sI):e;return r?nI(eI(r,t)):new rI(iI(t))},NI=rc,OI=Xa,bI=ei,RI=s_,SI=Sn,MI=tI,CI=wI.toArray,xI=ki("asyncIterator"),PI=RI("Array").values,UI=function(t){var e=this,r=arguments.length,n=r>1?arguments[1]:void 0,i=r>2?arguments[2]:void 0;return new(SI("Promise"))((function(r){var o=_I(t);void 0!==n&&(n=TI(n,i));var s=bI(o,xI),u=s?void 0:OI(o)||PI,a=II(e)?new e:[],c=s?AI(o,s):new MI(NI(o,u));r(CI(c,n,a))}))};Pu({target:"Array",stat:!0,forced:!0},{fromAsync:UI});var kI=um.filterReject,DI=Qc;Pu({target:"Array",proto:!0,forced:!0},{filterOut:function(t){return kI(this,t,arguments.length>1?arguments[1]:void 0)}}),DI("filterOut");var LI=um.filterReject,FI=Qc;Pu({target:"Array",proto:!0,forced:!0},{filterReject:function(t){return LI(this,t,arguments.length>1?arguments[1]:void 0)}}),FI("filterReject");var VI=Pu,jI=ay,GI=Object.isFrozen,BI=function(t,e){if(!GI||!jI(t)||!GI(t))return!1;for(var r,n=0,i=t.length;n<i;)if(!("string"==typeof(r=t[n++])||e&&void 0===r))return!1;return 0!==i};VI({target:"Array",stat:!0,sham:!0,forced:!0},{isTemplateObject:function(t){if(!BI(t,!0))return!1;var e=t.raw;return e.length===t.length&&BI(e,!1)}});var HI=Ro.exports,KI=uo,zI=function(t,e,r){return r.get&&HI(r.get,e,{getter:!0}),r.set&&HI(r.set,e,{setter:!0}),KI.f(t,e,r)},JI=Qc,qI=yi,YI=Ks;Kr&&(zI(Array.prototype,"lastItem",{configurable:!0,get:function(){var t=qI(this),e=YI(t);return 0==e?void 0:t[e-1]},set:function(t){var e=qI(this),r=YI(e);return e[0==r?0:r-1]=t}}),JI("lastItem"));var XI=Qc,WI=yi,$I=Ks;Kr&&(zI(Array.prototype,"lastIndex",{configurable:!0,get:function(){var t=WI(this),e=$I(t);return 0==e?0:e-1}}),XI("lastIndex"));var ZI=an,QI=Qn,tA=Ks,eA=yi,rA=Ay,nA=Sn("Map"),iA=nA.prototype,oA=ZI(iA.forEach),sA=ZI(iA.has),uA=ZI(iA.set),aA=ZI([].push),cA=Qc;Pu({target:"Array",proto:!0,forced:!0},{uniqueBy:function(t){var e,r,n,i=eA(this),o=tA(i),s=rA(i,0),u=new nA,a=null!=t?QI(t):function(t){return t};for(e=0;e<o;e++)n=a(r=i[e]),sA(u,n)||uA(u,n,r);return oA(u,(function(t){aA(s,t)})),s}}),cA("uniqueBy");var fA=x_;({exports:{}}).exports=fA;var pA,lA=function(){function t(t){var e=t.timeout,r=t.callback;this.timeout=Math.max(e,0),this.callback=r}return t.prototype.start=function(){this.timeoutId=setTimeout(this.callback,this.timeout)},t.prototype.refresh=function(){this.stop(),this.start()},t.prototype.stop=function(){this.timeoutId&&clearTimeout(this.timeoutId)},t}(),hA=function(){function t(t,e,r){this.buffer=[],this.sink=t,this.maxQueueSize=e,this.timer=new lA({callback:this.flush.bind(this),timeout:r}),this.started=!1}return t.prototype.start=function(){this.started=!0},t.prototype.stop=function(){this.started=!1;var t=this.sink(this.buffer,!0);return this.buffer=[],this.timer.stop(),t},t.prototype.enqueue=function(t){this.started&&(0===this.buffer.length&&this.timer.refresh(),this.buffer.push(t),this.buffer.length>=this.maxQueueSize&&this.flush())},t.prototype.flush=function(){this.sink(this.buffer),this.buffer=[],this.timer.stop()},t.prototype.close=function(){this.stop()},t}(),dA=function(){function t(){this.listeners={}}return t.prototype.on=function(t,e){this.listeners[t]=(this.listeners[t]||[]).concat(e)},t.prototype.off=function(t,e){this.listeners[t]=(this.listeners[t]||[]).filter((function(t){return t!==e}))},t.prototype.emit=function(t,e){(this.listeners[t]||[]).forEach((function(t){t(e)}))},t}(),vA=function(t){function r(){return null!==t&&t.apply(this,arguments)||this}return e(r,t),r}(dA),yA=function(t){function i(e,r,n,i){void 0===i&&(i=null);var o=t.call(this)||this;return o.eventDispatcher=e,o.flushInterval=n,o.queue=new hA(o.drainQueue.bind(o),r,n),o.repository=i,o}return e(i,t),i.prototype.isClientError=function(t){return!!(t&&t.statusCode>=400&&t.statusCode<500)},i.prototype.drainRepository=function(t){var e=this;return new Promise((function(i){return r(e,void 0,void 0,(function(){var e,r,o=this;return n(this,(function(n){switch(n.label){case 0:return[4,null===(r=this.repository)||void 0===r?void 0:r.read()];case 1:return(e=n.sent())&&0!==e.length?(t?this.eventDispatcher.dispatchXhrOrBeacon(e,(function(){var t;i(null===(t=o.repository)||void 0===t?void 0:t.delete(e))}),(function(t){var r;o.isClientError(t)?i(null===(r=o.repository)||void 0===r?void 0:r.delete(e)):i()})):this.eventDispatcher.dispatch(e,(function(){var t;i(null===(t=o.repository)||void 0===t?void 0:t.delete(e))}),(function(t){var r;o.isClientError(t)?i(null===(r=o.repository)||void 0===r?void 0:r.delete(e)):i()})),[2]):(i(),[2])}}))}))}))},i.prototype.drainQueue=function(t,e){var i=this,o=t.map((function(t){return t.toDto()})),s=new Promise((function(s){return r(i,void 0,void 0,(function(){var r,i=this;return n(this,(function(){return 0===t.length?(s(),[2]):(e?(null===(r=this.repository)||void 0===r||r.add(o),this.eventDispatcher.dispatchXhrOrBeacon(t,(function(){var t;s(null===(t=i.repository)||void 0===t?void 0:t.delete(o))}),(function(t){var e;i.isClientError(t)?s(null===(e=i.repository)||void 0===e?void 0:e.delete(o)):s()}))):this.eventDispatcher.dispatch(t,(function(){s()}),(function(t){var e;i.isClientError(t)?s():s(null===(e=i.repository)||void 0===e?void 0:e.add(o))})),[2])}))}))}));return s},i.prototype.process=function(t){this.queue.enqueue(t),this.emit("event",t)},i.prototype.start=function(){return r(this,void 0,void 0,(function(){return n(this,(function(){return this.queue.start(),[2]}))}))},i.prototype.stop=function(){try{this.queue.close()}catch(t){}return Promise.resolve()},i.prototype.flush=function(){this.queue.flush()},i.prototype.close=function(){this.stop()},i}(vA),mA=function(){function t(t,e){this.hackleUserResolver=t,this.core=e}return t.isSessionEvent=function(e){return!!dr.isTrack(e)&&(e.event.key===t.SESSION_START_EVENT_NAME||e.event.key===t.SESSION_END_EVENT_NAME)},t.prototype.onSessionStarted=function(e,r,n){this.track(t.SESSION_START_EVENT_NAME,e,r,n)},t.prototype.onSessionEnded=function(e,r,n){this.track(t.SESSION_END_EVENT_NAME,e,r,n)},t.prototype.track=function(t,e,r,n){var i={key:t,properties:{sessionId:e}},o=this.hackleUserResolver.resolve(r),s=this.decorateSession(o,e);this.core.track(i,s,n)},t.prototype.decorateSession=function(t,e){var r=(new _t).add(Tt.SESSION,e).addIdentifiers(t.identifiers).build();return U(U({},t),{identifiers:r})},t.SESSION_START_EVENT_NAME="$session_start",t.SESSION_END_EVENT_NAME="$session_end",t}(),gA=function(t){function r(e,r,n,i,o,s,u){void 0===i&&(i=null);var a=t.call(this,e,r,n,i)||this;return a.exposureEventDedupDeterminer=o,a.sessionManager=s,a.userManager=u,a}return e(r,t),r.prototype.process=function(e){if(mA.isSessionEvent(e)||this.sessionManager.startNewSessionIfNeeded(this.userManager.currentUser,e.timestamp),!this.exposureEventDedupDeterminer.isDedupTarget(e)){var r=function(t,e){var r;return null===e.currentSessionId||t.user.identifiers[Tt.SESSION]?t:t.copyWithUser(U(U({},t.user),{identifiers:U(U({},t.user.identifiers),(r={},r[Tt.SESSION]=e.sessionId,r))}))}(e,this.sessionManager);t.prototype.process.call(this,r)}},r}(yA),EA=function(){function t(t){this.cache=new Map,this.exposureEventDedupIntervalMillis=t}return t.prototype.isDedupTarget=function(t){var e;if(-1===this.exposureEventDedupIntervalMillis)return!1;if(!dr.isExposure(t))return!1;rt.isEquals(t.user.identifiers,null===(e=this.currentUser)||void 0===e?void 0:e.identifiers)||(this.currentUser=t.user,this.cache=new Map);var r=[t.experiment.id,t.variationId,t.variationKey,t.decisionReason].join("-"),n=(new Date).getTime(),i=this.cache.get(r);return void 0!==i&&n-i<=this.exposureEventDedupIntervalMillis||(this.cache.set(r,n),!1)},t}(),wA=function(){function t(){}return t.toEvent=function(e){var r;return{key:t.EVENT_KEY,properties:{level:t.LEVEL_ERROR,type:e.name,message:null!==(r=e.message)&&void 0!==r?r:"",$stacktrace:t._stacktrace(e)}}},t._stacktrace=function(e){return k.isNullOrUndefined(e.stack)?"":e.stack.split("\n").slice(0,t.STACK_TRACK_LIMIT).join("\n")},t.EVENT_KEY="$trace",t.LEVEL_ERROR="error",t.STACK_TRACK_LIMIT=30,t}(),TA=function(){function t(){}return t.prototype.evaluate=function(t,e){if(!this.supports(t))throw new Error("Unsupported EvaluatorRequest ".concat(t.toString()));if(e.contains(t)){var r=e.stack.map((function(t){return t.toString()})).join(" - ");throw new Error("Circular evaluation has occurred [".concat(r," - ").concat(t.toString(),"]"))}e.addRequest(t);try{return this.evaluateInternal(t,e)}finally{e.removeRequest(t)}},t}(),_A=function(){function t(t,e,r,n,i,o){this.reason=t,this.targetEvaluations=e,this.experiment=r,this.variationId=n,this.variationKey=i,this.config=o}return t.prototype.with=function(e){return new t(e,this.targetEvaluations,this.experiment,this.variationId,this.variationKey,this.config)},t.of=function(e,r,n,i){var o=this.config(e.workspace,n);return new t(i,r.targetEvaluations,e.experiment,n.id,n.key,o)},t.ofDefault=function(e,r,n){var i=e.experiment._getVariationByKeyOrNull(e.defaultVariationKey);return k.isNotNullOrUndefined(i)?this.of(e,r,i,n):new t(n,r.targetEvaluations,e.experiment,void 0,e.defaultVariationKey,void 0)},t.config=function(t,e){if(!k.isNullOrUndefined(e.parameterConfigurationId))return k.requiredNotNullOrUndefined(t.getParameterConfigurationOrNull(e.parameterConfigurationId),(function(){return"ParameterConfiguration[".concat(e.parameterConfigurationId,"]")}))},t}(),IA=function(t){function r(e){var r=t.call(this)||this;return r.evaluationFlowFactory=e,r}return e(r,t),r.prototype.supports=function(t){return void 0!==t.experiment},r.prototype.evaluateInternal=function(t,e){var r;return null!==(r=this.evaluationFlowFactory.getExperimentFlow(t.experiment.type).evaluate(t,e))&&void 0!==r?r:_A.ofDefault(t,e,vt.TRAFFIC_NOT_ALLOCATED)},r}(TA),AA=function(){function t(t,e,r,n,i,o){this.reason=t,this.targetEvaluations=e,this.parameter=r,this.valueId=n,this.value=i,this.properties=o}return t.of=function(e,r,n,i,o,s){return s.returnValue=i,new t(o,r.targetEvaluations,e.parameter,n,i,s)},t.ofDefault=function(t,e,r,n){return this.of(t,e,void 0,t.defaultValue,r,n)},t}(),NA=function(t){function r(e){var r=t.call(this)||this;return r.targetRuleDeterminer=e,r}return e(r,t),r.prototype.supports=function(t){return void 0!==t.parameter},r.prototype.evaluateInternal=function(t,e){var r={};if(r.requestValueType=t.requiredType,r.requestDefaultValue=t.defaultValue,k.isNullOrUndefined(t.user.identifiers[t.parameter.identifierType]))return AA.ofDefault(t,e,vt.IDENTIFIER_NOT_FOUND,r);var n=this.targetRuleDeterminer.determineTargetRuleOrNull(t,e);return k.isNotNullOrUndefined(n)?(r.targetRuleKey=n.key,r.targetRuleName=n.name,this.evaluation(t,e,n.value,vt.TARGET_RULE_MATCH,r)):this.evaluation(t,e,t.parameter.defaultValue,vt.DEFAULT_RULE,r)},r.prototype.evaluation=function(t,e,r,n,i){return"UNKNOWN"===t.requiredType||"NULL"!==t.requiredType&&typeof t.defaultValue!=typeof r.rawValue?AA.ofDefault(t,e,vt.TYPE_MISMATCH,i):AA.of(t,e,r.id,r.rawValue,n,i)},r}(TA),OA=function(){function t(t,e){this.type=t,this.id=e}return t.prototype.isEquals=function(t){return this.type===t.type&&this.id===t.id},t}(),bA=function(){function t(){this._stack=[],this._targetEvaluations=[]}return t.create=function(){return new t},Object.defineProperty(t.prototype,"stack",{get:function(){return Array.from(this._stack)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"targetEvaluations",{get:function(){return Array.from(this._targetEvaluations)},enumerable:!1,configurable:!0}),t.prototype.contains=function(t){return this._stack.some((function(e){return e.key.isEquals(t.key)}))},t.prototype.addRequest=function(t){this._stack.push(t)},t.prototype.removeRequest=function(t){var e=this._stack.indexOf(t,0);e>-1&&this._stack.splice(e,1)},t.prototype.get=function(t){return this._targetEvaluations.find((function(e){return e instanceof _A&&e.experiment.id===t.id}))},t.prototype.addEvaluation=function(t){this._targetEvaluations.push(t)},t}(),RA=function(){function t(t,e,r,n){this.key=new OA("EXPERIMENT",r.id),this.workspace=t,this.user=e,this.experiment=r,this.defaultVariationKey=n}return t.of=function(e,r,n,i){return new t(e,r,n,i)},t.by=function(e,r){return new t(e.workspace,e.user,r,"A")},t.prototype.toString=function(){return"EvaluatorRequest(type=".concat(this.experiment.type,", key=").concat(this.experiment.key,")")},t}(),SA=function(){function t(t,e,r,n,i){this.key=new OA("REMOTE_CONFIG",r.id),this.workspace=t,this.user=e,this.parameter=r,this.requiredType=n,this.defaultValue=i}return t.of=function(e,r,n,i,o){return new t(e,r,n,i,o)},t.prototype.toString=function(){return"EvaluatorRequest(type=".concat(this.key.type,", key=").concat(this.parameter.key,")")},t}(),MA=function(){function t(){}return t.asString=function(t){switch(typeof t){case"string":return t;case"number":return t.toString();default:return}},t.asNumber=function(t){switch(typeof t){case"number":return this.asActualNumber(t);case"string":return this.asActualNumber(Number(t));default:return}},t.asActualNumber=function(t){return!isNaN(t)&&isFinite(t)?t:void 0},t}(),CA=function(){function t(t){this.storages=t}return t.prototype.getVariation=function(t,e){if(0!==this.storages.length)for(var r=0,n=this.storages;r<n.length;r++){var i=n[r].getVariation(t,e);if(void 0!==i)return i}},t}(),xA=function(){function t(t){this.listStorage=t}return t.prototype.getVariation=function(t){var e=this.get(t);if(e)return t._getVariationByIdOrNull(e)},t.prototype.get=function(t){var e=this.listStorage.getItem(t.id.toString());return MA.asNumber(e)},t.prototype.getAll=function(){var t=new Map;return this.listStorage.entries().forEach((function(e){var r=e[0],n=e[1],i=MA.asNumber(r),o=MA.asNumber(n);k.isNullOrUndefined(i)||i<0||k.isNullOrUndefined(o)||i<0||t.set(i,o)})),t},t.prototype.set=function(t,e){this.listStorage.setItem(t.id.toString(),e.toString())},t.prototype.remove=function(t){this.listStorage.removeItem(t.id.toString())},t.prototype.clear=function(){this.listStorage.clear()},t}(),PA=function(){function t(){this.evaluators=new Array}return t.prototype.add=function(t){this.evaluators.push(t)},t.prototype.evaluate=function(t,e){var r=this.evaluators.find((function(e){return e.supports(t)}));if(k.isNullOrUndefined(r))throw new Error("Unsupported EvaluatorRequest [".concat(t.toString(),"]"));return r.evaluate(t,e)},t}(),UA=function(){function t(t){this.conditionMatcherFactory=t}return t.prototype.matches=function(t,e,r){var n=this;return r.conditions.every((function(r){return n._matches(t,e,r)}))},t.prototype.anyMatches=function(t,e,r){var n=this;return!r.length||r.some((function(r){return n.matches(t,e,r)}))},t.prototype._matches=function(t,e,r){return this.conditionMatcherFactory.getMatcher(r.key.type).matches(t,e,r)},t}(),kA=function(){function t(t,e){this.valueMatcherFactory=t,this.operatorMatcherFactory=e}return t.prototype.matches=function(t,e){var r=this.valueMatcherFactory.getMatcher(e.valueType),n=this.operatorMatcherFactory.getMatcher(e.operator),i=this.userValueMatches(t,e,r,n);return this.typeMatches(e.type,i)},t.prototype.userValueMatches=function(t,e,r,n){return Array.isArray(t)?this.arrayMatches(t,e,r,n):this.singleMatches(t,e,r,n)},t.prototype.singleMatches=function(t,e,r,n){return e.values.some((function(e){return r.matches(n,t,e)}))},t.prototype.arrayMatches=function(t,e,r,n){var i=this;return t.some((function(t){return i.singleMatches(t,e,r,n)}))},t.prototype.typeMatches=function(t,e){switch(t){case"MATCH":return e;case"NOT_MATCH":return!e}},t}(),DA=function(){function t(){}return t.prototype.booleanMatches=function(t,e){return t===e},t.prototype.numberMatches=function(t,e){return t===e},t.prototype.stringMatches=function(t,e){return t===e},t.prototype.versionMatches=function(t,e){return t.isEqualTo(e)},t}(),LA=function(){function t(){}return t.prototype.booleanMatches=function(){return!1},t.prototype.numberMatches=function(){return!1},t.prototype.stringMatches=function(t,e){return t.includes(e)},t.prototype.versionMatches=function(){return!1},t}(),FA=function(){function t(){}return t.prototype.booleanMatches=function(){return!1},t.prototype.numberMatches=function(){return!1},t.prototype.stringMatches=function(t,e){return t.startsWith(e)},t.prototype.versionMatches=function(){return!1},t}(),VA=function(){function t(){}return t.prototype.booleanMatches=function(){return!1},t.prototype.numberMatches=function(){return!1},t.prototype.stringMatches=function(t,e){return t.endsWith(e)},t.prototype.versionMatches=function(){return!1},t}(),jA=function(){function t(){}return t.prototype.booleanMatches=function(){return!1},t.prototype.numberMatches=function(t,e){return t>e},t.prototype.stringMatches=function(t,e){return t>e},t.prototype.versionMatches=function(t,e){return t.isGreaterThan(e)},t}(),GA=function(){function t(){}return t.prototype.booleanMatches=function(){return!1},t.prototype.numberMatches=function(t,e){return t>=e},t.prototype.stringMatches=function(t,e){return t>=e},t.prototype.versionMatches=function(t,e){return t.isGreaterThanOrEqualTo(e)},t}(),BA=function(){function t(){}return t.prototype.booleanMatches=function(){return!1},t.prototype.numberMatches=function(t,e){return t<e},t.prototype.stringMatches=function(t,e){return t<e},t.prototype.versionMatches=function(t,e){return t.isLessThan(e)},t}(),HA=function(){function t(){}return t.prototype.booleanMatches=function(){return!1},t.prototype.numberMatches=function(t,e){return t<=e},t.prototype.stringMatches=function(t,e){return t<=e},t.prototype.versionMatches=function(t,e){return t.isLessThanOrEqualTo(e)},t}(),KA=function(){function t(){}return t.prototype.getMatcher=function(e){switch(e){case"IN":return t.IN_MATCHER;case"CONTAINS":return t.CONTAINS_MATCHER;case"STARTS_WITH":return t.STARTS_WITH_MATCHER;case"ENDS_WITH":return t.ENDS_WITH_MATCHER;case"GT":return t.GT_MATCHER;case"GTE":return t.GTE_MATCHER;case"LT":return t.LT_MATCHER;case"LTE":return t.LTE_MATCHER}},t.IN_MATCHER=new DA,t.CONTAINS_MATCHER=new LA,t.STARTS_WITH_MATCHER=new FA,t.ENDS_WITH_MATCHER=new VA,t.GT_MATCHER=new jA,t.GTE_MATCHER=new GA,t.LT_MATCHER=new BA,t.LTE_MATCHER=new HA,t}(),zA=function(){function t(){}return t.prototype.matches=function(t,e,r){var n=MA.asString(e),i=MA.asString(r);return!k.isNullOrUndefined(n)&&!k.isNullOrUndefined(i)&&t.stringMatches(n,i)},t}(),JA=function(){function t(){}return t.prototype.matches=function(t,e,r){var n=MA.asNumber(e),i=MA.asNumber(r);return!k.isNullOrUndefined(n)&&!k.isNullOrUndefined(i)&&t.numberMatches(n,i)},t}(),qA=function(){function t(){}return t.prototype.matches=function(t,e,r){return"boolean"==typeof e&&"boolean"==typeof r&&t.booleanMatches(e,r)},t}(),YA=function(){function t(){}return t.prototype.matches=function(t,e,r){var n=Lt.tryParse(e),i=Lt.tryParse(r);return!(!n||!i)&&t.versionMatches(n,i)},t}(),XA=function(){function t(){}return t.prototype.matches=function(){return!1},t}(),WA=function(){function t(){}return t.prototype.getMatcher=function(e){switch(e){case"STRING":case"JSON":return t.STRING_MATCHER;case"NUMBER":return t.NUMBER_MATCHER;case"BOOLEAN":return t.BOOLEAN_MATCHER;case"VERSION":return t.VERSION_MATCHER;case"NULL":case"UNKNOWN":return t.NULL_MATCHER}},t.STRING_MATCHER=new zA,t.NUMBER_MATCHER=new JA,t.BOOLEAN_MATCHER=new qA,t.VERSION_MATCHER=new YA,t.NULL_MATCHER=new XA,t}(),$A=function(){function t(t,e){this.userValueResolver=t,this.valueOperatorMatcher=e}return t.prototype.matches=function(t,e,r){var n=this.userValueResolver.resolveOrNull(t.user,r.key);return!k.isNullOrUndefined(n)&&this.valueOperatorMatcher.matches(n,r.match)},t}(),ZA=function(){function t(){}return t.prototype.resolveOrNull=function(t,e){switch(e.type){case"USER_ID":return t.identifiers[e.name];case"USER_PROPERTY":return t.properties[e.name];case"HACKLE_PROPERTY":return t.hackleProperties[e.name];case"SEGMENT":case"AB_TEST":case"FEATURE_FLAG":case"EVENT_PROPERTY":throw new Error("Unsupported TargetKeyType [".concat(e.type,"]"))}},t}(),QA=function(){function t(t){this.segmentMatcher=t}return t.prototype.matches=function(t,e,r){var n=this;if("SEGMENT"!=r.key.type)throw new Error("Unsupported TargetKeyType [".concat(r.key.type,"]"));var i=r.match.values.some((function(r){return n._matches(t,e,r)}));switch(r.match.type){case"MATCH":return i;case"NOT_MATCH":return!i}},t.prototype._matches=function(t,e,r){if("string"!=typeof r)throw new Error("SegmentKey[".concat(r,"]"));var n=t.workspace.getSegmentOrNull(r);if(!n)throw new Error("Segment[".concat(r,"]"));return this.segmentMatcher.matches(t,e,n)},t}(),tN=function(){function t(t){this.userConditionMatcher=t}return t.prototype.matches=function(t,e,r){var n=this;return r.targets.some((function(r){return n._matches(t,e,r)}))},t.prototype._matches=function(t,e,r){var n=this;return r.conditions.every((function(r){return n.userConditionMatcher.matches(t,e,r)}))},t}(),eN=function(){function t(t,e){this.abTestMatcher=t,this.featureFlagMatcher=e}return t.prototype.matches=function(t,e,r){switch(r.key.type){case"AB_TEST":return this.abTestMatcher.matches(t,e,r);case"FEATURE_FLAG":return this.featureFlagMatcher.matches(t,e,r);case"USER_ID":case"USER_PROPERTY":case"HACKLE_PROPERTY":case"EVENT_PROPERTY":case"SEGMENT":throw new Error("Unsupported TargetKeyType [".concat(r.key.type,"]"))}},t}(),rN=function(){function t(t,e){this.evaluator=t,this.valueOperatorMatcher=e}return t.prototype.matches=function(t,e,r){var n,i=k.requiredNotNullOrUndefined(MA.asNumber(r.key.name),(function(){return"Invalid key [".concat(r.key.type,", ").concat(r.key.name,"]")})),o=this.experiment(t,i);if(k.isNullOrUndefined(o))return!1;var s=null!==(n=e.get(o))&&void 0!==n?n:this.evaluate(t,e,o);return this.evaluationMatches(s,r)},t.prototype.evaluate=function(t,e,r){var n=RA.by(t,r),i=this.evaluator.evaluate(n,e),o=this.resolve(t,i);return e.addEvaluation(o),o},t}(),nN=function(t){function r(e,r){return t.call(this,e,r)||this}return e(r,t),r.prototype.experiment=function(t,e){
return t.workspace.getExperimentOrNull(e)},r.prototype.resolve=function(t,e){return t instanceof RA&&e.reason===vt.TRAFFIC_ALLOCATED?e.with(vt.TRAFFIC_ALLOCATED_BY_TARGETING):e},r.prototype.evaluationMatches=function(t,e){return!!r.AB_TEST_MATCHED_REASONS.includes(t.reason)&&this.valueOperatorMatcher.matches(t.variationKey,e.match)},r.AB_TEST_MATCHED_REASONS=[vt.OVERRIDDEN,vt.TRAFFIC_ALLOCATED,vt.EXPERIMENT_COMPLETED,vt.TRAFFIC_ALLOCATED_BY_TARGETING],r}(rN),iN=function(t){function r(e,r){return t.call(this,e,r)||this}return e(r,t),r.prototype.experiment=function(t,e){return t.workspace.getFeatureFlagOrNull(e)},r.prototype.resolve=function(t,e){return e},r.prototype.evaluationMatches=function(t,e){var r="A"!==t.variationKey;return this.valueOperatorMatcher.matches(r,e.match)},r}(rN),oN=function(){function t(t,e){this.eventValueResolver=t,this.valueOperatorMatcher=e}return t.prototype.matches=function(t,e,r){if(!this.isEventEvaluatorRequest(t))return!1;var n=this.eventValueResolver.resolveOrNull(t.event,r.key);return!k.isNullOrUndefined(n)&&this.valueOperatorMatcher.matches(n,r.match)},t.prototype.isEventEvaluatorRequest=function(t){return void 0!==t.event},t}(),sN=function(){function t(){}return t.prototype.resolveOrNull=function(t,e){var r;switch(e.type){case"EVENT_PROPERTY":return null===(r=this.properties(t))||void 0===r?void 0:r[e.name];case"USER_ID":case"USER_PROPERTY":case"HACKLE_PROPERTY":case"SEGMENT":case"AB_TEST":case"FEATURE_FLAG":throw new Error("Unsupported TargetKeyType [".concat(e.type,"]"))}},t.prototype.properties=function(t){return dr.isTrack(t)?t.event.properties:dr.isExposure(t)||dr.isRemoteConfig(t)?t.properties:void 0},t}(),uN=function(){function t(t){var e=new kA(new WA,new KA);this.userConditionMatcher=new $A(new ZA,e),this.eventConditionMatcher=new oN(new sN,e),this.segmentConditionMatcher=new QA(new tN(this.userConditionMatcher)),this.experimentConditionMatcher=new eN(new nN(t,e),new iN(t,e))}return t.prototype.getMatcher=function(t){switch(t){case"USER_ID":case"USER_PROPERTY":case"HACKLE_PROPERTY":return this.userConditionMatcher;case"EVENT_PROPERTY":return this.eventConditionMatcher;case"SEGMENT":return this.segmentConditionMatcher;case"AB_TEST":case"FEATURE_FLAG":return this.experimentConditionMatcher}},t}(),aN=function(){function t(t){this.bucketer=t}return t.prototype.resolveOrNull=function(t,e,r){switch(r.type){case"VARIATION":return this.resolveVariation(t,r);case"BUCKET":return this.resolveBucket(t,r)}},t.prototype.resolveVariation=function(t,e){return t.experiment._getVariationByIdOrNull(e.variationId)},t.prototype.resolveBucket=function(t,e){var r=t.workspace.getBucketOrNull(e.bucketId),n=t.user.identifiers[t.experiment.identifierType];if(n){var i=this.bucketer.bucketing(r,n);if(i)return t.experiment._getVariationByIdOrNull(i.variationId)}},t}(),cN={murmurhash3_x86_32:function(t,e,r,n){void 0===n&&(n=t.length);for(var i,o=3432918353,s=461845907,u=-4&n,a=e,c=0;c<u;c+=4)i=255&t.charCodeAt(c)|(255&t.charCodeAt(c+1))<<8|(255&t.charCodeAt(c+2))<<16|(255&t.charCodeAt(c+3))<<24,i=(131071&(i=this.mul32(i,o)))<<15|i>>>17,a=5*(a=(524287&(a^=i=this.mul32(i,s)))<<13|a>>>19)+3864292196|0;switch(i=0,n%4){case 3:i=(255&t.charCodeAt(u+2))<<16;case 2:i|=(255&t.charCodeAt(u+1))<<8;case 1:i|=255&t.charCodeAt(u),i=(131071&(i=this.mul32(i,o)))<<15|i>>>17,a^=i=this.mul32(i,s)}return a^=n,a^=a>>>16,a=this.mul32(a,2246822507),a^=a>>>13,(a=this.mul32(a,3266489909))^a>>>16},mul32:function(t,e){var r=65535&e;return((e-r)*t|0)+(r*t|0)|0}},fN=function(){function t(){}return t.prototype.bucketing=function(t,e){var r=this.calculateSlotNumber(t.seed,t.slotSize,e);return t.slots.find((function(t){return t.contains(r)}))},t.prototype.calculateSlotNumber=function(t,e,r){var n=cN.murmurhash3_x86_32(r,t);return Math.abs(n)%Math.abs(e)},t}(),pN=function(){function t(t,e){this.flowEvaluator=t,this.nextFlow=e}return t.prototype.evaluate=function(t,e){return this.flowEvaluator&&this.nextFlow?this.flowEvaluator.evaluate(t,e,this.nextFlow):void 0},t.end=function(){return new t(void 0,void 0)},t.decision=function(e,r){return new t(e,r)},t.of=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var r=this.end(),n=0,i=t.reverse();n<i.length;n++){var o=i[n];r=this.decision(o,r)}return r},t}(),lN=function(){function t(t){this.overrideResolver=t}return t.prototype.evaluate=function(t,e,r){var n=this.overrideResolver.resolveOrNull(t,e);if(!n)return r.evaluate(t,e);switch(t.experiment.type){case"AB_TEST":return _A.of(t,e,n,vt.OVERRIDDEN);case"FEATURE_FLAG":return _A.of(t,e,n,vt.INDIVIDUAL_TARGET_MATCH)}},t}(),hN=function(){function t(){}return t.prototype.evaluate=function(t,e,r){return"DRAFT"===t.experiment.status?_A.ofDefault(t,e,vt.EXPERIMENT_DRAFT):r.evaluate(t,e)},t}(),dN=function(){function t(){}return t.prototype.evaluate=function(t,e,r){if("PAUSED"!==t.experiment.status)return r.evaluate(t,e);switch(t.experiment.type){case"AB_TEST":return _A.ofDefault(t,e,vt.EXPERIMENT_PAUSED);case"FEATURE_FLAG":return _A.ofDefault(t,e,vt.FEATURE_FLAG_INACTIVE)}},t}(),vN=function(){function t(){}return t.prototype.evaluate=function(t,e,r){if("COMPLETED"===t.experiment.status){var n=t.experiment._winnerVariationOrNull();if(!n)throw new Error("winner variation [".concat(t.experiment.id,"]"));return _A.of(t,e,n,vt.EXPERIMENT_COMPLETED)}return r.evaluate(t,e)},t}(),yN=function(){function t(t){this.experimentTargetDeterminer=t}return t.prototype.evaluate=function(t,e,r){if("AB_TEST"!==t.experiment.type)throw new Error("experiment type must be AB_TEST [".concat(t.experiment.id,"]"));return this.experimentTargetDeterminer.isUserInExperimentTarget(t,e)?r.evaluate(t,e):_A.ofDefault(t,e,vt.NOT_IN_EXPERIMENT_TARGET)},t}(),mN=function(){function t(t){this.actionResolver=t}return t.prototype.evaluate=function(t,e){if("RUNNING"!==t.experiment.status)throw new Error("experiment status must be RUNNING [".concat(t.experiment.id,"]"));if("AB_TEST"!==t.experiment.type)throw new Error("experiment type must be AB_TEST [".concat(t.experiment.id,"]"));var r=this.actionResolver.resolveOrNull(t,e,t.experiment.defaultRule);return r?r.isDropped?_A.ofDefault(t,e,vt.VARIATION_DROPPED):_A.of(t,e,r,vt.TRAFFIC_ALLOCATED):_A.ofDefault(t,e,vt.TRAFFIC_NOT_ALLOCATED)},t}(),gN=function(){function t(t,e){this.targetRuleDeterminer=t,this.actionResolver=e}return t.prototype.evaluate=function(t,e,r){if("RUNNING"!==t.experiment.status)throw new Error("experiment status must be RUNNING [".concat(t.experiment.id,"]"));if("FEATURE_FLAG"!==t.experiment.type)throw new Error("experiment type must be FEATURE_FLAG [".concat(t.experiment.id,"]"));if(!t.user.identifiers[t.experiment.identifierType])return r.evaluate(t,e);var n=this.targetRuleDeterminer.determineTargetRuleOrNull(t,e);if(!n)return r.evaluate(t,e);var i=this.actionResolver.resolveOrNull(t,e,n.action);if(!i)throw new Error("FeatureFlag must decide the Variation [".concat(t.experiment.id,"]"));return _A.of(t,e,i,vt.TARGET_RULE_MATCH)},t}(),EN=function(){function t(t){this.actionResolver=t}return t.prototype.evaluate=function(t,e){if("RUNNING"!==t.experiment.status)throw new Error("experiment status must be RUNNING [".concat(t.experiment.id,"]"));if("FEATURE_FLAG"!==t.experiment.type)throw new Error("experiment type must be FEATURE_FLAG [".concat(t.experiment.id,"]"));if(!t.user.identifiers[t.experiment.identifierType])return _A.ofDefault(t,e,vt.DEFAULT_RULE);var r=this.actionResolver.resolveOrNull(t,e,t.experiment.defaultRule);if(!r)throw new Error("FeatureFlag must decide the Variation [".concat(t.experiment.id,"]"));return _A.of(t,e,r,vt.DEFAULT_RULE)},t}(),wN=function(){function t(t){this.containerResolver=t}return t.prototype.evaluate=function(t,e,r){var n=t.experiment.containerId;if(!n)return r.evaluate(t,e);var i=t.workspace.getContainerOrNull(n);if(!i)throw new Error("container[".concat(n,"]"));return this.containerResolver.isUserInContainerGroup(t,e,i)?r.evaluate(t,e):_A.ofDefault(t,e,vt.NOT_IN_MUTUAL_EXCLUSION_EXPERIMENT)},t}(),TN=function(){function t(){}return t.prototype.evaluate=function(t,e,r){return t.user.identifiers[t.experiment.identifierType]?r.evaluate(t,e):_A.ofDefault(t,e,vt.IDENTIFIER_NOT_FOUND)},t}(),_N=function(){function t(t){this.targetMatcher=t}return t.prototype.isUserInExperimentTarget=function(t,e){var r=this;return 0===t.experiment.targetAudiences.length||t.experiment.targetAudiences.some((function(n){return r.targetMatcher.matches(t,e,n)}))},t}(),IN=function(){function t(t){this.targetMatcher=t}return t.prototype.determineTargetRuleOrNull=function(t,e){var r=this;return t.experiment.targetRules.find((function(n){return r.targetMatcher.matches(t,e,n.target)}))},t}(),AN=function(){function t(t,e,r){this.manualOverrideStorage=t,this.targetMatcher=e,this.actionResolver=r}return t.prototype.resolveOrNull=function(t,e){var r,n;return null!==(n=null!==(r=this.resolveManualOverride(t))&&void 0!==r?r:this._resolveUserOverride(t))&&void 0!==n?n:this._resolveSegmentOverride(t,e)},t.prototype.resolveManualOverride=function(t){return this.manualOverrideStorage.getVariation(t.experiment,t.user)},t.prototype._resolveUserOverride=function(t){var e=t.experiment,r=t.user.identifiers[e.identifierType];if(r){var n=e.userOverrides.get(r);if(n)return e._getVariationByIdOrNull(n)}},t.prototype._resolveSegmentOverride=function(t,e){var r=this,n=t.experiment.segmentOverrides.find((function(n){return r.targetMatcher.matches(t,e,n.target)}));if(n)return this.actionResolver.resolveOrNull(t,e,n.action)},t}(),NN=function(){function t(t){this.bucketer=t}return t.prototype.isUserInContainerGroup=function(t,e,r){var n=t.user.identifiers[t.experiment.identifierType];if(k.isNullOrUndefined(n))return!1;var i=t.workspace.getBucketOrNull(r.bucketId);if(k.isNullOrUndefined(i))throw new Error("Bucket[".concat(r.bucketId,"]"));var o=this.bucketer.bucketing(i,n);if(k.isNullOrUndefined(o))return!1;var s=r.getGroupOrNull(o.variationId);if(k.isNullOrUndefined(s))throw new Error("ContainerGroup[".concat(o.variationId,"]"));return s.experiments.includes(t.experiment.id)},t}(),ON=function(){function t(t,e,r,n){this.reason=t,this.targetEvaluations=e,this.inAppMessage=r,this.message=n}return t.of=function(e,r,n,i){return new t(n,r.targetEvaluations,e.inAppMessage,i)},t}(),bN=function(){function t(){}return t.prototype.evaluate=function(t,e,r){return t.inAppMessage.supports("WEB")?r.evaluate(t,e):ON.of(t,e,vt.UNSUPPORTED_PLATFORM)},t}(),RN=function(){function t(t,e){this.userOverrideMatcher=t,this.inAppMessageResolver=e}return t.prototype.evaluate=function(t,e,r){if(this.userOverrideMatcher.matches(t,e)){var n=this.inAppMessageResolver.resolve(t,e);return ON.of(t,e,vt.OVERRIDDEN,n)}return r.evaluate(t,e)},t}(),SN=function(){function t(){}return t.prototype.evaluate=function(t,e,r){return"DRAFT"===t.inAppMessage.status?ON.of(t,e,vt.IN_APP_MESSAGE_DRAFT):r.evaluate(t,e)},t}(),MN=function(){function t(){}return t.prototype.evaluate=function(t,e,r){return"PAUSE"===t.inAppMessage.status?ON.of(t,e,vt.IN_APP_MESSAGE_PAUSED):r.evaluate(t,e)},t}(),CN=function(){function t(){}return t.prototype.evaluate=function(t,e,r){return t.inAppMessage.period.within(t.timestamp)?r.evaluate(t,e):ON.of(t,e,vt.NOT_IN_IN_APP_MESSAGE_PERIOD)},t}(),xN=function(){function t(t){this.hiddenMatcher=t}return t.prototype.evaluate=function(t,e,r){return this.hiddenMatcher.matches(t,e)?ON.of(t,e,vt.IN_APP_MESSAGE_HIDDEN):r.evaluate(t,e)},t}(),PN=function(){function t(t,e){this.targetMatcher=t,this.inAppMessageResolver=e}return t.prototype.evaluate=function(t,e){if(this.targetMatcher.matches(t,e)){var r=this.inAppMessageResolver.resolve(t,e);return ON.of(t,e,vt.IN_APP_MESSAGE_TARGET,r)}return ON.of(t,e,vt.NOT_IN_IN_APP_MESSAGE_TARGET)},t}(),UN=function(){function t(){}return t.prototype.resolve=function(t){var e=t.inAppMessage,r=e.messageContext.defaultLang,n=e.messageContext.messages.find((function(t){return t.lang===r}));if(k.isNullOrUndefined(n))throw new Error("InAppMessage must be decided [".concat(e.id,"]"));return n},t}(),kN=function(){function t(){}return t.prototype.matches=function(t){var e=this;return t.inAppMessage.targetContext.overrides.some((function(r){return e.isUserOverridden(t,r)}))},t.prototype.isUserOverridden=function(t,e){var r=t.user.identifiers[e.identifierType];return!k.isNullOrUndefined(r)&&e.identifiers.includes(r)},t}(),DN=function(){function t(t){this.targetMatcher=t}return t.prototype.matches=function(t,e){var r=this,n=t.inAppMessage.targetContext.targets;return 0===n.length||n.some((function(n){return r.targetMatcher.matches(t,e,n)}))},t}(),LN=function(){function t(t){this.storage=t}return t.prototype.matches=function(t){return this.storage.exist(t.inAppMessage,t.timestamp)},t}(),FN=function(){function t(t,e){this.targetMatcher=t,this.bucketer=e}return t.prototype.determineTargetRuleOrNull=function(t,e){var r=this;return t.parameter.targetRules.find((function(n){return r.matches(t,e,n)}))},t.prototype.matches=function(t,e,r){if(!this.targetMatcher.matches(t,e,r.target))return!1;var n=t.user.identifiers[t.parameter.identifierType];if(k.isNullOrUndefined(n))return!1;var i=t.workspace.getBucketOrNull(r.bucketId);if(k.isNullOrUndefined(i))throw new Error("bucket[".concat(r.bucketId,"]"));return k.isNotNullOrUndefined(this.bucketer.bucketing(i,n))},t}(),VN=function(){function t(){}return t.get=function(t){return k.requiredNotNullOrUndefined(this.getOrNull(t),(function(){return"Instance not registered [".concat(t,"]")}))},t.getOrNull=function(e){return t.instances.get(e)},t.register=function(e,r){return t.instances.set(e,r),r},t.instances=new Map,t}(),jN=function(){function t(t,e,r){var n=new fN,i=VN.register("targetMatcher",new UA(new uN(t))),o=new aN(n),s=new AN(e,i,o),u=new NN(n);this.abTestFlow=pN.of(new lN(s),new TN,new wN(u),new yN(new _N(i)),new hN,new dN,new vN,new mN(o)),this.featureFlagFlow=pN.of(new hN,new dN,new vN,new lN(s),new TN,new gN(new IN(i),o),new EN(o));var a=new UN;this.inAppMessageFlow=pN.of(new bN,new RN(new kN,a),new SN,new MN,new CN,new xN(new LN(r)),new PN(new DN(i),a)),this.remoteConfigParameterTargetRuleDeterminer=new FN(i,n)}return t.prototype.getExperimentFlow=function(t){switch(t){case"AB_TEST":return this.abTestFlow;case"FEATURE_FLAG":return this.featureFlagFlow}},t.prototype.getInAppMessageFlow=function(){return this.inAppMessageFlow},t}(),GN=function(){function t(t){this.clock=t}return t.prototype.create=function(e,r){var n=this,i=this.clock.currentMillis(),o=new Array,s=this.createEvent(e,r,i,{});return o.push(s),r.targetEvaluations.forEach((function(r){var s,u=((s={})[t.ROOT_TYPE]=e.key.type,s[t.ROOT_ID]=e.key.id,s),a=n.createEvent(e,r,i,u);o.push(a)})),o},t.prototype.createEvent=function(e,r,n,i){var o;if(r instanceof _A)return i[t.CONFIG_ID_PROPERTY_KEY]=null===(o=r.config)||void 0===o?void 0:o.id,dr.exposure(e.user,r,i,n);if(r instanceof AA)return dr.remoteConfig(e.user,r,U(U({},i),r.properties),n);throw new Error("Unsupported Evaluation [".concat(typeof r,"]"))},t.ROOT_TYPE="$targetingRootType",t.ROOT_ID="$targetingRootId",t.CONFIG_ID_PROPERTY_KEY="$parameterConfigurationId",t}(),BN=function(t){function r(e){var r=t.call(this)||this;return r.evaluationFlowFactory=e,r}return e(r,t),r.prototype.supports=function(t){return void 0!==t.inAppMessage},r.prototype.evaluateInternal=function(t,e){var r;return null!==(r=this.evaluationFlowFactory.getInAppMessageFlow().evaluate(t,e))&&void 0!==r?r:ON.of(t,e,vt.NOT_IN_IN_APP_MESSAGE_TARGET)},r}(TA),HN=function(){function t(t,e,r,n){this.key=new OA("IN_APP_MESSAGE",r.key),this.workspace=t,this.user=e,this.inAppMessage=r,this.timestamp=n}return t.of=function(e,r,n,i){return new t(e,r,n,i)},t.prototype.toString=function(){return"EvaluatorRequest(type=".concat(this.key.type,", key=").concat(this.inAppMessage.key,")")},t}(),KN=F.log,zN=function(){function t(t,e,r,n,i,o,s,u){this.experimentEvaluator=t,this.remoteConfigEvaluator=e,this.inAppMessageEvaluator=r,this.workspaceFetcher=n,this.eventFactory=i,this.eventProcessor=o,this.errorDedupDeterminer=s,this.clock=u,this.workspaceFetcher.start(),this.eventProcessor.start(),this.readyPromise=this.workspaceFetcher.onReady().then((function(){return{success:!0}}),(function(t){return{success:!1,error:t}}))}return t.create=function(e,r,n,i){var o=new PA,s=new CA(n),u=new jN(o,s,i),a=new IA(u),c=new NA(u.remoteConfigParameterTargetRuleDeterminer),f=new BN(u);return o.add(a),o.add(c),new t(a,c,f,e,new GN(ut.instance),r,new JN,ut.instance)},t.prototype.experiment=function(t,e,r){var n=this;if(!t)return KN.error("experimentKey must not be empty"),pt.of(r,vt.INVALID_INPUT);var i=this.workspaceFetcher.get();if(!i)return KN.warn("SDK not ready."),pt.of(r,vt.SDK_NOT_READY);var o=i.getExperimentOrNull(t);if(!o)return KN.warn("Experiment does not exist."),pt.of(r,vt.EXPERIMENT_NOT_FOUND);var s=RA.of(i,e,o,r),u=this.experimentInternal(s),a=u[0],c=u[1];return this.eventFactory.create(s,a).forEach((function(t){return n.eventProcessor.process(t)})),c},t.prototype.experiments=function(t){var e=this,r=new Pe((function(t,e){return t.id===e.id})),n=this.workspaceFetcher.get();return n?(n.getExperiments().forEach((function(i){var o=RA.of(n,t,i,"A"),s=e.experimentInternal(o);s[0];var u=s[1];r.add(i,u)})),r):r},t.prototype.experimentInternal=function(t){var e,r=this.experimentEvaluator.evaluate(t,bA.create()),n=null!==(e=r.config)&&void 0!==e?e:new dt;return[r,pt.of(r.variationKey,r.reason,n)]},t.prototype.featureFlag=function(t,e){var r=this;if(!t)return KN.error("featureKey must not be empty"),lt.off(vt.INVALID_INPUT);var n=this.workspaceFetcher.get();if(!n)return KN.warn("SDK not ready."),lt.off(vt.SDK_NOT_READY);var i=n.getFeatureFlagOrNull(t);if(!i)return KN.warn("FeatureFlag does not exist."),lt.off(vt.FEATURE_FLAG_NOT_FOUND);var o=RA.of(n,e,i,"A"),s=this.featureFlagInternal(o),u=s[0],a=s[1];return this.eventFactory.create(o,u).forEach((function(t){return r.eventProcessor.process(t)})),a},t.prototype.featureFlags=function(t){var e=this,r=new Pe((function(t,e){return t.id===e.id})),n=this.workspaceFetcher.get();return n?(n.getFeatureFlags().forEach((function(i){var o=RA.of(n,t,i,"A"),s=e.featureFlagInternal(o);s[0];var u=s[1];r.add(i,u)})),r):r},t.prototype.featureFlagInternal=function(t){var e,r=this.experimentEvaluator.evaluate(t,bA.create()),n=null!==(e=r.config)&&void 0!==e?e:new dt;return[r,"A"===r.variationKey?lt.off(r.reason,n):lt.on(r.reason,n)]},t.prototype.inAppMessage=function(t,e){var r=this.workspaceFetcher.get();if(!r)return KN.warn("SDK not ready."),ft.of(vt.SDK_NOT_READY);var n=r.getInAppMessageOrNull(t);if(!n)return KN.warn("In app message does not exist."),ft.of(vt.IN_APP_MESSAGE_NOT_FOUND);var i=HN.of(r,e,n,this.clock.currentMillis()),o=this.inAppMessageEvaluator.evaluate(i,bA.create());return ft.of(o.reason,o.inAppMessage,o.message)},t.prototype.tryInAppMessage=function(t,e){var r,n=Ie.start();try{r=this.inAppMessage(t,e)}catch(e){KN.error("Unexpected error while deciding in app message [".concat(t,"]: ").concat(e)),r=ft.of(vt.EXCEPTION)}return Je.inAppMessage(n,t,r),r},t.prototype.track=function(t,e,r){var n;if(void 0===r&&(r=(new Date).getTime()),t)if("object"==typeof t)if("object"!=typeof t||t.key&&"string"==typeof t.key){var i=(null===(n=this.workspaceFetcher.get())||void 0===n?void 0:n.getEventTypeOrNull(t.key))||new wt(0,t.key);this.eventProcessor.process(dr.track(i,t,e,r))}else KN.warn("Event key must be not null. or event key must be string type.");else KN.warn("Event must be event type.");else KN.warn("event must not be null.")},t.prototype.trackException=function(t,e){if(!this.errorDedupDeterminer.isDedupTarget(t)){var r=wA.toEvent(t);this.flush(),this.track(r,e),this.flush()}},t.prototype.flush=function(){this.eventProcessor.flush()},t.prototype.remoteConfig=function(t,e,r,n){var i=this,o=this.workspaceFetcher.get();if(k.isNullOrUndefined(o))return KN.warn("SDK not ready."),ct.of(n,vt.SDK_NOT_READY);var s=o.getRemoteConfigParameterOrNull(t);if(k.isNullOrUndefined(s))return KN.warn("Remote config parameter does not exist."),ct.of(n,vt.REMOTE_CONFIG_PARAMETER_NOT_FOUND);var u=SA.of(o,e,s,r,n),a=this.remoteConfigEvaluator.evaluate(u,bA.create());return this.eventFactory.create(u,a).forEach((function(t){return i.eventProcessor.process(t)})),ct.of(a.value,a.reason)},t.prototype.onReady=function(t,e){void 0===e&&(e=K),this.onInitialized({timeout:e}).then((function(){return t()}))},t.prototype.onInitialized=function(t){var e,r=t.timeout,n=void 0===r?K:r;KN.debug("Start HackleClient initializing");var i=new Promise((function(t){e=t})),o=setTimeout((function(){e({success:!1})}),n);return this.readyPromise.then((function(){clearTimeout(o),e({success:!0})}),(function(t){clearTimeout(o),e({success:!1,error:t})})),Promise.race([this.readyPromise,i]).then((function(t){return t.success?KN.debug("HackleClient onInitialized Success"):t.error instanceof Error?KN.error("HackleClient onInitialized Failed. ".concat(t.error.message)):KN.error("HackleClient onInitialized Failed. ".concat(t.error)),Promise.resolve({success:t.success})}))},t.prototype.close=function(){this.workspaceFetcher.close(),this.eventProcessor.close()},t}(),JN=function(){function t(){}return t.prototype.isDedupTarget=function(t){return!!this._isSameError(t,this.previous)||(this.previous=t,!1)},t.prototype._isSameError=function(t,e){return!k.isNullOrUndefined(e)&&t.name===e.name&&t.message===e.message&&t.stack===e.stack},t}(),qN=function(){function t(){this._installed=[],this._installations={onerror:S,onunhandledrejection:M}}return t.prototype.install=function(t,e){this._install("onerror",t,e),this._install("onunhandledrejection",t,e)},t.prototype._install=function(t,e,r){t in this._installed||((0,this._installations[t])(e,r),this._installed.push(t))},t}(),YN=null,XN=function(){function t(t,e,r){this.storage=t,this.storageKey=e,this.maxSize=r}return t.prototype.read=function(){var t=this;return new Promise((function(e){var r=t.storage.getItem(t.storageKey);r&&e(JSON.parse(r)),e([])}))},t.prototype.save=function(t){var e=this;return 0===t.length?this.clear():new Promise((function(r){var n=JSON.stringify(t.slice(-e.maxSize));e.storage.setItem(e.storageKey,n),r()}))},t.prototype.add=function(t){var e=this;return this.read().then((function(r){return e.save(r.concat(t).slice(-e.maxSize))}))},t.prototype.delete=function(t){var e=this;return this.read().then((function(r){var n=r.filter((function(e){return t.findIndex((function(t){return t.insertId===e.insertId}))<0}));return e.save(n)}))},t.prototype.clear=function(){var t=this;return new Promise((function(e){localStorage.removeItem(t.storageKey),e()}))},t}(),WN=function(t,e){return null!==t&&t.userId===e.userId&&t.deviceId===e.deviceId},$N=function(){function t(t,e,r,n){var i;void 0===r&&(r=null),void 0===n&&(n=null),this.storage=t,this.hackleDeviceId=e,this.userListeners=[],this.defaultUser={deviceId:this.hackleDeviceId},this._currentUser=null!==(i=null!=n?n:r)&&void 0!==i?i:this.defaultUser,this.storage.saveUser(this._currentUser)}return t.prototype.addListener=function(t){this.userListeners.push(t)},Object.defineProperty(t.prototype,"currentUser",{get:function(){return this._currentUser},enumerable:!1,configurable:!0}),t.prototype.resolveCurrentOrNull=function(t){if(void 0===t)return this.currentUser;if("string"==typeof t)return this.setUser({id:t});var e=It(t);return e?this.setUser(e):null},t.prototype.setUser=function(t){return this.updateUser(t)},t.prototype.setUserId=function(t){var e=U(U({},this._currentUser),{userId:t});return this.setUser(e)},t.prototype.setDeviceId=function(t){var e=U(U({},this._currentUser),{deviceId:t});return this.setUser(e)},t.prototype.updateUserProperties=function(t){return this.operateProperties(t)},t.prototype.resetUser=function(){return this.setUser(this.defaultUser)},t.prototype.changeUser=function(t,e,r){this.userListeners.forEach((function(n){n.onUserUpdated(t,e,r)}))},t.prototype.saveUser=function(t){this.storage.saveUser(t)},t.prototype.update=function(t){var e=this._currentUser,r=t(e);return this._currentUser=r,WN(e,r)||(this.changeUser(e,r,(new Date).getTime()),this.saveUser(r)),r},t.prototype.updateUser=function(t){return this.update((function(e){return WN(r=e,n=t)?U(U({},n),{properties:U(U({},r.properties),n.properties)}):n;var r,n}))},t.prototype.operateProperties=function(t){return this.update((function(e){var r,n=null!==(r=null==e?void 0:e.properties)&&void 0!==r?r:{},i=t.operate(new Map(Object.entries(n)));return U(U({},e),{properties:k.fromMap(i)})}))},t}(),ZN=function(){function t(t){this.storage=t}return t.prototype.getUser=function(){var t=this.deviceId||void 0,e=this.userId||void 0;return void 0!==t||void 0!==e?{deviceId:t,userId:e}:null},t.prototype.saveUser=function(t){this.setDeviceId(t.deviceId||null),this.setUserId(t.userId||null)},Object.defineProperty(t.prototype,"deviceId",{get:function(){return this.storage.getItem($)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"userId",{get:function(){return this.storage.getItem(W)},enumerable:!1,configurable:!0}),t.prototype.setDeviceId=function(t){this.setId($,t)},t.prototype.setUserId=function(t){this.setId(W,t)},t.prototype.setId=function(t,e){k.isNotNullOrUndefined(e)?this.storage.setItem(t,e):this.storage.removeItem(t)},t}(),QN=function(){function t(t,e){this.sessionTimeoutMillis=t,this.storage=e,this.sessionListeners=[],this._currentSessionId=null,this._lastEventTime=null,this.loadSession(),this.loadLastEventTime()}return Object.defineProperty(t.prototype,"currentSessionId",{get:function(){return this._currentSessionId},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"sessionId",{get:function(){var e;return null!==(e=this._currentSessionId)&&void 0!==e?e:t.EMPTY_SESSION_ID},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"lastEventTime",{get:function(){return this._lastEventTime},enumerable:!1,configurable:!0}),t.prototype.addListener=function(t){this.sessionListeners.push(t)},t.prototype.startNewSession=function(t,e,r){return t&&this.endSession(t),this.newSession(e,r)},t.prototype.startNewSessionIfNeeded=function(t,e){var r=this._lastEventTime;return null===r?this.startNewSession(t,t,e):null!==this._currentSessionId&&e-r<this.sessionTimeoutMillis?(this.updateLastEventTime(e),this._currentSessionId):this.startNewSession(t,t,e)},t.prototype.updateLastEventTime=function(t){this._lastEventTime=t,this.storage.setItem(X,"".concat(t))},t.prototype.endSession=function(t){var e=this._currentSessionId,r=this._lastEventTime;null!==e&&null!==r&&this.sessionListeners.forEach((function(n){return n.onSessionEnded(e,t,r)}))},t.prototype.newSession=function(t,e){var r=function(t){return"".concat(t,".").concat(T().slice(0,8))}(e);return this.saveSession(r),this.updateLastEventTime(e),this.sessionListeners.forEach((function(n){n.onSessionStarted(r,t,e)})),r},t.prototype.saveSession=function(t){this._currentSessionId=t,this.storage.setItem(Y,t)},t.prototype.loadSession=function(){this._currentSessionId=this.storage.getItem(Y)},t.prototype.loadLastEventTime=function(){var t=this.storage.getItem(X);if(null!==t){var e=Number.parseFloat(t);e>0&&(this._lastEventTime=e)}},t.prototype.onUserUpdated=function(t,e,r){this.endSession(t),this.newSession(e,r)},t.EMPTY_SESSION_ID="0.ffffffff",t}(),tO=function(){function t(t,e){this.delegate=t,this.transform=e}return t.postfix=function(e,r){return new t(e,(function(t){return"".concat(t).concat(r)}))},t.prefix=function(e,r){return new t(e,(function(t){return"".concat(r).concat(t)}))},t.prototype.getItem=function(t){return this.delegate.getItem(this.transform(t))},t.prototype.removeItem=function(t){this.delegate.removeItem(this.transform(t))},t.prototype.setItem=function(t,e){this.delegate.setItem(this.transform(t),e)},t}(),eO=function(){function t(t,e,r){void 0===r&&(r=4096);var n=this;this.delegate=t,this.listKey=e,this.encodedListCharLen=6,this.resolveMaxLength=function(t){var e=t-n.encodedListCharLen;return e<0?0:e},this.maxLength=this.resolveMaxLength(r)}return t.prototype.isEqualItem=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},t.prototype.getRemainListSize=function(){try{return this.maxLength-JSON.stringify(this.getList()).length}catch(t){return 0}},t.prototype.isAddableItem=function(t){try{return this.getRemainListSize()>JSON.stringify(t).length}catch(t){return!1}},t.prototype.getVictimIndex=function(t){var e=this.getRemainListSize();try{var r=JSON.stringify(t),n=this.getList(),i=0;return n.findIndex((function(t){return(i+=JSON.stringify(t).length)+e>=r.length}))}catch(t){return-1}},t.prototype.getList=function(){try{var t=this.delegate.getItem(this.listKey);if(!t)return[];var e=JSON.parse(t);return Array.isArray(e)?e:[]}catch(t){return[]}},t.prototype.entries=function(){return this.getList().flatMap(Object.entries)},t.prototype.setItem=function(t,e){var r;try{this.removeItem(t);var n=this.getList(),i=((r={})[t]=e,r);if(!this.isAddableItem(i)){var o=this.getVictimIndex(i);if(o<0)return;n=n.slice(o+1)}var s=JSON.stringify(n.concat(i));this.delegate.setItem(this.listKey,s)}catch(t){}},t.prototype.getItem=function(t){var e=this,r=this.getList().find((function(r){return e.isEqualItem(r,t)}));if(r&&r[t])return r[t]},t.prototype.removeItem=function(t){var e=this,r=this.getList();try{var n=r.filter((function(r){return!e.isEqualItem(r,t)})),i=JSON.stringify(n);this.delegate.setItem(this.listKey,i)}catch(t){}},t.prototype.clear=function(){this.delegate.removeItem(this.listKey)},t}(),rO=function(){function t(t,e,r,n,i){this.core=t,this.userManager=e,this.userResolver=r,this.abOverrideStorage=n,this.ffOverrideStorage=i}return t.prototype.currentUser=function(){var t=this.userManager.currentUser;return this.userResolver.resolve(t)},t.prototype.getAbTestDecisions=function(){return this.core.experiments(this.currentUser()).entries()},t.prototype.getAbTestOverrides=function(){return this.abOverrideStorage.getAll()},t.prototype.setAbTestOverride=function(t,e){this.abOverrideStorage.set(t,e),this.increment("AB_TEST","set")},t.prototype.resetAbTestOverride=function(t){this.abOverrideStorage.remove(t),this.increment("AB_TEST","reset")},t.prototype.resetAllAbTestOverride=function(){this.abOverrideStorage.clear(),this.increment("AB_TEST","reset.all")},t.prototype.getFeatureFlagDecisions=function(){return this.core.featureFlags(this.currentUser()).entries()},t.prototype.getFeatureFlagOverrides=function(){return this.ffOverrideStorage.getAll()},t.prototype.setFeatureFlagOverride=function(t,e){this.ffOverrideStorage.set(t,e),this.increment("FEATURE_FLAG","set")},t.prototype.resetFeatureFlagOverride=function(t){this.ffOverrideStorage.remove(t),this.increment("FEATURE_FLAG","reset")},t.prototype.resetAllFeatureFlagOverride=function(){this.ffOverrideStorage.clear(),this.increment("FEATURE_FLAG","reset.all")},t.prototype.increment=function(t,e){Ke.counter("experiment.manual.override",{"experiment.type":t,operation:e}).increment()},t}(),nO=function(){function t(){}return t.serverFetch=function(t){return"".concat(t,"/api/v2/workspaces")},t.clientFetch=function(t,e){return"".concat(t,"/api/v2/w/").concat(e,"/w")},t.serverDispatch=function(t){return"".concat(t,"/api/v2/events")},t.clientDispatch=function(t){return"".concat(t,"/api/v2/w/events")},t.beaconDispatch=function(t,e){return"".concat(t,"/api/v2/w/").concat(e,"/events")},t.inAppMessageRenderer=function(t,e){return"".concat(t,"/sdk/iam-renderer/").concat(e,"/iam-renderer.js")},t}(),iO=function(){function t(t){this.storage=t}return t.prototype.exist=function(t,e){var r=this.key(t),n=this.storage.getItem(r);if(k.isNullOrUndefined(n))return!1;var i=Number.parseInt(n,10);return Number.isNaN(i)?(this.storage.removeItem(r),!1):e<=i||(this.storage.removeItem(r),!1)},t.prototype.put=function(t,e){this.storage.setItem(this.key(t),"".concat(e))},t.prototype.key=function(t){return"".concat(t.key)},t}(),oO=function(){function t(t){this.handlers=t}return t.prototype.get=function(t){return this.handlers.find((function(e){return e.supports(t)}))},t}(),sO=function(){function t(){}return t.prototype.handle=function(t){t.close()},t.prototype.supports=function(t){return"CLOSE"===t.type},t}(),uO=function(){function t(t){this.urlHandler=t}return t.prototype.handle=function(t,e){try{if(!e.value)return;this.urlHandler.open(new URL(e.value))}catch(t){F.log.error("Invalid url: ".concat(e.value))}},t.prototype.supports=function(t){return"WEB_LINK"===t.type},t}(),aO=function(){function t(t){this.urlHandler=t}return t.prototype.handle=function(t,e){t.close();try{if(!e.value)return;this.urlHandler.open(new URL(e.value))}catch(t){F.log.error("Invalid url: ".concat(e.value))}},t.prototype.supports=function(t){return"LINK_AND_CLOSE"===t.type},t}(),cO=function(){function t(t,e){this.storage=t,this.clock=e}
return t.prototype.handle=function(e){var r=this.clock.currentMillis()+t.HIDE_EXPIRATION;this.storage.put(e.context.inAppMessage,r),e.close()},t.prototype.supports=function(t){return"HIDDEN"===t.type},t.HIDE_EXPIRATION=864e5,t}(),fO=function(){function t(t){this.core=t}return t.prototype.track=function(t,e,r){var n=this.createTrackEvent(e,t);this.core.track(n,t.user,r)},t.prototype.createTrackEvent=function(t,e){var r,n,i,o;switch(t.type){case"IMPRESSION":return{key:"$in_app_impression",properties:U({in_app_message_id:e.inAppMessage.id,in_app_message_key:e.inAppMessage.key,title_text:null===(n=null===(r=e.message.text)||void 0===r?void 0:r.title)||void 0===n?void 0:n.text,body_text:null===(o=null===(i=e.message.text)||void 0===i?void 0:i.body)||void 0===o?void 0:o.text,button_text:e.message.buttons.map((function(t){return t.text})),image_url:e.message.images.map((function(t){return t.imagePath}))},e.properties)};case"CLOSE":return{key:"$in_app_close",properties:{in_app_message_id:e.inAppMessage.id,in_app_message_key:e.inAppMessage.key}};case"ACTION":var s=t;return{key:"$in_app_action",properties:{in_app_message_id:e.inAppMessage.id,in_app_message_key:e.inAppMessage.key,action_type:s.action.type,action_area:s.area,action_value:s.action.value,button_text:s.text}}}},t}(),pO=function(){function t(t,e,r){this.messageViewFactory=t,this.eventHandler=e,this.interactionHandlerFactory=r,this.currentMessageView=null,this.opening=!1}return t.prototype.present=function(t){return r(this,void 0,void 0,(function(){var e;return n(this,(function(r){switch(r.label){case 0:if(this.currentMessageView)return[2];if(this.opening)return[2];this.opening=!0,e=null,r.label=1;case 1:return r.trys.push([1,3,4,5]),e=this.messageViewFactory.create(t,this),this.currentMessageView=e,[4,e.open()];case 2:return r.sent(),[3,5];case 3:return r.sent(),null==e||e.close(),[3,5];case 4:return this.opening=!1,[7];case 5:return[2]}}))}))},t}(),lO=function(){function t(t,e,r){var n=this;this.userEventEmitter=t,this.determiner=e,this.presenter=r,this.onEvent=function(t){var e=n.determiner.determineOrNull(t);e&&n.presenter.present(e)},this.initialize()}return t.prototype.initialize=function(){this.userEventEmitter.on("event",this.onEvent)},t.prototype.destroy=function(){this.userEventEmitter.off("event",this.onEvent)},t}(),hO=function(t,e,r,n){this.inAppMessage=t,this.message=e,this.user=r,this.properties=n},dO=function(){function t(t,e,r){this.workspaceFetcher=t,this.eventMatcher=e,this.core=r}return t.prototype.determineOrNull=function(t){var e=this.workspaceFetcher.get();if(e)for(var r=0,n=e.getInAppMessages();r<n.length;r++){var i=n[r];if(this.eventMatcher.matches(e,i,t)){var o=this.context(i,t);if(!o)continue;return o}}},t.prototype.context=function(t,e){var r=this.core.tryInAppMessage(t.key,e.user);if(r.inAppMessage&&r.message)return new hO(r.inAppMessage,r.message,e.user,it.sanitize({decision_reason:r.reason}))},t}(),vO=function(){function t(e,r,n){var i=this;this.scriptLoader=e,this.context=r,this.ui=n,this.container=null,this.renderer=null,this.handleInAppMessageInteraction=function(e){if(e instanceof CustomEvent&&e.type===t.HACKLE_IAM_INTERACTION_EVENT_TYPE){var r=e.detail;i.handleInteraction(r)}}}return t.prototype.open=function(){return r(this,void 0,void 0,(function(){var e,r;return n(this,(function(n){switch(n.label){case 0:return n.trys.push([0,3,,4]),window.addEventListener(t.HACKLE_IAM_INTERACTION_EVENT_TYPE,this.handleInAppMessageInteraction),[4,this.scriptLoader.load()];case 1:return n.sent(),(e=this.addContainer()).style.display="none",e.classList.add("".concat(t.CONTAINER_CLASS_NAME,"--loading")),r=window.HackleInAppMessageRenderer,this.renderer=new r.HackleInAppMessageRenderer(e),[4,this.renderer.render({messageId:this.context.inAppMessage.id,message:this.context.message.toJson()})];case 2:return n.sent(),e.classList.remove("".concat(t.CONTAINER_CLASS_NAME,"--loading")),e.style.display="block",this.handleEvent({type:"IMPRESSION"}),[3,4];case 3:return n.sent(),this.close(),[3,4];case 4:return[2]}}))}))},t.prototype.close=function(){var e;this.handleEvent({type:"CLOSE"}),window.removeEventListener(t.HACKLE_IAM_INTERACTION_EVENT_TYPE,this.handleInAppMessageInteraction),null===(e=this.renderer)||void 0===e||e.destroy(),this.renderer=null,this.removeContainer(),this.ui.currentMessageView=null},t.prototype.addContainer=function(){if(!this.container){var e=document.createElement("div");e.classList.add(t.CONTAINER_CLASS_NAME),this.container=e}return this.container.parentNode||document.body.appendChild(this.container),this.container},t.prototype.removeContainer=function(){var t;this.container&&(null===(t=this.container.parentNode)||void 0===t||t.removeChild(this.container),this.container=null)},t.prototype.handleInteraction=function(t){var e=this.ui.interactionHandlerFactory.get(t);e&&e.handle(this,t)},t.prototype.handleEvent=function(t){this.ui.eventHandler.handle(this,t)},t.HACKLE_IAM_INTERACTION_EVENT_TYPE="hackle-iam-interaction",t.CONTAINER_CLASS_NAME="hackle-iam",t}(),yO=function(){function t(t){this.scriptLoader=t}return t.prototype.create=function(t,e){return new vO(this.scriptLoader,t,e)},t}(),mO=function(){function t(t){this.scriptUrl=t}return t.prototype.load=function(){return r(this,void 0,void 0,(function(){var t;return n(this,(function(e){switch(e.label){case 0:return window.HackleInAppMessageRenderer?[2]:(t=this.createScript(),document.head.appendChild(t),[4,this.waitForLoad(t)]);case 1:return[2,e.sent()]}}))}))},t.prototype.createScript=function(){var t=document.createElement("script");return t.type="text/javascript",t.async=!0,t.src=this.scriptUrl,t},t.prototype.waitForLoad=function(t){return new Promise((function(e,r){var n=function(){o(),e(t)},i=function(t){o(),r(t.message)},o=function(){t.removeEventListener("error",i),t.removeEventListener("load",n)};t.addEventListener("load",n),t.addEventListener("error",i)}))},t}(),gO=function(){function t(t){this.targetMatcher=t}return t.prototype.isTriggerTarget=function(t,e,r){var n=this;return e.eventTrigger.rules.some((function(i){return n.ruleMatches(t,r,e,i)}))},t.prototype.ruleMatches=function(t,e,r,n){if(e.event.key!==n.eventKey)return!1;var i=EO.of(t,e,r);return this.targetMatcher.anyMatches(i,bA.create(),n.targets)},t}(),EO=function(){function t(t,e,r,n){this.key=t,this.workspace=e,this.user=r,this.event=n}return t.of=function(e,r,n){return new t(new OA("IN_APP_MESSAGE",n.key),e,r.user,r)},t}(),wO=function(){function t(t){this.storage=t}return t.prototype.isTriggerTarget=function(t,e,r){if(!e.eventTrigger.frequencyCap)return!0;var n=this.createMatchContexts(e.eventTrigger.frequencyCap);if(0===n.length)return!0;for(var i=0,o=this.storage.get(e);i<o.length;i++)for(var s=o[i],u=0,a=n;u<a.length;u++)if(a[u].matches(r,s))return!1;return!0},t.prototype.createMatchContexts=function(t){for(var e=[],r=0,n=t.identifierCaps;r<n.length;r++){var i=n[r];e.push(new TO(new _O(i)))}return t.durationCap&&e.push(new TO(new IO(t.durationCap))),e},t}(),TO=function(){function t(t){this.matchCount=0,this.predicate=t}return t.prototype.matches=function(t,e){return this.predicate.matches(t,e)&&(this.matchCount+=1),this.matchCount>=this.predicate.thresholdCount},t}(),_O=function(){function t(t){this.identifierCap=t}return Object.defineProperty(t.prototype,"thresholdCount",{get:function(){return this.identifierCap.count},enumerable:!1,configurable:!0}),t.prototype.matches=function(t,e){var r=t.user.identifiers[this.identifierCap.identifierType];if(k.isNullOrUndefined(r))return!1;var n=e.identifiers[this.identifierCap.identifierType];return!k.isNullOrUndefined(n)&&r===n},t}(),IO=function(){function t(t){this.durationCap=t}return Object.defineProperty(t.prototype,"thresholdCount",{get:function(){return this.durationCap.count},enumerable:!1,configurable:!0}),t.prototype.matches=function(t,e){return t.timestamp-e.timestamp<=this.durationCap.durationMillis},t}(),AO=function(){function t(t){this.storage=t}return t.prototype.get=function(t){var e=this.storage.getItem(t.id.toString());return k.isNullOrUndefined(e)?[]:JSON.parse(e)},t.prototype.set=function(t,e){this.storage.setItem(t.id.toString(),JSON.stringify(e))},t}(),NO=function(){function t(t){this.processors=t}return t.prototype.get=function(t){return this.processors.find((function(e){return e.supports(t)}))},t}(),OO=function(){function t(t){this.impressionStorage=t}return t.prototype.process=function(t,e,r){this.saveImpression(t.context.inAppMessage,t.context.user,r)},t.prototype.saveImpression=function(e,r,n){var i=this.impressionStorage.get(e),o={identifiers:r.identifiers,timestamp:n};i.push(o),i.length>t.IMPRESSION_MAX_SIZE&&i.splice(0,i.length-t.IMPRESSION_MAX_SIZE),this.impressionStorage.set(e,i)},t.prototype.supports=function(t){return"IMPRESSION"===t.type},t.IMPRESSION_MAX_SIZE=100,t}(),bO=function(){function t(){}return t.prototype.process=function(){},t.prototype.supports=function(t){return"CLOSE"===t.type},t}(),RO=function(){function t(t){this.actionHandlerFactory=t}return t.prototype.process=function(t,e){var r=this.actionHandlerFactory.get(e.action);r&&r.handle(t,e.action)},t.prototype.supports=function(t){return"ACTION"===t.type},t}(),SO=function(){function t(t,e,r){this.clock=t,this.eventTracker=e,this.eventProcessorFactory=r}return t.prototype.handle=function(t,e){var r=this.clock.currentMillis();this.eventTracker.track(t.context,e,r);var n=this.eventProcessorFactory.get(e);n&&n.process(t,e,r)},t}(),MO=function(){function t(t,e){this.ruleDeterminer=t,this.frequencyCapDeterminer=e}return t.prototype.matches=function(t,e,r){return!!dr.isTrack(r)&&!!this.ruleDeterminer.isTriggerTarget(t,e,r)&&this.frequencyCapDeterminer.isTriggerTarget(t,e,r)},t}(),CO=function(){function t(t){this.handlers=t}return t.prototype.get=function(t){return this.handlers.find((function(e){return e.supports(t)}))},t}(),xO=function(){function t(){}return t.prototype.handle=function(t){t.close()},t.prototype.supports=function(t){return"CLOSE"===t.type},t}(),PO=function(){function t(t){this.eventHandler=t}return t.prototype.handle=function(t,e){var r=Te.fromJson(e.action);if(r){var n={type:"ACTION",action:r,area:e.area,text:e.text};this.eventHandler.handle(t,n)}},t.prototype.supports=function(t){return"ACTION"===t.type},t}(),UO=function(){function t(){}return t.prototype.open=function(t){window.location.href=t.href},t}(),kO={utm_campaign:void 0,utm_content:void 0,utm_id:void 0,utm_medium:void 0,utm_source:void 0,utm_term:void 0,gclid:void 0,fbclid:void 0},DO={current:void 0,referrer:void 0},LO=function(t,e){return Object.keys(kO).every((function(r){return t[r]===e[r]}))},FO=function(t,e,r){return null===t||(!LO(e,kO)||r.current!==r.referrer)&&!LO(t,e)},VO=function(){function t(t,e,r,n,i){this.storage=t,this.parser=e,this.core=r,this.userManager=n,this.userResolver=i}return t.prototype.startNewCampaign=function(t,e,r){for(var n=U(U({},kO),e),i=new fr,o=0,s=Object.entries(n);o<s.length;o++){var u=s[o],a=u[0],c=u[1];c?i.set(a,c):i.unset(a)}var f=i.build(),p=f.toEvent(),l=this.userResolver.resolve(t);this.core.track(p,l,r),this.userManager.updateUserProperties(f)},t.prototype.startNewCampaignIfNeeded=function(t,e){var r=this.storage.get(),n=this.parser.parse(),i=this.parser.parseDomain();FO(r,n,i)&&(this.storage.set(n),this.startNewCampaign(t,n,e))},t.prototype.onSessionEnded=function(){},t.prototype.onSessionStarted=function(t,e,r){this.startNewCampaignIfNeeded(e,r)},t}(),jO=function(){function t(t){this.storage=t}return t.prototype.get=function(){var t=this.storage.getItem(Z);return t?JSON.parse(t):null},t.prototype.set=function(t){this.storage.setItem(Z,JSON.stringify(t))},t}(),GO=function(){function t(t){this.search=t}return t.prototype.getQueryParam=function(t){return this.getQueryParams((function(){return!0}))[t]||""},t.prototype.getQueryParams=function(t){for(var e={},r=0,n=this.search.substring(1).split("&");r<n.length;r++){var i=n[r].split("="),o=i[0],s=i[1];t&&!t(o,s)||(e[o]=decodeURIComponent(s))}return e},t.getQueryParams=function(){return"undefined"==typeof window?{}:new t(window.location.search).getQueryParams()},t}(),BO=function(){function t(){}return t.extractDomain=function(t){var e=this.DOMAIN_MATCH_REGEX,r=t.split("."),n=r[r.length-1];(n.length>4||"com"===n||"org"===n)&&(e=this.SIMPLE_DOMAIN_MATCH_REGEX);var i=t.match(e);return i?i[0]:t},t.DOMAIN_MATCH_REGEX=/[a-z0-9][a-z0-9-]+\.[a-z.]{2,6}$/i,t.SIMPLE_DOMAIN_MATCH_REGEX=/[a-z0-9][a-z0-9-]*\.[a-z]+$/i,t}(),HO=function(){function t(){}return t.prototype.parse=function(){var t=GO.getQueryParams();return{utm_campaign:t[KO],utm_content:t[zO],utm_id:t[JO],utm_medium:t[qO],utm_source:t[YO],utm_term:t[XO],gclid:t[WO],fbclid:t[$O]}},t.prototype.parseDomain=function(){return"undefined"==typeof window?DO:{current:BO.extractDomain(window.document.location.hostname),referrer:function(){var t=window.document.referrer;if(t){var e=new URL(t).hostname;return BO.extractDomain(e)}}()}},t}(),KO="utm_campaign",zO="utm_content",JO="utm_id",qO="utm_medium",YO="utm_source",XO="utm_term",WO="gclid",$O="fbclid",ZO=F.log,QO=null,tb={user:void 0,debug:!1,log_disabled:!1,auto_track_page_view:!0,pollingIntervalMillis:-1,exposureEventDedupIntervalMillis:-1,sessionTimeoutMillis:18e5,autoOpenDevTool:!1,sdkUrl:"https://client-sdk.hackle.io",eventUrl:"https://event.hackle.io",monitoringUrl:"https://monitoring.hackle.io",cdnUrl:"https://static.hackle.io",SDK_NAME_HEADER:"javascript-sdk_browser",SDK_VERSION_HEADER:"11.18.1",IAM_RENDERER_VERSION_HEADER:"0.0.3"},eb={createInstance:C,getUserId:N,setUserId:O,removeUserId:b,Logger:F};t.Bucket=gt,t.Container=Ct,t.ContainerGroup=xt,t.CoreVersion=Ft,t.Decision=pt,t.DecisionReason=vt,t.EmptyHackleRemoteConfig=ht,t.EmptyParameterConfig=dt,t.EventType=wt,t.Experiment=yt,t.FeatureFlagDecision=lt,t.IAM_ACTION_AREA=["BUTTON","IMAGE","X_BUTTON"],t.IAM_ACTION_TYPE=te,t.IAM_BEHAVIOR=Qt,t.IAM_DISPLAY_TYPE=Wt,t.IAM_LAYOUT_TYPE=$t,t.IAM_ORIENTATION=Zt,t.IAM_PLATFORM_TYPE=Yt,t.IAM_STATUS=qt,t.IAM_TIMEUNIT=Xt,t.IdentifierType=Tt,t.IdentifiersBuilder=_t,t.InAppMessage=ee,t.InAppMessageAction=Te,t.InAppMessageBackground=we,t.InAppMessageButton=ge,t.InAppMessageButtonStyle=Ee,t.InAppMessageContext=pe,t.InAppMessageContextLayout=he,t.InAppMessageContextMessage=le,t.InAppMessageDecision=ft,t.InAppMessageDurationCap=ae,t.InAppMessageEventFrequencyCap=se,t.InAppMessageEventTrigger=ie,t.InAppMessageEventTriggerRule=oe,t.InAppMessageIdentifierCap=ue,t.InAppMessageImage=de,t.InAppMessagePeriodAlways=re,t.InAppMessagePeriodCustom=ne,t.InAppMessageTargetContext=ce,t.InAppMessageText=ve,t.InAppMessageTextAttribute=ye,t.InAppMessageTextStyle=me,t.InAppMessageUserOverride=fe,t.Logger=F,t.MATCH_OPERATORS=Bt,t.MATCH_TYPES=jt,t.MATCH_VALUE_TYPES=Gt,t.MetaVersion=Vt,t.ParameterConfiguration=Pt,t.PropertyOperations=pr,t.PropertyOperationsBuilder=fr,t.RemoteConfigDecision=ct,t.RemoteConfigParameter=Ut,t.RemoteConfigParameterValue=Dt,t.RemoteConfigTargetRule=kt,t.SEGMENT_TYPES=zt,t.Segment=Mt,t.Slot=Et,t.TARGET_ACTION_TYPES=Ht,t.TARGET_KEY_TYPES=Kt,t.Target=At,t.TargetAction=Rt,t.TargetCondition=Nt,t.TargetKey=Ot,t.TargetMatch=bt,t.TargetRule=St,t.TargetingType=Jt,t.Variation=mt,t.Version=Lt,t.createInstance=C,t.default=eb,t.getUserId=N,t.removeUserId=b,t.sanitizeUser=It,t.setUserId=O,Object.defineProperty(t,"__esModule",{value:!0})})),(()=>{const t=()=>window.__env__.SITE,e=(()=>{let t=null;return()=>{if(t)return t;const e={debug:["alpha","local"].includes(window.__env__.STAGE)};return t=Hackle.createInstance(window.__env__.HACKLE_BROWSER_KEY,e),t}})(),r=t=>{const r=e();r.getUser().userId!==t?.userId&&(r.resetUser(),t&&r.setUserId(t.userId)),r.setUserProperties({internal_account:t?.internalAccount||"false"})},n=()=>{window.document.body.addEventListener("click",(t=>{const e=t.target.closest("[data-hackle-value]");if(!e)return;const r=e.dataset.hackleValue;if(r){const t=/{.+}/.test(r)?JSON.parse(r):r;u(t)}}))},i=()=>{window.document.body.addEventListener("hackle-view",(t=>{const e=t.detail;e&&u(e)}))},o=()=>{const t=()=>{window.document.body.dispatchEvent(new CustomEvent("hackle-ready"))};window.document.body.addEventListener("check-hackle-ready",t),t()},s=()=>{window.document.body.querySelectorAll("[data-hackle-view]").forEach((t=>{const e=t.dataset.hackleView;if(e){const r=/{.+}/.test(e)?JSON.parse(e):e;u(r),t.removeAttribute("data-hackle-view")}}))},u=r=>{const n=e();n.onReady((()=>{let e;if("string"==typeof r)e={key:r,properties:{site:t()}};else{if("object"!=typeof r)return;e={...r,properties:{...r.properties,site:t()}}}n.track(e)}))},a=t=>{const e=()=>{n(),i(),o(),s()};return r(t),{initHackleEvent:e,trackView:p}};let c=null;const f=()=>{const t=globalThis.window?.document;return t?new Promise((e=>{t.body.addEventListener("hackle-ready",(()=>{e()})),t.body.dispatchEvent(new CustomEvent("check-hackle-ready"))})):Promise.resolve()},p=t=>{c=c||f(),c.then((()=>{document.body.dispatchEvent(new CustomEvent("hackle-view",{detail:t}))}))},l=()=>{const t=document.getElementById("__hackle-init-info"),e=t?.dataset.userId||void 0,r=t?.dataset.internalAccount||void 0;return e?{userId:e,internalAccount:"true"===r}:void 0};window.document.addEventListener("DOMContentLoaded",(()=>{if(window.document.body.dataset.hackleEventBounded)return;window.document.body.dataset.hackleEventBounded="true";const t=l(),{initHackleEvent:e}=a(t);e()}))})();